*    ZCOBOL PGM='zcobol\test\TESTCMP2' VER=V1.5.06 MM/DD/YY  
*    ZCOBOL OPTIONS=() 
         COPY  TESTCMP2_ZC_LABELS.CPY
*        IDENTIFICATION DIVISION.
*        PROGRAM-ID.    TESTCMP2.
         PRINT NOLIST,NOGEN,NOLISTUSE    SET LIST OPTION FOR INTERNAL CX
               ODE
TESTCMP2 CSECT ,                CSECT WITH PROCEDURE CODE AND WS
         USING *,ZC_R15
         STM   14,12,12+4*(14-14)(13)
         CNOP  4,8             FORCE ZC390PVT TO DOUBLEWORD BOUNDARY
         BRAS  ZC_R8,ZC_LOAD
         USING *,ZC_R8            BASE FOR LOAD AND CICS V5 USE
*
*  THESE FIELDS MUST BE KEPT IN SYNC WITH zcobol\ZC390PVT.CPY
*
         DC    CL8'TESTCMP2'    PVTPGM   ZCOBOL PGM NAME
         DC    CL8'01/02/05'   PVTDATE  ZCOBOL COMPILE DATE
         DC    CL8'22.33'   PVTTIME  ZCOBOL COMPILE TIME
         DC    CL8'V1.5.06'    PVTVER   ZCOBOL COMPILER VERSION
         DC    C'0'     PVTCICS  ZCOBOL EXEC CICS PGM
         DC    C'1'   PVTEXTND ZCOBOL EXTENDED PRECISION
         DC    C'0'    PVTTRUNC ZCOBOL TRUNCATE TO PICTURE
         DC    C'1'      PVTR64   ZCOBOL USE 64 BIT REGISTERS
         DC    H'80' MAX DISPLAY LINE LEN  RPI 1118
         DS    XL10            RESERVED
ZC_LOAD  DS    0H
         LA    0,=CL8'ZC390LIB'
         SR    15,15 USE DEFAULT SYS390 SEARCH
         SVC   8 LOAD R0=A(NAME) R15=DDNAME/DSNAME ADDR OR 0
         LTR   ZC_R15,ZC_R15
         JZ    ZC_LOAD_OK
         BRAS  1,*+(WTO#0015_EOT-*+1)/2*2
         DC    AL2(WTO#0015_EOT-*,0),C'ZC390LIB NOT FOUND'
WTO#0015_EOT     EQU *
         SVC   35
         LA  ZC_R15,16
         SVC 3      EXIT TO CALLER WITH RC=16
ZC_LOAD_OK DS  0H
         LR    ZC_R9,ZC_R0
         USING ZC390CVT,ZC_R9    R9=CVT
         CLC   ZCVT_ID,=C'ZCVT'              CHECK ZCVT ID AND LENGTH
         JNE   ZC_VER_ERR                    IN ZC390LIB.390 MATCH
         CLC   ZCVT_LEN,=A(ZCVT_END-ZCVT_ID) ZCOBOL PGM COMPILED ID/LEN
         BNE   ZC_VER_ERR
         L     ZC_R15,ZCVT_ZC390NUC
         BASR  ZC_R14,ZC_R15 CALL ZC390NUC TO VERIFY VER, OPTIONS
         J     ZC_VER_OK
ZC_VER_ERR DS 0H
         BRAS  1,*+(WTO#0016_EOT-*+1)/2*2
         DC    AL2(WTO#0016_EOT-*,0),C'ZC390LIB ZCVT VERIFY ERROR'
WTO#0016_EOT     EQU *
         SVC   35
         LA  ZC_R15,16
         SVC 3      EXIT TO CALLER WITH RC=16
         LTORG 
         PUSH  PRINT,NOPRINT
         PRINT OFF,NOPRINT
ZC_R0    EQU   0
ZC_R1    EQU   1
ZC_R2    EQU   2
ZC_R3    EQU   3
ZC_R4    EQU   4
ZC_R5    EQU   5
ZC_R6    EQU   6
ZC_R7    EQU   7
ZC_R8    EQU   8
ZC_R9    EQU   9
ZC_R10   EQU  10
ZC_R11   EQU  11
ZC_R12   EQU  12
ZC_R13   EQU  13
ZC_R14   EQU  14
ZC_R15   EQU  15
ZC_F0    EQU   0
ZC_F1    EQU   1
ZC_F2    EQU   2
ZC_F3    EQU   3
ZC_F4    EQU   4
ZC_F5    EQU   5
ZC_F6    EQU   6
ZC_F7    EQU   7
ZC_F8    EQU   8
ZC_F9    EQU   9
ZC_F10   EQU  10
ZC_F11   EQU  11
ZC_F12   EQU  12
ZC_F13   EQU  13
ZC_F14   EQU  14
ZC_F15   EQU  15
ZC_H     EQU   2   HIGH
ZC_L     EQU   4   LOW
ZC_E     EQU   8   EQUAL
ZC_NH    EQU   13  NOT HIGHT
ZC_NL    EQU   11  NOT LOW
ZC_NE    EQU   7   NOT EQUAL
ZC_O     EQU   1   OVERFLOW
ZC_P     EQU   2   POSITIVE
ZC_M     EQU   4   MINUS
ZC_Z     EQU   8   ZERO
ZC_NP    EQU   13  NOT POSITIVE
ZC_NM    EQU   11  NOT MINUS
ZC_NZ    EQU   7   NOT ZERO
ZC_NO    EQU   14  NOT OVERFLOW
ZC_EQ    EQU   8   EQUAL
ZC_GT    EQU   2   GREATER THAN
ZC_LT    EQU   4   LESS    THAN
ZC_GE    EQU   11  GREATER THAN OR EQUAL
ZC_LE    EQU   13  LESS    THAN OR EQUAL
         POP   PRINT,NOPRINT
PFPO_TEST    EQU  X'80' PFPO TEST IF VALID OPCODE (NOT SUPPORTED YET)
PFPO_RADIX   EQU  1 PFPO OPCODE - CONVERT FROM ONE RADIX TO ANOTHER
PFPO_RND     EQU  0 PFOP ROUNDING OPTION (ONLY DEFAULT ALLOWED)
PFPO_TYPE_EH EQU  0 EH HFP SHORT     32 BITS 7  DIGITS
PFPO_TYPE_DH EQU  1 ED HFP LONG      64 BITS 15 DIGITS
PFPO_TYPE_LH EQU  2 EL HFP EXTENDED 128 BITS 30 DIGITS
PFPO_TYPE_EB EQU  5 EB BFP SHORT     32 BITS 7  DIGITS
PFPO_TYPE_DB EQU  6 DB BFP LONG      64 BITS 16 DIGITS
PFPO_TYPE_LB EQU  7 LB BFP EXTENDED 128 BITS 34 DIGITS
PFPO_TYPE_ED EQU  8 ED DFP SHORT     32 BITS 7  DIGITS
PFPO_TYPE_DD EQU  9 DD DFP LONG      64 BITS 16 DIGITS
PFPO_TYPE_LD EQU 10 LD DFP EXTENDED 128 BITS 34 DIGITS
ZC_VER_OK DS   0H
         L     ZC_R2,24(ZC_R13) SET ZC_R2=PARMLIST ADDRESS AFTER LOAD
         LARL  ZC_R1,ZC_WS     ZC_R2=A(WORKING STORAGE WITH SAVEAREA)
         ST    ZC_R1,8(ZC_R13) FORWARD  SAVE CHAIN
         ST    ZC_R13,4(ZC_R1) BACKWARD SAVE CHAIN
         LR    ZC_R13,ZC_R1    LINK SAVE AREA IN ZC390CVT
         USING ZC_WS,ZC_R13    BASE FOR ZCOBOL WS (SEE GEN_SYM_RX.MAC)
         ST    ZC_R13,ZC_WS_START  SAVE ADDR WS IN WS PREFIX
         LARL  ZC_R0,ZC_WS_END
         SR    ZC_R0,ZC_R13
         ST    ZC_R0,ZC_WS_LEN     SAVE LENGTH OF WS IN WS PREFIX
         DROP  ZC_R15              RPI 1042
ZC_WSLOC LOCTR 
ZC_WS    DS    0D           START WORKING STORAGE
ZC390CVT DSECT 
ZCVT_ID            DC    C'ZCVT'             ZCVT ID  VERIFIED BY ZCOB
ZCVT_LEN           DC    A(ZCVT_END-ZCVT_ID) ZCVT LEN VERIFIED BY ZCOB
ZCVT_VER           DC    CL8'V1.5.06'    ZCVT VER VERIFIED BY ZC390NUC
ZCVT_ZC390NUC  DC V(ZC390NUC)      MODULE  SYSTEM ROUTINE MODULE INIT
ZCVT_CALL           DC V(CALL)       ENTRY R0=A(PGM),R1=A(PARMLIST)
ZCVT_CMP64R32       DC V(CMP64R32)   ENTRY COMPARE R0-1=FLD1 R2-3=FLD2
ZCVT_CVTLBTQ        DC V(CVTLBTQ)    ENTRY CVT LB IN F4-6 TO Q IN R0-1
ZCVT_CVTLDTP        DC V(CVTLDTP)    ENTRY CVT LD IN F0-2 TO PL31 R0-1
ZCVT_CVTQTLB        DC V(CVTQTLB)    ENTRY CVT Q IN R0-1 TO LB IN F4-6
ZCVT_DIV64R32       DC V(DIV64R32)   ENTRY DIVIDE R0-1=N64, R2-3=MAX64
ZCVT_DIVQ128        DC V(DIVQ128)    ENTRY DIVIDE Q128 R0-R1 BY R2-R3
ZCVT_GOBACK         DC V(GOBACK)     ENTRY R1=RC
ZCVT_MPYQ128        DC V(MPYQ128)    ENTRY MULTIPLY Q128 R0-R1 BY R2-R3
ZCVT_OSE64R32       DC V(OSE64R32)   ENTRY ON SIZE ERR R0-1=N, R2-3=MAX
ZCVT_PERFORM        DC V(PERFORM)    ENTRY R14=PGTAR,R0=PGEXT,R1=PMRET
ZCVT_PMCHECK        DC V(PMCHECK)    ENTRY R14=RETURN TO NEXT INSTR.
ZCVT_ROUNDF         DC V(ROUNDF)     ENTRY R0=REM,R1=QUO,R2=DIVISOR
ZCVT_STACKORG       DC V(STACKORG)   ENTRY PERFORM STACK ORIGIN
ZCVT_STACKPTR       DC V(STACKPTR)   ENTRY CUR ENTRY A(PG_END+4,RET)
ZCVT_STACKEND       DC V(STACKEND)   ENTRY PERFORM STACK END
ZCVT_STOPRUN        DC V(STOPRUN)    ENTRY R1=RC
ZCVT_TALPHAX        DC V(TALPHAX)    ENTRY TEST ALPHABETIC X
ZCVT_TNUMP          DC V(TNUMP)      ENTRY TEST NUMERIC P
ZCVT_TNUMX          DC V(TNUMX)      ENTRY TEST NUMERIC X
ZCVT_TNUMZ          DC V(TNUMZ)      ENTRY TEST NUMERIC Z
*
* ADDITIONAL SEPARATE MODULES LINKED WITH Z390NUC IN ZC390LIB.390
*
ZCVT_ABORT     DC V(ABORT)         MODULE  R1=ABORT ERROR MSG #
ZCVT_ABORT_ALTER   EQU    1 ABORT ALTER DUE TO BRC NOT FOUND AT TARGET
ZCVT_ABORT_CALL    EQU    2 ABORT DYNAMIC CALL - PGM NOT FOUND
ZCVT_ABORT_DISPLAY EQU    3 ABORT DISPLAY DUE TO BUFFER EXCEEDED
ZCVT_ABORT_OPEN    EQU    4 ABORT OPEN  INVALID DCB
ZCVT_ABORT_STACK   EQU    6 ABORT PEROFRM STACK OVERFLOW
ZCVT_ABORT_VERSION EQU    7 ABORT ZC390NUC INIT ZCOBOL VERSION ERROR
ZCVT_ABORT_INT128  EQU    8 ABORT INTEGER 128 CONVERSION OVERFLO
ZCVT_ABORT_DIVQ    EQU    9 ABORT DIVIDE Q IF DIVISOR 0 OR > 2**63
ZCVT_ABORT_CICS    EQU   10 ABORT THIS PGM REQUIRES EXEC CICS TRANS MGR
ZCVT_ABORT_ACCEPT  EQU   11 ABORT ACCEPT EOF
ZCVT_ABORT_MAXERR  EQU   11 ABORT MAX ERROR CODE
ZCVT_ACCEPT    DC V(ACCEPT)        MODULE  R1=A(TYPE,FLD_ADD,FLD_LEN)
ZCVT_ACCEPT_DEFAULT EQU   1 INPUT DEFAULT DDNAME=SYSIN
ZCVT_ACCEPT_CONSOLE EQU   2 INPUT VIA WTOR FROM CONSOLE
ZCVT_ACCEPT_DDNAME  EQU   3 INPUT FROM DDNAME WITH DDNAME ADDR IN R3
ZCVT_ACCEPT_DATE    EQU   4 RETURN DAY OF WEEK PIC 9(8) MMDDYYYY
ZCVT_ACCEPT_TIME    EQU   5 RETURN DAY OF WEEK PIC 9(8) HHMMSSTH
ZCVT_ACCEPT_DOW     EQU   6 RETURN DAY OF WEEK PIC 9 1-7
ZCVT_DISPLAY   DC V(DISPLAY)       MODULE  R1=A(ADDR,LEN,TYPE)
ZCVT_INSPECT   DC V(INSPECT)       MODULE  R0=TYPE,R1=PARMLIST
ZCVT_TALLYING      EQU   0 INSPECT TALLYING
ZCVT_REPLACING     EQU   4 INSPECT REPLACING
ZCVT_CONVERTING    EQU   8 INSPECT CONVERTING
*
* SHARED DATA AREAS
*
ZCVT_PVTMAXDL  DS H          MAXIMUM DISPLAY LINE LENGTH  RPI 1118
               DS 0D
ZCVT_ZERO      DC XL16'00'   BINARY ZEROS
ZCVT_HIGH_VALUES DC 0XL16,16X'FF' BINARY FF'S     RPI 1181
ZCVT_PWORK     DS PL8        CVD/CVB WORK
ZCVT_PWORK1    DS PL16       DIV DIVIDEND, CVDG/CVBG WORK
ZCVT_PWORK2    DS PL16       DIV DIVISOR
ZCVT_PWORK3    DS PL16       DIV QUOTIENT
ZCVT_PWORK4    DS PL16       DIV REMAINDER
ZCVT_NDDX      DS XL16       DIV DIVIDEND HOLD AREA
ZCVT_WORKAREA  DS XL256      GEN_INSPECT PARMS, GEN_EDIT WORK, ETC.
*
* END OF ZC390CVT
*
ZCVT_END   EQU   *
ZC390PVT DSECT 
PVTPGM   DS    CL8  ZCOBOL PGM NAME
PVTDATE  DS    CL8  ZCOBOL COMPILE DATE
PVTTIME  DS    CL8  ZCOBOL COMPILE TIME
PVTVER   DS    CL8  ZCOBOL COMPILER VERSION
PVTCICS  DS    C    ZCOBOL EXEC CICS PGM
PVTEXTND DS    C    ZCOBOL EXTENDED PRECISION
PVTTRUNC DS    C    ZCOBOL TRUNCATE TO PICTURE
PVTR64   DS    C    ZCOBOL USE 64 BIT REGISTERS
PVTMAXDL DS    H    ZCOBOL MAX DISPLAY LINE LENGTH
         DS    XL10 RESERVED
ZC_WSLOC LOCTR              CONTINUE WS FOR FD AND DATA
*        AUTHOR.        DON HIGGINS.
*        DATE-WRITTEN.  10/13/08.
*      * TEST ADD, SUBTRACT, MULTIPLEY, DIVIDE.                        
*        ENVIRONMENT DIVISION.
*        DATA DIVISION.
         PRINT DATA
*        WORKING-STORAGE SECTION.
*        77 HFP-SRT FLOAT-HEX-7       VALUE 1234.
*        77 HFP-LNG FLOAT-HEX-15      VALUE 1234.
*        77 HFP-EXT FLOAT-HEX-30      VALUE 1234.
*        77 BFP-SRT FLOAT-BINARY-7    VALUE 1234.
*        77 BFP-LNG FLOAT-BINARY-16   VALUE 1234.
*        77 BFP-EXT FLOAT-BINARY-34   VALUE 1234.
*        77 DFP-SRT FLOAT-DECIMAL-7   VALUE 1234.
*        77 DFP-LNG FLOAT-DECIMAL-16  VALUE 1234.
*        77 DFP-EXT FLOAT-DECIMAL-34  VALUE 1234.
*        77 HW      COMP PIC S9(4)    VALUE 1234.
*        77 FW      COMP PIC S9(9)    VALUE 1234.
*        77 DW      COMP PIC S9(18)   VALUE 1234.
*        77 QW      COMP PIC S9(39)   VALUE 1234.
*        77 PD      COMP-3 PIC S9(31) VALUE 1234.
*        77 ZD             PIC S9(31) VALUE 1234.
*        77 FLT-SRT USAGE FLOAT-SHORT.
*        77 FLT-LNG USAGE FLOAT-LONG.
*        77 FLT-EXT USAGE FLOAT-EXTENDED.
*        77 HW2     COMP PIC S9(4).
*        77 FW2     COMP PIC S9(9).
*        77 DW2     COMP PIC S9(18).
*        77 QW2     COMP PIC S9(39).
*        77 PD2     COMP-3 PIC S9(31).
*        77 ZD2            PIC S9(31).
*        77 GOOD    COMP-3 PIC 9(4)   VALUE 0.
*        PROCEDURE DIVISION.
*ZC   PROCEDURE DIVISION
         PRINT LIST,GEN,LISTUSE TURN PRINT LISTING ON FOR USER CODE GEN
TESTCMP2 CSECT                SWITCH TO PROCEDURE CODE AHEAD OF WS
*        MAINLINE.
PG_MAINLINE DS 0H
*            DISPLAY 'TESTCMP2 TEST COMPUTE ADDITION'
*ZC     36         DISPLAY 'TESTCMP2 TEST COMPUTE ADDITION'
         BRAS  1,*+(WTO#0156_EOT-*+1)/2*2
         DC    AL2(WTO#0156_EOT-*,0),C'TESTCMP2 TEST COMPUTE ADDITION'
WTO#0156_EOT     EQU *
         SVC   35
*            COMPUTE FLT-SRT =
*             (HFP-SRT +HFP-SRT)+(HFP-SRT +HFP-LNG)+(HFP-SRT +HFP-EXT)
*            +(HFP-SRT +BFP-SRT)+(HFP-SRT +BFP-LNG)+(HFP-SRT +BFP-EXT)
*            +(HFP-SRT +DFP-SRT)+(HFP-SRT +DFP-LNG)+(HFP-SRT +DFP-EXT)
*            +(HFP-SRT +HW     )+(HFP-SRT +FW     )+(HFP-SRT +DW     )
*            +(HFP-SRT +QW     )+(HFP-SRT +PD     )+(HFP-SRT +ZD     )
*            -30*1234
*ZC     37         COMPUTE FLT_SRT,=,'(',HFP_SRT,+,HFP_SRT,')',+,'(',HFX
               P_SRT,+,HFP_LNG,')',+,'(',HFP_SRT,+,HFP_EXT,')',+,'(',HFX
               P_SRT,+,BFP_SRT,')',+,'(',HFP_SRT,+,BFP_LNG,')',+,'(',HFX
               P_SRT,+,BFP_EXT,')',+,'(',HFP_SRT,+,DFP_SRT,')',+,'(',HFX
               P_SRT,+,DFP_LNG,')',+,'(',HFP_SRT,+,DFP_EXT,')',+,'(',HFX
               P_SRT,+,HW,')',+,'(',HFP_SRT,+,FW,')',+,'(',HFP_SRT,+,DWX
               ,')',+,'(',HFP_SRT,+,QW,')',+,'(',HFP_SRT,+,PD,')',+,'('X
               ,HFP_SRT,+,ZD,')',-,30,*,1234
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC     44         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_1_1
*ZC     44         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC     44         ELSE
         J     PG_IF_1_E
PG_IF_1_1    DS    0H  &TYPE
*ZC     44         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_1_E    DS    0H  &TYPE
*            COMPUTE FLT-LNG =
*             (HFP-LNG +HFP-SRT)+(HFP-LNG +HFP-LNG)+(HFP-LNG +HFP-EXT)
*            +(HFP-LNG +BFP-SRT)+(HFP-LNG +BFP-LNG)+(HFP-LNG +BFP-EXT)
*            +(HFP-LNG +DFP-SRT)+(HFP-LNG +DFP-LNG)+(HFP-LNG +DFP-EXT)
*            +(HFP-LNG +HW     )+(HFP-LNG +FW     )+(HFP-LNG +DW     )
*            +(HFP-LNG +QW     )+(HFP-LNG +PD     )+(HFP-LNG +ZD     )
*            -30*1234
*ZC     45         COMPUTE FLT_LNG,=,'(',HFP_LNG,+,HFP_SRT,')',+,'(',HFX
               P_LNG,+,HFP_LNG,')',+,'(',HFP_LNG,+,HFP_EXT,')',+,'(',HFX
               P_LNG,+,BFP_SRT,')',+,'(',HFP_LNG,+,BFP_LNG,')',+,'(',HFX
               P_LNG,+,BFP_EXT,')',+,'(',HFP_LNG,+,DFP_SRT,')',+,'(',HFX
               P_LNG,+,DFP_LNG,')',+,'(',HFP_LNG,+,DFP_EXT,')',+,'(',HFX
               P_LNG,+,HW,')',+,'(',HFP_LNG,+,FW,')',+,'(',HFP_LNG,+,DWX
               ,')',+,'(',HFP_LNG,+,QW,')',+,'(',HFP_LNG,+,PD,')',+,'('X
               ,HFP_LNG,+,ZD,')',-,30,*,1234
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         STD   0,FLT_LNG
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LD    ZC_F1,FLT_LNG
         SDTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,FLT_LNG
*            IF FLT-LNG = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC     52         IF    FLT_LNG,=,0
         LD    0,FLT_LNG
         LARL  ZC_R1,=DD'0'
         LD    ZC_F1,0(ZC_R1)
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_2_1
*ZC     52         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC     52         ELSE
         J     PG_IF_2_E
PG_IF_2_1    DS    0H  &TYPE
*ZC     52         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_2_E    DS    0H  &TYPE
*            COMPUTE FLT-EXT =
*             (HFP-EXT +HFP-SRT)+(HFP-EXT +HFP-LNG)+(HFP-EXT +HFP-EXT)
*            +(HFP-EXT +BFP-SRT)+(HFP-EXT +BFP-LNG)+(HFP-EXT +BFP-EXT)
*            +(HFP-EXT +DFP-SRT)+(HFP-EXT +DFP-LNG)+(HFP-EXT +DFP-EXT)
*            +(HFP-EXT +HW     )+(HFP-EXT +FW     )+(HFP-EXT +DW     )
*            +(HFP-EXT +QW     )+(HFP-EXT +PD     )+(HFP-EXT +ZD     )
*            -30*1234
*ZC     53         COMPUTE FLT_EXT,=,'(',HFP_EXT,+,HFP_SRT,')',+,'(',HFX
               P_EXT,+,HFP_LNG,')',+,'(',HFP_EXT,+,HFP_EXT,')',+,'(',HFX
               P_EXT,+,BFP_SRT,')',+,'(',HFP_EXT,+,BFP_LNG,')',+,'(',HFX
               P_EXT,+,BFP_EXT,')',+,'(',HFP_EXT,+,DFP_SRT,')',+,'(',HFX
               P_EXT,+,DFP_LNG,')',+,'(',HFP_EXT,+,DFP_EXT,')',+,'(',HFX
               P_EXT,+,HW,')',+,'(',HFP_EXT,+,FW,')',+,'(',HFP_EXT,+,DWX
               ,')',+,'(',HFP_EXT,+,QW,')',+,'(',HFP_EXT,+,PD,')',+,'('X
               ,HFP_EXT,+,ZD,')',-,30,*,1234
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         MVC   FLT_EXT,16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,FLT_EXT
         LD    ZC_F3,8+FLT_EXT
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,FLT_EXT
         STD   ZC_F3,8+FLT_EXT
*            IF FLT-EXT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC     60         IF    FLT_EXT,=,0
         LD    0,FLT_EXT
         LD    2,8+FLT_EXT
         LARL  ZC_R1,=LD'0'
         LD    ZC_F1,0(ZC_R1)
         LD    ZC_F3,8(ZC_R1)
         CXTR  0,1
         BRC   15-ZC_EQ,PG_IF_3_1
*ZC     60         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC     60         ELSE
         J     PG_IF_3_E
PG_IF_3_1    DS    0H  &TYPE
*ZC     60         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_3_E    DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-SRT +HFP-SRT)+(BFP-SRT +HFP-LNG)+(BFP-SRT +HFP-EXT)
*            +(BFP-SRT +BFP-SRT)+(BFP-SRT +BFP-LNG)+(BFP-SRT +BFP-EXT)
*            +(BFP-SRT +DFP-SRT)+(BFP-SRT +DFP-LNG)+(BFP-SRT +DFP-EXT)
*            +(BFP-SRT +HW     )+(BFP-SRT +FW     )+(BFP-SRT +DW     )
*            +(BFP-SRT +QW     )+(BFP-SRT +PD     )+(BFP-SRT +ZD     )
*            -30*1234
*ZC     61         COMPUTE FLT_SRT,=,'(',BFP_SRT,+,HFP_SRT,')',+,'(',BFX
               P_SRT,+,HFP_LNG,')',+,'(',BFP_SRT,+,HFP_EXT,')',+,'(',BFX
               P_SRT,+,BFP_SRT,')',+,'(',BFP_SRT,+,BFP_LNG,')',+,'(',BFX
               P_SRT,+,BFP_EXT,')',+,'(',BFP_SRT,+,DFP_SRT,')',+,'(',BFX
               P_SRT,+,DFP_LNG,')',+,'(',BFP_SRT,+,DFP_EXT,')',+,'(',BFX
               P_SRT,+,HW,')',+,'(',BFP_SRT,+,FW,')',+,'(',BFP_SRT,+,DWX
               ,')',+,'(',BFP_SRT,+,QW,')',+,'(',BFP_SRT,+,PD,')',+,'('X
               ,BFP_SRT,+,ZD,')',-,30,*,1234
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC     68         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_4_1
*ZC     68         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC     68         ELSE
         J     PG_IF_4_E
PG_IF_4_1    DS    0H  &TYPE
*ZC     68         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_4_E    DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-LNG +HFP-SRT)+(BFP-LNG +HFP-LNG)+(BFP-LNG +HFP-EXT)
*            +(BFP-LNG +BFP-SRT)+(BFP-LNG +BFP-LNG)+(BFP-LNG +BFP-EXT)
*            +(BFP-LNG +DFP-SRT)+(BFP-LNG +DFP-LNG)+(BFP-LNG +DFP-EXT)
*            +(BFP-LNG +HW     )+(BFP-LNG +FW     )+(BFP-LNG +DW     )
*            +(BFP-LNG +QW     )+(BFP-LNG +PD     )+(BFP-LNG +ZD     )
*            -30*1234
*ZC     69         COMPUTE FLT_SRT,=,'(',BFP_LNG,+,HFP_SRT,')',+,'(',BFX
               P_LNG,+,HFP_LNG,')',+,'(',BFP_LNG,+,HFP_EXT,')',+,'(',BFX
               P_LNG,+,BFP_SRT,')',+,'(',BFP_LNG,+,BFP_LNG,')',+,'(',BFX
               P_LNG,+,BFP_EXT,')',+,'(',BFP_LNG,+,DFP_SRT,')',+,'(',BFX
               P_LNG,+,DFP_LNG,')',+,'(',BFP_LNG,+,DFP_EXT,')',+,'(',BFX
               P_LNG,+,HW,')',+,'(',BFP_LNG,+,FW,')',+,'(',BFP_LNG,+,DWX
               ,')',+,'(',BFP_LNG,+,QW,')',+,'(',BFP_LNG,+,PD,')',+,'('X
               ,BFP_LNG,+,ZD,')',-,30,*,1234
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC     76         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_5_1
*ZC     76         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC     76         ELSE
         J     PG_IF_5_E
PG_IF_5_1    DS    0H  &TYPE
*ZC     76         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_5_E    DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-EXT +HFP-SRT)+(BFP-EXT +HFP-LNG)+(BFP-EXT +HFP-EXT)
*            +(BFP-EXT +BFP-SRT)+(BFP-EXT +BFP-LNG)+(BFP-EXT +BFP-EXT)
*            +(BFP-EXT +DFP-SRT)+(BFP-EXT +DFP-LNG)+(BFP-EXT +DFP-EXT)
*            +(BFP-EXT +HW     )+(BFP-EXT +FW     )+(BFP-EXT +DW     )
*            +(BFP-EXT +QW     )+(BFP-EXT +PD     )+(BFP-EXT +ZD     )
*            -30*1234
*ZC     77         COMPUTE FLT_SRT,=,'(',BFP_EXT,+,HFP_SRT,')',+,'(',BFX
               P_EXT,+,HFP_LNG,')',+,'(',BFP_EXT,+,HFP_EXT,')',+,'(',BFX
               P_EXT,+,BFP_SRT,')',+,'(',BFP_EXT,+,BFP_LNG,')',+,'(',BFX
               P_EXT,+,BFP_EXT,')',+,'(',BFP_EXT,+,DFP_SRT,')',+,'(',BFX
               P_EXT,+,DFP_LNG,')',+,'(',BFP_EXT,+,DFP_EXT,')',+,'(',BFX
               P_EXT,+,HW,')',+,'(',BFP_EXT,+,FW,')',+,'(',BFP_EXT,+,DWX
               ,')',+,'(',BFP_EXT,+,QW,')',+,'(',BFP_EXT,+,PD,')',+,'('X
               ,BFP_EXT,+,ZD,')',-,30,*,1234
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC     84         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_6_1
*ZC     84         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC     84         ELSE
         J     PG_IF_6_E
PG_IF_6_1    DS    0H  &TYPE
*ZC     84         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_6_E    DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-SRT +HFP-SRT)+(DFP-SRT +HFP-LNG)+(DFP-SRT +HFP-EXT)
*            +(DFP-SRT +BFP-SRT)+(DFP-SRT +BFP-LNG)+(DFP-SRT +BFP-EXT)
*            +(DFP-SRT +DFP-SRT)+(DFP-SRT +DFP-LNG)+(DFP-SRT +DFP-EXT)
*            +(DFP-SRT +HW     )+(DFP-SRT +FW     )+(DFP-SRT +DW     )
*            +(DFP-SRT +QW     )+(DFP-SRT +PD     )+(DFP-SRT +ZD     )
*            -30*1234
*ZC     85         COMPUTE FLT_SRT,=,'(',DFP_SRT,+,HFP_SRT,')',+,'(',DFX
               P_SRT,+,HFP_LNG,')',+,'(',DFP_SRT,+,HFP_EXT,')',+,'(',DFX
               P_SRT,+,BFP_SRT,')',+,'(',DFP_SRT,+,BFP_LNG,')',+,'(',DFX
               P_SRT,+,BFP_EXT,')',+,'(',DFP_SRT,+,DFP_SRT,')',+,'(',DFX
               P_SRT,+,DFP_LNG,')',+,'(',DFP_SRT,+,DFP_EXT,')',+,'(',DFX
               P_SRT,+,HW,')',+,'(',DFP_SRT,+,FW,')',+,'(',DFP_SRT,+,DWX
               ,')',+,'(',DFP_SRT,+,QW,')',+,'(',DFP_SRT,+,PD,')',+,'('X
               ,DFP_SRT,+,ZD,')',-,30,*,1234
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC     92         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_7_1
*ZC     92         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC     92         ELSE
         J     PG_IF_7_E
PG_IF_7_1    DS    0H  &TYPE
*ZC     92         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_7_E    DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-LNG +HFP-SRT)+(DFP-LNG +HFP-LNG)+(DFP-LNG +HFP-EXT)
*            +(DFP-LNG +BFP-SRT)+(DFP-LNG +BFP-LNG)+(DFP-LNG +BFP-EXT)
*            +(DFP-LNG +DFP-SRT)+(DFP-LNG +DFP-LNG)+(DFP-LNG +DFP-EXT)
*            +(DFP-LNG +HW     )+(DFP-LNG +FW     )+(DFP-LNG +DW     )
*            +(DFP-LNG +QW     )+(DFP-LNG +PD     )+(DFP-LNG +ZD     )
*            -30*1234
*ZC     93         COMPUTE FLT_SRT,=,'(',DFP_LNG,+,HFP_SRT,')',+,'(',DFX
               P_LNG,+,HFP_LNG,')',+,'(',DFP_LNG,+,HFP_EXT,')',+,'(',DFX
               P_LNG,+,BFP_SRT,')',+,'(',DFP_LNG,+,BFP_LNG,')',+,'(',DFX
               P_LNG,+,BFP_EXT,')',+,'(',DFP_LNG,+,DFP_SRT,')',+,'(',DFX
               P_LNG,+,DFP_LNG,')',+,'(',DFP_LNG,+,DFP_EXT,')',+,'(',DFX
               P_LNG,+,HW,')',+,'(',DFP_LNG,+,FW,')',+,'(',DFP_LNG,+,DWX
               ,')',+,'(',DFP_LNG,+,QW,')',+,'(',DFP_LNG,+,PD,')',+,'('X
               ,DFP_LNG,+,ZD,')',-,30,*,1234
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    100         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_8_1
*ZC    100         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    100         ELSE
         J     PG_IF_8_E
PG_IF_8_1    DS    0H  &TYPE
*ZC    100         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_8_E    DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-EXT +HFP-SRT)+(DFP-EXT +HFP-LNG)+(DFP-EXT +HFP-EXT)
*            +(DFP-EXT +BFP-SRT)+(DFP-EXT +BFP-LNG)+(DFP-EXT +BFP-EXT)
*            +(DFP-EXT +DFP-SRT)+(DFP-EXT +DFP-LNG)+(DFP-EXT +DFP-EXT)
*            +(DFP-EXT +HW     )+(DFP-EXT +FW     )+(DFP-EXT +DW     )
*            +(DFP-EXT +QW     )+(DFP-EXT +PD     )+(DFP-EXT +ZD     )
*            -30*1234
*ZC    101         COMPUTE FLT_SRT,=,'(',DFP_EXT,+,HFP_SRT,')',+,'(',DFX
               P_EXT,+,HFP_LNG,')',+,'(',DFP_EXT,+,HFP_EXT,')',+,'(',DFX
               P_EXT,+,BFP_SRT,')',+,'(',DFP_EXT,+,BFP_LNG,')',+,'(',DFX
               P_EXT,+,BFP_EXT,')',+,'(',DFP_EXT,+,DFP_SRT,')',+,'(',DFX
               P_EXT,+,DFP_LNG,')',+,'(',DFP_EXT,+,DFP_EXT,')',+,'(',DFX
               P_EXT,+,HW,')',+,'(',DFP_EXT,+,FW,')',+,'(',DFP_EXT,+,DWX
               ,')',+,'(',DFP_EXT,+,QW,')',+,'(',DFP_EXT,+,PD,')',+,'('X
               ,DFP_EXT,+,ZD,')',-,30,*,1234
         MVC   ZCVT_WORKAREA+0(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    108         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_9_1
*ZC    108         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    108         ELSE
         J     PG_IF_9_E
PG_IF_9_1    DS    0H  &TYPE
*ZC    108         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_9_E    DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (HW      +HFP-SRT)+(HW      +HFP-LNG)+(HW      +HFP-EXT)
*            +(HW      +BFP-SRT)+(HW      +BFP-LNG)+(HW      +BFP-EXT)
*            +(HW      +DFP-SRT)+(HW      +DFP-LNG)+(HW      +DFP-EXT)
*            +(HW      +HW     )+(HW      +FW     )+(HW      +DW     )
*            +(HW      +QW     )+(HW      +PD     )+(HW      +ZD     )
*            -30*1234
*ZC    109         COMPUTE FLT_SRT,=,'(',HW,+,HFP_SRT,')',+,'(',HW,+,HFX
               P_LNG,')',+,'(',HW,+,HFP_EXT,')',+,'(',HW,+,BFP_SRT,')',X
               +,'(',HW,+,BFP_LNG,')',+,'(',HW,+,BFP_EXT,')',+,'(',HW,+X
               ,DFP_SRT,')',+,'(',HW,+,DFP_LNG,')',+,'(',HW,+,DFP_EXT,'X
               )',+,'(',HW,+,HW,')',+,'(',HW,+,FW,')',+,'(',HW,+,DW,')'X
               ,+,'(',HW,+,QW,')',+,'(',HW,+,PD,')',+,'(',HW,+,ZD,')',-X
               ,30,*,1234
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         STG   0,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         AG    ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         STG   0,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         AG    ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    116         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_10_1
*ZC    116         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    116         ELSE
         J     PG_IF_10_E
PG_IF_10_1   DS    0H  &TYPE
*ZC    116         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_10_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (FW      +HFP-SRT)+(FW      +HFP-LNG)+(FW      +HFP-EXT)
*            +(FW      +BFP-SRT)+(FW      +BFP-LNG)+(FW      +BFP-EXT)
*            +(FW      +DFP-SRT)+(FW      +DFP-LNG)+(FW      +DFP-EXT)
*            +(FW      +HW     )+(FW      +FW     )+(FW      +DW     )
*            +(FW      +QW     )+(FW      +PD     )+(FW      +ZD     )
*            -30*1234
*ZC    117         COMPUTE FLT_SRT,=,'(',FW,+,HFP_SRT,')',+,'(',FW,+,HFX
               P_LNG,')',+,'(',FW,+,HFP_EXT,')',+,'(',FW,+,BFP_SRT,')',X
               +,'(',FW,+,BFP_LNG,')',+,'(',FW,+,BFP_EXT,')',+,'(',FW,+X
               ,DFP_SRT,')',+,'(',FW,+,DFP_LNG,')',+,'(',FW,+,DFP_EXT,'X
               )',+,'(',FW,+,HW,')',+,'(',FW,+,FW,')',+,'(',FW,+,DW,')'X
               ,+,'(',FW,+,QW,')',+,'(',FW,+,PD,')',+,'(',FW,+,ZD,')',-X
               ,30,*,1234
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         STG   0,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         AG    ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    124         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_11_1
*ZC    124         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    124         ELSE
         J     PG_IF_11_E
PG_IF_11_1   DS    0H  &TYPE
*ZC    124         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_11_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DW      +HFP-SRT)+(DW      +HFP-LNG)+(DW      +HFP-EXT)
*            +(DW      +BFP-SRT)+(DW      +BFP-LNG)+(DW      +BFP-EXT)
*            +(DW      +DFP-SRT)+(DW      +DFP-LNG)+(DW      +DFP-EXT)
*            +(DW      +HW     )+(DW      +FW     )+(DW      +DW     )
*            +(DW      +QW     )+(DW      +PD     )+(DW      +ZD     )
*            -30*1234
*ZC    125         COMPUTE FLT_SRT,=,'(',DW,+,HFP_SRT,')',+,'(',DW,+,HFX
               P_LNG,')',+,'(',DW,+,HFP_EXT,')',+,'(',DW,+,BFP_SRT,')',X
               +,'(',DW,+,BFP_LNG,')',+,'(',DW,+,BFP_EXT,')',+,'(',DW,+X
               ,DFP_SRT,')',+,'(',DW,+,DFP_LNG,')',+,'(',DW,+,DFP_EXT,'X
               )',+,'(',DW,+,HW,')',+,'(',DW,+,FW,')',+,'(',DW,+,DW,')'X
               ,+,'(',DW,+,QW,')',+,'(',DW,+,PD,')',+,'(',DW,+,ZD,')',-X
               ,30,*,1234
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    132         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_12_1
*ZC    132         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    132         ELSE
         J     PG_IF_12_E
PG_IF_12_1   DS    0H  &TYPE
*ZC    132         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_12_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (QW      +HFP-SRT)+(QW      +HFP-LNG)+(QW      +HFP-EXT)
*            +(QW      +BFP-SRT)+(QW      +BFP-LNG)+(QW      +BFP-EXT)
*            +(QW      +DFP-SRT)+(QW      +DFP-LNG)+(QW      +DFP-EXT)
*            +(QW      +HW     )+(QW      +FW     )+(QW      +DW     )
*            +(QW      +QW     )+(QW      +PD     )+(QW      +ZD     )
*            -30*1234
*ZC    133         COMPUTE FLT_SRT,=,'(',QW,+,HFP_SRT,')',+,'(',QW,+,HFX
               P_LNG,')',+,'(',QW,+,HFP_EXT,')',+,'(',QW,+,BFP_SRT,')',X
               +,'(',QW,+,BFP_LNG,')',+,'(',QW,+,BFP_EXT,')',+,'(',QW,+X
               ,DFP_SRT,')',+,'(',QW,+,DFP_LNG,')',+,'(',QW,+,DFP_EXT,'X
               )',+,'(',QW,+,HW,')',+,'(',QW,+,FW,')',+,'(',QW,+,DW,')'X
               ,+,'(',QW,+,QW,')',+,'(',QW,+,PD,')',+,'(',QW,+,ZD,')',-X
               ,30,*,1234
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LMG   ZC_R0,ZC_R1,QW
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    140         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_13_1
*ZC    140         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    140         ELSE
         J     PG_IF_13_E
PG_IF_13_1   DS    0H  &TYPE
*ZC    140         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_13_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (PD      +HFP-SRT)+(PD      +HFP-LNG)+(PD      +HFP-EXT)
*            +(PD      +BFP-SRT)+(PD      +BFP-LNG)+(PD      +BFP-EXT)
*            +(PD      +DFP-SRT)+(PD      +DFP-LNG)+(PD      +DFP-EXT)
*            +(PD      +HW     )+(PD      +FW     )+(PD      +DW     )
*            +(PD      +QW     )+(PD      +PD     )+(PD      +ZD     )
*            -30*1234
*ZC    141         COMPUTE FLT_SRT,=,'(',PD,+,HFP_SRT,')',+,'(',PD,+,HFX
               P_LNG,')',+,'(',PD,+,HFP_EXT,')',+,'(',PD,+,BFP_SRT,')',X
               +,'(',PD,+,BFP_LNG,')',+,'(',PD,+,BFP_EXT,')',+,'(',PD,+X
               ,DFP_SRT,')',+,'(',PD,+,DFP_LNG,')',+,'(',PD,+,DFP_EXT,'X
               )',+,'(',PD,+,HW,')',+,'(',PD,+,FW,')',+,'(',PD,+,DW,')'X
               ,+,'(',PD,+,QW,')',+,'(',PD,+,PD,')',+,'(',PD,+,ZD,')',-X
               ,30,*,1234
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    148         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_14_1
*ZC    148         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    148         ELSE
         J     PG_IF_14_E
PG_IF_14_1   DS    0H  &TYPE
*ZC    148         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_14_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (ZD      +HFP-SRT)+(ZD      +HFP-LNG)+(ZD      +HFP-EXT)
*            +(ZD      +BFP-SRT)+(ZD      +BFP-LNG)+(ZD      +BFP-EXT)
*            +(ZD      +DFP-SRT)+(ZD      +DFP-LNG)+(ZD      +DFP-EXT)
*            +(ZD      +HW     )+(ZD      +FW     )+(ZD      +DW     )
*            +(ZD      +QW     )+(ZD      +PD     )+(ZD      +ZD     )
*            -30*1234
*ZC    149         COMPUTE FLT_SRT,=,'(',ZD,+,HFP_SRT,')',+,'(',ZD,+,HFX
               P_LNG,')',+,'(',ZD,+,HFP_EXT,')',+,'(',ZD,+,BFP_SRT,')',X
               +,'(',ZD,+,BFP_LNG,')',+,'(',ZD,+,BFP_EXT,')',+,'(',ZD,+X
               ,DFP_SRT,')',+,'(',ZD,+,DFP_LNG,')',+,'(',ZD,+,DFP_EXT,'X
               )',+,'(',ZD,+,HW,')',+,'(',ZD,+,FW,')',+,'(',ZD,+,DW,')'X
               ,+,'(',ZD,+,QW,')',+,'(',ZD,+,PD,')',+,'(',ZD,+,ZD,')',-X
               ,30,*,1234
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         CVBG  0,ZCVT_PWORK1
         STG   0,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         AG    ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         ALG   ZC_R1,8+ZCVT_WORKAREA+16
         ALCG  ZC_R0,ZCVT_WORKAREA+16
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,30
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,1234
         STG    ZC_R0,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         CDGTR ZC_F0,ZC_R0
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    156         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_15_1
*ZC    156         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    156         ELSE
         J     PG_IF_15_E
PG_IF_15_1   DS    0H  &TYPE
*ZC    156         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_15_E   DS    0H  &TYPE
*            DISPLAY 'TESTCMP2 TEST COMPUTE SUBTRACTION'
*ZC    157         DISPLAY 'TESTCMP2 TEST COMPUTE SUBTRACTION'
         BRAS  1,*+(WTO#2925_EOT-*+1)/2*2
         DC    AL2(WTO#2925_EOT-*,0),C'TESTCMP2 TEST COMPUTE SUBTRACTIOX
               N'
WTO#2925_EOT     EQU *
         SVC   35
*            COMPUTE FLT-SRT =
*             (HFP-SRT -HFP-SRT)+(HFP-SRT -HFP-LNG)+(HFP-SRT -HFP-EXT)
*            +(HFP-SRT -BFP-SRT)+(HFP-SRT -BFP-LNG)+(HFP-SRT -BFP-EXT)
*            +(HFP-SRT -DFP-SRT)+(HFP-SRT -DFP-LNG)+(HFP-SRT -DFP-EXT)
*            +(HFP-SRT -HW     )+(HFP-SRT -FW     )+(HFP-SRT -DW     )
*            +(HFP-SRT -QW     )+(HFP-SRT -PD     )+(HFP-SRT -ZD     )
*ZC    158         COMPUTE FLT_SRT,=,'(',HFP_SRT,-,HFP_SRT,')',+,'(',HFX
               P_SRT,-,HFP_LNG,')',+,'(',HFP_SRT,-,HFP_EXT,')',+,'(',HFX
               P_SRT,-,BFP_SRT,')',+,'(',HFP_SRT,-,BFP_LNG,')',+,'(',HFX
               P_SRT,-,BFP_EXT,')',+,'(',HFP_SRT,-,DFP_SRT,')',+,'(',HFX
               P_SRT,-,DFP_LNG,')',+,'(',HFP_SRT,-,DFP_EXT,')',+,'(',HFX
               P_SRT,-,HW,')',+,'(',HFP_SRT,-,FW,')',+,'(',HFP_SRT,-,DWX
               ,')',+,'(',HFP_SRT,-,QW,')',+,'(',HFP_SRT,-,PD,')',+,'('X
               ,HFP_SRT,-,ZD,')'
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    164         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_16_1
*ZC    164         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    164         ELSE
         J     PG_IF_16_E
PG_IF_16_1   DS    0H  &TYPE
*ZC    164         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_16_E   DS    0H  &TYPE
*            COMPUTE FLT-LNG =
*             (HFP-LNG -HFP-SRT)+(HFP-LNG -HFP-LNG)+(HFP-LNG -HFP-EXT)
*            +(HFP-LNG -BFP-SRT)+(HFP-LNG -BFP-LNG)+(HFP-LNG -BFP-EXT)
*            +(HFP-LNG -DFP-SRT)+(HFP-LNG -DFP-LNG)+(HFP-LNG -DFP-EXT)
*            +(HFP-LNG -HW     )+(HFP-LNG -FW     )+(HFP-LNG -DW     )
*            +(HFP-LNG -QW     )+(HFP-LNG -PD     )+(HFP-LNG -ZD     )
*ZC    165         COMPUTE FLT_LNG,=,'(',HFP_LNG,-,HFP_SRT,')',+,'(',HFX
               P_LNG,-,HFP_LNG,')',+,'(',HFP_LNG,-,HFP_EXT,')',+,'(',HFX
               P_LNG,-,BFP_SRT,')',+,'(',HFP_LNG,-,BFP_LNG,')',+,'(',HFX
               P_LNG,-,BFP_EXT,')',+,'(',HFP_LNG,-,DFP_SRT,')',+,'(',HFX
               P_LNG,-,DFP_LNG,')',+,'(',HFP_LNG,-,DFP_EXT,')',+,'(',HFX
               P_LNG,-,HW,')',+,'(',HFP_LNG,-,FW,')',+,'(',HFP_LNG,-,DWX
               ,')',+,'(',HFP_LNG,-,QW,')',+,'(',HFP_LNG,-,PD,')',+,'('X
               ,HFP_LNG,-,ZD,')'
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         STD   0,FLT_LNG
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,FLT_LNG
         ADTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,FLT_LNG
*            IF FLT-LNG = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    171         IF    FLT_LNG,=,0
         LD    0,FLT_LNG
         LARL  ZC_R1,=DD'0'
         LD    ZC_F1,0(ZC_R1)
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_17_1
*ZC    171         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    171         ELSE
         J     PG_IF_17_E
PG_IF_17_1   DS    0H  &TYPE
*ZC    171         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_17_E   DS    0H  &TYPE
*            COMPUTE FLT-EXT =
*             (HFP-EXT -HFP-SRT)+(HFP-EXT -HFP-LNG)+(HFP-EXT -HFP-EXT)
*            +(HFP-EXT -BFP-SRT)+(HFP-EXT -BFP-LNG)+(HFP-EXT -BFP-EXT)
*            +(HFP-EXT -DFP-SRT)+(HFP-EXT -DFP-LNG)+(HFP-EXT -DFP-EXT)
*            +(HFP-EXT -HW     )+(HFP-EXT -FW     )+(HFP-EXT -DW     )
*            +(HFP-EXT -QW     )+(HFP-EXT -PD     )+(HFP-EXT -ZD     )
*ZC    172         COMPUTE FLT_EXT,=,'(',HFP_EXT,-,HFP_SRT,')',+,'(',HFX
               P_EXT,-,HFP_LNG,')',+,'(',HFP_EXT,-,HFP_EXT,')',+,'(',HFX
               P_EXT,-,BFP_SRT,')',+,'(',HFP_EXT,-,BFP_LNG,')',+,'(',HFX
               P_EXT,-,BFP_EXT,')',+,'(',HFP_EXT,-,DFP_SRT,')',+,'(',HFX
               P_EXT,-,DFP_LNG,')',+,'(',HFP_EXT,-,DFP_EXT,')',+,'(',HFX
               P_EXT,-,HW,')',+,'(',HFP_EXT,-,FW,')',+,'(',HFP_EXT,-,DWX
               ,')',+,'(',HFP_EXT,-,QW,')',+,'(',HFP_EXT,-,PD,')',+,'('X
               ,HFP_EXT,-,ZD,')'
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   FLT_EXT,16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,FLT_EXT
         LD    ZC_F3,8+FLT_EXT
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,FLT_EXT
         STD   ZC_F2,8+FLT_EXT
*            IF FLT-EXT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    178         IF    FLT_EXT,=,0
         LD    0,FLT_EXT
         LD    2,8+FLT_EXT
         LARL  ZC_R1,=LD'0'
         LD    ZC_F1,0(ZC_R1)
         LD    ZC_F3,8(ZC_R1)
         CXTR  0,1
         BRC   15-ZC_EQ,PG_IF_18_1
*ZC    178         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    178         ELSE
         J     PG_IF_18_E
PG_IF_18_1   DS    0H  &TYPE
*ZC    178         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_18_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-SRT -HFP-SRT)+(BFP-SRT -HFP-LNG)+(BFP-SRT -HFP-EXT)
*            +(BFP-SRT -BFP-SRT)+(BFP-SRT -BFP-LNG)+(BFP-SRT -BFP-EXT)
*            +(BFP-SRT -DFP-SRT)+(BFP-SRT -DFP-LNG)+(BFP-SRT -DFP-EXT)
*            +(BFP-SRT -HW     )+(BFP-SRT -FW     )+(BFP-SRT -DW     )
*            +(BFP-SRT -QW     )+(BFP-SRT -PD     )+(BFP-SRT -ZD     )
*ZC    179         COMPUTE FLT_SRT,=,'(',BFP_SRT,-,HFP_SRT,')',+,'(',BFX
               P_SRT,-,HFP_LNG,')',+,'(',BFP_SRT,-,HFP_EXT,')',+,'(',BFX
               P_SRT,-,BFP_SRT,')',+,'(',BFP_SRT,-,BFP_LNG,')',+,'(',BFX
               P_SRT,-,BFP_EXT,')',+,'(',BFP_SRT,-,DFP_SRT,')',+,'(',BFX
               P_SRT,-,DFP_LNG,')',+,'(',BFP_SRT,-,DFP_EXT,')',+,'(',BFX
               P_SRT,-,HW,')',+,'(',BFP_SRT,-,FW,')',+,'(',BFP_SRT,-,DWX
               ,')',+,'(',BFP_SRT,-,QW,')',+,'(',BFP_SRT,-,PD,')',+,'('X
               ,BFP_SRT,-,ZD,')'
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    185         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_19_1
*ZC    185         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    185         ELSE
         J     PG_IF_19_E
PG_IF_19_1   DS    0H  &TYPE
*ZC    185         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_19_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-LNG -HFP-SRT)+(BFP-LNG -HFP-LNG)+(BFP-LNG -HFP-EXT)
*            +(BFP-LNG -BFP-SRT)+(BFP-LNG -BFP-LNG)+(BFP-LNG -BFP-EXT)
*            +(BFP-LNG -DFP-SRT)+(BFP-LNG -DFP-LNG)+(BFP-LNG -DFP-EXT)
*            +(BFP-LNG -HW     )+(BFP-LNG -FW     )+(BFP-LNG -DW     )
*            +(BFP-LNG -QW     )+(BFP-LNG -PD     )+(BFP-LNG -ZD     )
*ZC    186         COMPUTE FLT_SRT,=,'(',BFP_LNG,-,HFP_SRT,')',+,'(',BFX
               P_LNG,-,HFP_LNG,')',+,'(',BFP_LNG,-,HFP_EXT,')',+,'(',BFX
               P_LNG,-,BFP_SRT,')',+,'(',BFP_LNG,-,BFP_LNG,')',+,'(',BFX
               P_LNG,-,BFP_EXT,')',+,'(',BFP_LNG,-,DFP_SRT,')',+,'(',BFX
               P_LNG,-,DFP_LNG,')',+,'(',BFP_LNG,-,DFP_EXT,')',+,'(',BFX
               P_LNG,-,HW,')',+,'(',BFP_LNG,-,FW,')',+,'(',BFP_LNG,-,DWX
               ,')',+,'(',BFP_LNG,-,QW,')',+,'(',BFP_LNG,-,PD,')',+,'('X
               ,BFP_LNG,-,ZD,')'
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    192         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_20_1
*ZC    192         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    192         ELSE
         J     PG_IF_20_E
PG_IF_20_1   DS    0H  &TYPE
*ZC    192         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_20_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-EXT -HFP-SRT)+(BFP-EXT -HFP-LNG)+(BFP-EXT -HFP-EXT)
*            +(BFP-EXT -BFP-SRT)+(BFP-EXT -BFP-LNG)+(BFP-EXT -BFP-EXT)
*            +(BFP-EXT -DFP-SRT)+(BFP-EXT -DFP-LNG)+(BFP-EXT -DFP-EXT)
*            +(BFP-EXT -HW     )+(BFP-EXT -FW     )+(BFP-EXT -DW     )
*            +(BFP-EXT -QW     )+(BFP-EXT -PD     )+(BFP-EXT -ZD     )
*ZC    193         COMPUTE FLT_SRT,=,'(',BFP_EXT,-,HFP_SRT,')',+,'(',BFX
               P_EXT,-,HFP_LNG,')',+,'(',BFP_EXT,-,HFP_EXT,')',+,'(',BFX
               P_EXT,-,BFP_SRT,')',+,'(',BFP_EXT,-,BFP_LNG,')',+,'(',BFX
               P_EXT,-,BFP_EXT,')',+,'(',BFP_EXT,-,DFP_SRT,')',+,'(',BFX
               P_EXT,-,DFP_LNG,')',+,'(',BFP_EXT,-,DFP_EXT,')',+,'(',BFX
               P_EXT,-,HW,')',+,'(',BFP_EXT,-,FW,')',+,'(',BFP_EXT,-,DWX
               ,')',+,'(',BFP_EXT,-,QW,')',+,'(',BFP_EXT,-,PD,')',+,'('X
               ,BFP_EXT,-,ZD,')'
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    199         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_21_1
*ZC    199         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    199         ELSE
         J     PG_IF_21_E
PG_IF_21_1   DS    0H  &TYPE
*ZC    199         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_21_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-SRT -HFP-SRT)+(DFP-SRT -HFP-LNG)+(DFP-SRT -HFP-EXT)
*            +(DFP-SRT -BFP-SRT)+(DFP-SRT -BFP-LNG)+(DFP-SRT -BFP-EXT)
*            +(DFP-SRT -DFP-SRT)+(DFP-SRT -DFP-LNG)+(DFP-SRT -DFP-EXT)
*            +(DFP-SRT -HW     )+(DFP-SRT -FW     )+(DFP-SRT -DW     )
*            +(DFP-SRT -QW     )+(DFP-SRT -PD     )+(DFP-SRT -ZD     )
*ZC    200         COMPUTE FLT_SRT,=,'(',DFP_SRT,-,HFP_SRT,')',+,'(',DFX
               P_SRT,-,HFP_LNG,')',+,'(',DFP_SRT,-,HFP_EXT,')',+,'(',DFX
               P_SRT,-,BFP_SRT,')',+,'(',DFP_SRT,-,BFP_LNG,')',+,'(',DFX
               P_SRT,-,BFP_EXT,')',+,'(',DFP_SRT,-,DFP_SRT,')',+,'(',DFX
               P_SRT,-,DFP_LNG,')',+,'(',DFP_SRT,-,DFP_EXT,')',+,'(',DFX
               P_SRT,-,HW,')',+,'(',DFP_SRT,-,FW,')',+,'(',DFP_SRT,-,DWX
               ,')',+,'(',DFP_SRT,-,QW,')',+,'(',DFP_SRT,-,PD,')',+,'('X
               ,DFP_SRT,-,ZD,')'
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    206         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_22_1
*ZC    206         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    206         ELSE
         J     PG_IF_22_E
PG_IF_22_1   DS    0H  &TYPE
*ZC    206         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_22_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-LNG -HFP-SRT)+(DFP-LNG -HFP-LNG)+(DFP-LNG -HFP-EXT)
*            +(DFP-LNG -BFP-SRT)+(DFP-LNG -BFP-LNG)+(DFP-LNG -BFP-EXT)
*            +(DFP-LNG -DFP-SRT)+(DFP-LNG -DFP-LNG)+(DFP-LNG -DFP-EXT)
*            +(DFP-LNG -HW     )+(DFP-LNG -FW     )+(DFP-LNG -DW     )
*            +(DFP-LNG -QW     )+(DFP-LNG -PD     )+(DFP-LNG -ZD     )
*ZC    207         COMPUTE FLT_SRT,=,'(',DFP_LNG,-,HFP_SRT,')',+,'(',DFX
               P_LNG,-,HFP_LNG,')',+,'(',DFP_LNG,-,HFP_EXT,')',+,'(',DFX
               P_LNG,-,BFP_SRT,')',+,'(',DFP_LNG,-,BFP_LNG,')',+,'(',DFX
               P_LNG,-,BFP_EXT,')',+,'(',DFP_LNG,-,DFP_SRT,')',+,'(',DFX
               P_LNG,-,DFP_LNG,')',+,'(',DFP_LNG,-,DFP_EXT,')',+,'(',DFX
               P_LNG,-,HW,')',+,'(',DFP_LNG,-,FW,')',+,'(',DFP_LNG,-,DWX
               ,')',+,'(',DFP_LNG,-,QW,')',+,'(',DFP_LNG,-,PD,')',+,'('X
               ,DFP_LNG,-,ZD,')'
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    213         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_23_1
*ZC    213         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    213         ELSE
         J     PG_IF_23_E
PG_IF_23_1   DS    0H  &TYPE
*ZC    213         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_23_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-EXT -HFP-SRT)+(DFP-EXT -HFP-LNG)+(DFP-EXT -HFP-EXT)
*            +(DFP-EXT -BFP-SRT)+(DFP-EXT -BFP-LNG)+(DFP-EXT -BFP-EXT)
*            +(DFP-EXT -DFP-SRT)+(DFP-EXT -DFP-LNG)+(DFP-EXT -DFP-EXT)
*            +(DFP-EXT -HW     )+(DFP-EXT -FW     )+(DFP-EXT -DW     )
*            +(DFP-EXT -QW     )+(DFP-EXT -PD     )+(DFP-EXT -ZD     )
*ZC    214         COMPUTE FLT_SRT,=,'(',DFP_EXT,-,HFP_SRT,')',+,'(',DFX
               P_EXT,-,HFP_LNG,')',+,'(',DFP_EXT,-,HFP_EXT,')',+,'(',DFX
               P_EXT,-,BFP_SRT,')',+,'(',DFP_EXT,-,BFP_LNG,')',+,'(',DFX
               P_EXT,-,BFP_EXT,')',+,'(',DFP_EXT,-,DFP_SRT,')',+,'(',DFX
               P_EXT,-,DFP_LNG,')',+,'(',DFP_EXT,-,DFP_EXT,')',+,'(',DFX
               P_EXT,-,HW,')',+,'(',DFP_EXT,-,FW,')',+,'(',DFP_EXT,-,DWX
               ,')',+,'(',DFP_EXT,-,QW,')',+,'(',DFP_EXT,-,PD,')',+,'('X
               ,DFP_EXT,-,ZD,')'
         MVC   ZCVT_WORKAREA+0(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LD    ZC_F4,ZCVT_WORKAREA+16
         LD    ZC_F6,8+ZCVT_WORKAREA+16
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    220         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_24_1
*ZC    220         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    220         ELSE
         J     PG_IF_24_E
PG_IF_24_1   DS    0H  &TYPE
*ZC    220         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_24_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (HW      -HFP-SRT)+(HW      -HFP-LNG)+(HW      -HFP-EXT)
*            +(HW      -BFP-SRT)+(HW      -BFP-LNG)+(HW      -BFP-EXT)
*            +(HW      -DFP-SRT)+(HW      -DFP-LNG)+(HW      -DFP-EXT)
*            +(HW      -HW     )+(HW      -FW     )+(HW      -DW     )
*            +(HW      -QW     )+(HW      -PD     )+(HW      -ZD     )
*ZC    221         COMPUTE FLT_SRT,=,'(',HW,-,HFP_SRT,')',+,'(',HW,-,HFX
               P_LNG,')',+,'(',HW,-,HFP_EXT,')',+,'(',HW,-,BFP_SRT,')',X
               +,'(',HW,-,BFP_LNG,')',+,'(',HW,-,BFP_EXT,')',+,'(',HW,-X
               ,DFP_SRT,')',+,'(',HW,-,DFP_LNG,')',+,'(',HW,-,DFP_EXT,'X
               )',+,'(',HW,-,HW,')',+,'(',HW,-,FW,')',+,'(',HW,-,DW,')'X
               ,+,'(',HW,-,QW,')',+,'(',HW,-,PD,')',+,'(',HW,-,ZD,')'
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         STG   0,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LG    ZC_R1,ZCVT_WORKAREA+16
         SGR   ZC_R1,ZC_R0
         STG   ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         STG   0,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LG    ZC_R1,ZCVT_WORKAREA+16
         SGR   ZC_R1,ZC_R0
         STG   ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    227         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_25_1
*ZC    227         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    227         ELSE
         J     PG_IF_25_E
PG_IF_25_1   DS    0H  &TYPE
*ZC    227         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_25_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (FW      -HFP-SRT)+(FW      -HFP-LNG)+(FW      -HFP-EXT)
*            +(FW      -BFP-SRT)+(FW      -BFP-LNG)+(FW      -BFP-EXT)
*            +(FW      -DFP-SRT)+(FW      -DFP-LNG)+(FW      -DFP-EXT)
*            +(FW      -HW     )+(FW      -FW     )+(FW      -DW     )
*            +(FW      -QW     )+(FW      -PD     )+(FW      -ZD     )
*ZC    228         COMPUTE FLT_SRT,=,'(',FW,-,HFP_SRT,')',+,'(',FW,-,HFX
               P_LNG,')',+,'(',FW,-,HFP_EXT,')',+,'(',FW,-,BFP_SRT,')',X
               +,'(',FW,-,BFP_LNG,')',+,'(',FW,-,BFP_EXT,')',+,'(',FW,-X
               ,DFP_SRT,')',+,'(',FW,-,DFP_LNG,')',+,'(',FW,-,DFP_EXT,'X
               )',+,'(',FW,-,HW,')',+,'(',FW,-,FW,')',+,'(',FW,-,DW,')'X
               ,+,'(',FW,-,QW,')',+,'(',FW,-,PD,')',+,'(',FW,-,ZD,')'
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         STG   0,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LG    ZC_R1,ZCVT_WORKAREA+16
         SGR   ZC_R1,ZC_R0
         STG   ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    234         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_26_1
*ZC    234         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    234         ELSE
         J     PG_IF_26_E
PG_IF_26_1   DS    0H  &TYPE
*ZC    234         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_26_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DW      -HFP-SRT)+(DW      -HFP-LNG)+(DW      -HFP-EXT)
*            +(DW      -BFP-SRT)+(DW      -BFP-LNG)+(DW      -BFP-EXT)
*            +(DW      -DFP-SRT)+(DW      -DFP-LNG)+(DW      -DFP-EXT)
*            +(DW      -HW     )+(DW      -FW     )+(DW      -DW     )
*            +(DW      -QW     )+(DW      -PD     )+(DW      -ZD     )
*ZC    235         COMPUTE FLT_SRT,=,'(',DW,-,HFP_SRT,')',+,'(',DW,-,HFX
               P_LNG,')',+,'(',DW,-,HFP_EXT,')',+,'(',DW,-,BFP_SRT,')',X
               +,'(',DW,-,BFP_LNG,')',+,'(',DW,-,BFP_EXT,')',+,'(',DW,-X
               ,DFP_SRT,')',+,'(',DW,-,DFP_LNG,')',+,'(',DW,-,DFP_EXT,'X
               )',+,'(',DW,-,HW,')',+,'(',DW,-,FW,')',+,'(',DW,-,DW,')'X
               ,+,'(',DW,-,QW,')',+,'(',DW,-,PD,')',+,'(',DW,-,ZD,')'
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    241         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_27_1
*ZC    241         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    241         ELSE
         J     PG_IF_27_E
PG_IF_27_1   DS    0H  &TYPE
*ZC    241         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_27_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (QW      -HFP-SRT)+(QW      -HFP-LNG)+(QW      -HFP-EXT)
*            +(QW      -BFP-SRT)+(QW      -BFP-LNG)+(QW      -BFP-EXT)
*            +(QW      -DFP-SRT)+(QW      -DFP-LNG)+(QW      -DFP-EXT)
*            +(QW      -HW     )+(QW      -FW     )+(QW      -DW     )
*            +(QW      -QW     )+(QW      -PD     )+(QW      -ZD     )
*ZC    242         COMPUTE FLT_SRT,=,'(',QW,-,HFP_SRT,')',+,'(',QW,-,HFX
               P_LNG,')',+,'(',QW,-,HFP_EXT,')',+,'(',QW,-,BFP_SRT,')',X
               +,'(',QW,-,BFP_LNG,')',+,'(',QW,-,BFP_EXT,')',+,'(',QW,-X
               ,DFP_SRT,')',+,'(',QW,-,DFP_LNG,')',+,'(',QW,-,DFP_EXT,'X
               )',+,'(',QW,-,HW,')',+,'(',QW,-,FW,')',+,'(',QW,-,DW,')'X
               ,+,'(',QW,-,QW,')',+,'(',QW,-,PD,')',+,'(',QW,-,ZD,')'
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    248         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_28_1
*ZC    248         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    248         ELSE
         J     PG_IF_28_E
PG_IF_28_1   DS    0H  &TYPE
*ZC    248         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_28_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (PD      -HFP-SRT)+(PD      -HFP-LNG)+(PD      -HFP-EXT)
*            +(PD      -BFP-SRT)+(PD      -BFP-LNG)+(PD      -BFP-EXT)
*            +(PD      -DFP-SRT)+(PD      -DFP-LNG)+(PD      -DFP-EXT)
*            +(PD      -HW     )+(PD      -FW     )+(PD      -DW     )
*            +(PD      -QW     )+(PD      -PD     )+(PD      -ZD     )
*ZC    249         COMPUTE FLT_SRT,=,'(',PD,-,HFP_SRT,')',+,'(',PD,-,HFX
               P_LNG,')',+,'(',PD,-,HFP_EXT,')',+,'(',PD,-,BFP_SRT,')',X
               +,'(',PD,-,BFP_LNG,')',+,'(',PD,-,BFP_EXT,')',+,'(',PD,-X
               ,DFP_SRT,')',+,'(',PD,-,DFP_LNG,')',+,'(',PD,-,DFP_EXT,'X
               )',+,'(',PD,-,HW,')',+,'(',PD,-,FW,')',+,'(',PD,-,DW,')'X
               ,+,'(',PD,-,QW,')',+,'(',PD,-,PD,')',+,'(',PD,-,ZD,')'
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    255         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_29_1
*ZC    255         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    255         ELSE
         J     PG_IF_29_E
PG_IF_29_1   DS    0H  &TYPE
*ZC    255         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_29_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (ZD      -HFP-SRT)+(ZD      -HFP-LNG)+(ZD      -HFP-EXT)
*            +(ZD      -BFP-SRT)+(ZD      -BFP-LNG)+(ZD      -BFP-EXT)
*            +(ZD      -DFP-SRT)+(ZD      -DFP-LNG)+(ZD      -DFP-EXT)
*            +(ZD      -HW     )+(ZD      -FW     )+(ZD      -DW     )
*            +(ZD      -QW     )+(ZD      -PD     )+(ZD      -ZD     )
*ZC    256         COMPUTE FLT_SRT,=,'(',ZD,-,HFP_SRT,')',+,'(',ZD,-,HFX
               P_LNG,')',+,'(',ZD,-,HFP_EXT,')',+,'(',ZD,-,BFP_SRT,')',X
               +,'(',ZD,-,BFP_LNG,')',+,'(',ZD,-,BFP_EXT,')',+,'(',ZD,-X
               ,DFP_SRT,')',+,'(',ZD,-,DFP_LNG,')',+,'(',ZD,-,DFP_EXT,'X
               )',+,'(',ZD,-,HW,')',+,'(',ZD,-,FW,')',+,'(',ZD,-,DW,')'X
               ,+,'(',ZD,-,QW,')',+,'(',ZD,-,PD,')',+,'(',ZD,-,ZD,')'
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+0
         STD   ZC_F3,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,ZCVT_WORKAREA+16
         STD   ZC_F3,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         CVBG  0,ZCVT_PWORK1
         STG   0,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LG    ZC_R1,ZCVT_WORKAREA+16
         SGR   ZC_R1,ZC_R0
         STG   ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         SLGR  ZC_R3,ZC_R1
         SLBGR ZC_R2,ZC_R0
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         LD    ZC_F4,ZCVT_WORKAREA+32
         LD    ZC_F6,8+ZCVT_WORKAREA+32
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         ADTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    262         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_30_1
*ZC    262         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    262         ELSE
         J     PG_IF_30_E
PG_IF_30_1   DS    0H  &TYPE
*ZC    262         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_30_E   DS    0H  &TYPE
*            DISPLAY 'TESTCMP2 TEST COMPUTE MULTIPLICATION'
*ZC    263         DISPLAY 'TESTCMP2 TEST COMPUTE MULTIPLICATION'
         BRAS  1,*+(WTO#5604_EOT-*+1)/2*2
         DC    AL2(WTO#5604_EOT-*,0),C'TESTCMP2 TEST COMPUTE MULTIPLICAX
               TION'
WTO#5604_EOT     EQU *
         SVC   35
*            MOVE 2 TO
*              HFP-SRT HFP-LNG HFP-EXT
*              BFP-SRT BFP-LNG BFP-EXT
*              DFP-SRT DFP-LNG DFP-EXT
*              HW      FW      DW
*              QW      PD      ZD
*ZC    264         MOVE  2,TO,HFP_SRT,HFP_LNG,HFP_EXT,BFP_SRT,BFP_LNG,BX
               FP_EXT,DFP_SRT,DFP_LNG,DFP_EXT,HW,FW,DW,QW,PD,ZD
          LARL  ZC_R1,=EH'2'
          MVC   HFP_SRT,0(ZC_R1)
          LARL  ZC_R1,=DH'2'
          MVC   HFP_LNG,0(ZC_R1)
          LARL  ZC_R1,=LH'2'
          MVC   HFP_EXT,0(ZC_R1)
          LARL  ZC_R1,=EB'2'
          MVC   BFP_SRT,0(ZC_R1)
          LARL  ZC_R1,=DB'2'
          MVC   BFP_LNG,0(ZC_R1)
          LARL  ZC_R1,=LB'2'
          MVC   BFP_EXT,0(ZC_R1)
          LARL  ZC_R1,=ED'2'
          MVC   DFP_SRT,0(ZC_R1)
          LARL  ZC_R1,=DD'2'
          MVC   DFP_LNG,0(ZC_R1)
          LARL  ZC_R1,=LD'2'
          MVC   DFP_EXT,0(ZC_R1)
          MVHHI HW,2
          MVHI  FW,2
          MVGHI DW,2
          LARL  ZC_R1,=FL16'2'
          MVC   QW,0(ZC_R1)
          LARL  ZC_R1,=PL16'2'
          MVC   PD,0(ZC_R1)
          LARL  ZC_R1,=ZL32'2'
          MVC   ZD,1(ZC_R1)
*            COMPUTE FLT-SRT =
*             (HFP-SRT *HFP-SRT)+(HFP-SRT *HFP-LNG)+(HFP-SRT *HFP-EXT)
*            +(HFP-SRT *BFP-SRT)+(HFP-SRT *BFP-LNG)+(HFP-SRT *BFP-EXT)
*            +(HFP-SRT *DFP-SRT)+(HFP-SRT *DFP-LNG)+(HFP-SRT *DFP-EXT)
*            +(HFP-SRT *HW     )+(HFP-SRT *FW     )+(HFP-SRT *DW     )
*            +(HFP-SRT *QW     )+(HFP-SRT *PD     )+(HFP-SRT *ZD     )
*            -15*2*2
*ZC    270         COMPUTE FLT_SRT,=,'(',HFP_SRT,*,HFP_SRT,')',+,'(',HFX
               P_SRT,*,HFP_LNG,')',+,'(',HFP_SRT,*,HFP_EXT,')',+,'(',HFX
               P_SRT,*,BFP_SRT,')',+,'(',HFP_SRT,*,BFP_LNG,')',+,'(',HFX
               P_SRT,*,BFP_EXT,')',+,'(',HFP_SRT,*,DFP_SRT,')',+,'(',HFX
               P_SRT,*,DFP_LNG,')',+,'(',HFP_SRT,*,DFP_EXT,')',+,'(',HFX
               P_SRT,*,HW,')',+,'(',HFP_SRT,*,FW,')',+,'(',HFP_SRT,*,DWX
               ,')',+,'(',HFP_SRT,*,QW,')',+,'(',HFP_SRT,*,PD,')',+,'('X
               ,HFP_SRT,*,ZD,')',-,15,*,2,*,2
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    277         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_31_1
*ZC    277         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    277         ELSE
         J     PG_IF_31_E
PG_IF_31_1   DS    0H  &TYPE
*ZC    277         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_31_E   DS    0H  &TYPE
*            COMPUTE FLT-LNG =
*             (HFP-LNG *HFP-SRT)+(HFP-LNG *HFP-LNG)+(HFP-LNG *HFP-EXT)
*            +(HFP-LNG *BFP-SRT)+(HFP-LNG *BFP-LNG)+(HFP-LNG *BFP-EXT)
*            +(HFP-LNG *DFP-SRT)+(HFP-LNG *DFP-LNG)+(HFP-LNG *DFP-EXT)
*            +(HFP-LNG *HW     )+(HFP-LNG *FW     )+(HFP-LNG *DW     )
*            +(HFP-LNG *QW     )+(HFP-LNG *PD     )+(HFP-LNG *ZD     )
*            -15*2*2
*ZC    278         COMPUTE FLT_LNG,=,'(',HFP_LNG,*,HFP_SRT,')',+,'(',HFX
               P_LNG,*,HFP_LNG,')',+,'(',HFP_LNG,*,HFP_EXT,')',+,'(',HFX
               P_LNG,*,BFP_SRT,')',+,'(',HFP_LNG,*,BFP_LNG,')',+,'(',HFX
               P_LNG,*,BFP_EXT,')',+,'(',HFP_LNG,*,DFP_SRT,')',+,'(',HFX
               P_LNG,*,DFP_LNG,')',+,'(',HFP_LNG,*,DFP_EXT,')',+,'(',HFX
               P_LNG,*,HW,')',+,'(',HFP_LNG,*,FW,')',+,'(',HFP_LNG,*,DWX
               ,')',+,'(',HFP_LNG,*,QW,')',+,'(',HFP_LNG,*,PD,')',+,'('X
               ,HFP_LNG,*,ZD,')',-,15,*,2,*,2
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         STD   0,FLT_LNG
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,FLT_LNG
         SDTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,FLT_LNG
*            IF FLT-LNG = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    285         IF    FLT_LNG,=,0
         LD    0,FLT_LNG
         LARL  ZC_R1,=DD'0'
         LD    ZC_F1,0(ZC_R1)
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_32_1
*ZC    285         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    285         ELSE
         J     PG_IF_32_E
PG_IF_32_1   DS    0H  &TYPE
*ZC    285         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_32_E   DS    0H  &TYPE
*            COMPUTE FLT-EXT =
*             (HFP-EXT *HFP-SRT)+(HFP-EXT *HFP-LNG)+(HFP-EXT *HFP-EXT)
*            +(HFP-EXT *BFP-SRT)+(HFP-EXT *BFP-LNG)+(HFP-EXT *BFP-EXT)
*            +(HFP-EXT *DFP-SRT)+(HFP-EXT *DFP-LNG)+(HFP-EXT *DFP-EXT)
*            +(HFP-EXT *HW     )+(HFP-EXT *FW     )+(HFP-EXT *DW     )
*            +(HFP-EXT *QW     )+(HFP-EXT *PD     )+(HFP-EXT *ZD     )
*            -15*2*2
*ZC    286         COMPUTE FLT_EXT,=,'(',HFP_EXT,*,HFP_SRT,')',+,'(',HFX
               P_EXT,*,HFP_LNG,')',+,'(',HFP_EXT,*,HFP_EXT,')',+,'(',HFX
               P_EXT,*,BFP_SRT,')',+,'(',HFP_EXT,*,BFP_LNG,')',+,'(',HFX
               P_EXT,*,BFP_EXT,')',+,'(',HFP_EXT,*,DFP_SRT,')',+,'(',HFX
               P_EXT,*,DFP_LNG,')',+,'(',HFP_EXT,*,DFP_EXT,')',+,'(',HFX
               P_EXT,*,HW,')',+,'(',HFP_EXT,*,FW,')',+,'(',HFP_EXT,*,DWX
               ,')',+,'(',HFP_EXT,*,QW,')',+,'(',HFP_EXT,*,PD,')',+,'('X
               ,HFP_EXT,*,ZD,')',-,15,*,2,*,2
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         MVC   FLT_EXT,16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,FLT_EXT
         LD    ZC_F3,8+FLT_EXT
         SXTR  ZC_F1,ZC_F1,ZC_F0
         STD   ZC_F1,FLT_EXT
         STD   ZC_F3,8+FLT_EXT
*            IF FLT-EXT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    293         IF    FLT_EXT,=,0
         LD    0,FLT_EXT
         LD    2,8+FLT_EXT
         LARL  ZC_R1,=LD'0'
         LD    ZC_F1,0(ZC_R1)
         LD    ZC_F3,8(ZC_R1)
         CXTR  0,1
         BRC   15-ZC_EQ,PG_IF_33_1
*ZC    293         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    293         ELSE
         J     PG_IF_33_E
PG_IF_33_1   DS    0H  &TYPE
*ZC    293         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_33_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-SRT *HFP-SRT)+(BFP-SRT *HFP-LNG)+(BFP-SRT *HFP-EXT)
*            +(BFP-SRT *BFP-SRT)+(BFP-SRT *BFP-LNG)+(BFP-SRT *BFP-EXT)
*            +(BFP-SRT *DFP-SRT)+(BFP-SRT *DFP-LNG)+(BFP-SRT *DFP-EXT)
*            +(BFP-SRT *HW     )+(BFP-SRT *FW     )+(BFP-SRT *DW     )
*            +(BFP-SRT *QW     )+(BFP-SRT *PD     )+(BFP-SRT *ZD     )
*            -15*2*2
*ZC    294         COMPUTE FLT_SRT,=,'(',BFP_SRT,*,HFP_SRT,')',+,'(',BFX
               P_SRT,*,HFP_LNG,')',+,'(',BFP_SRT,*,HFP_EXT,')',+,'(',BFX
               P_SRT,*,BFP_SRT,')',+,'(',BFP_SRT,*,BFP_LNG,')',+,'(',BFX
               P_SRT,*,BFP_EXT,')',+,'(',BFP_SRT,*,DFP_SRT,')',+,'(',BFX
               P_SRT,*,DFP_LNG,')',+,'(',BFP_SRT,*,DFP_EXT,')',+,'(',BFX
               P_SRT,*,HW,')',+,'(',BFP_SRT,*,FW,')',+,'(',BFP_SRT,*,DWX
               ,')',+,'(',BFP_SRT,*,QW,')',+,'(',BFP_SRT,*,PD,')',+,'('X
               ,BFP_SRT,*,ZD,')',-,15,*,2,*,2
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    301         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_34_1
*ZC    301         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    301         ELSE
         J     PG_IF_34_E
PG_IF_34_1   DS    0H  &TYPE
*ZC    301         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_34_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-LNG *HFP-SRT)+(BFP-LNG *HFP-LNG)+(BFP-LNG *HFP-EXT)
*            +(BFP-LNG *BFP-SRT)+(BFP-LNG *BFP-LNG)+(BFP-LNG *BFP-EXT)
*            +(BFP-LNG *DFP-SRT)+(BFP-LNG *DFP-LNG)+(BFP-LNG *DFP-EXT)
*            +(BFP-LNG *HW     )+(BFP-LNG *FW     )+(BFP-LNG *DW     )
*            +(BFP-LNG *QW     )+(BFP-LNG *PD     )+(BFP-LNG *ZD     )
*            -15*2*2
*ZC    302         COMPUTE FLT_SRT,=,'(',BFP_LNG,*,HFP_SRT,')',+,'(',BFX
               P_LNG,*,HFP_LNG,')',+,'(',BFP_LNG,*,HFP_EXT,')',+,'(',BFX
               P_LNG,*,BFP_SRT,')',+,'(',BFP_LNG,*,BFP_LNG,')',+,'(',BFX
               P_LNG,*,BFP_EXT,')',+,'(',BFP_LNG,*,DFP_SRT,')',+,'(',BFX
               P_LNG,*,DFP_LNG,')',+,'(',BFP_LNG,*,DFP_EXT,')',+,'(',BFX
               P_LNG,*,HW,')',+,'(',BFP_LNG,*,FW,')',+,'(',BFP_LNG,*,DWX
               ,')',+,'(',BFP_LNG,*,QW,')',+,'(',BFP_LNG,*,PD,')',+,'('X
               ,BFP_LNG,*,ZD,')',-,15,*,2,*,2
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    309         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_35_1
*ZC    309         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    309         ELSE
         J     PG_IF_35_E
PG_IF_35_1   DS    0H  &TYPE
*ZC    309         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_35_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-EXT *HFP-SRT)+(BFP-EXT *HFP-LNG)+(BFP-EXT *HFP-EXT)
*            +(BFP-EXT *BFP-SRT)+(BFP-EXT *BFP-LNG)+(BFP-EXT *BFP-EXT)
*            +(BFP-EXT *DFP-SRT)+(BFP-EXT *DFP-LNG)+(BFP-EXT *DFP-EXT)
*            +(BFP-EXT *HW     )+(BFP-EXT *FW     )+(BFP-EXT *DW     )
*            +(BFP-EXT *QW     )+(BFP-EXT *PD     )+(BFP-EXT *ZD     )
*            -15*2*2
*ZC    310         COMPUTE FLT_SRT,=,'(',BFP_EXT,*,HFP_SRT,')',+,'(',BFX
               P_EXT,*,HFP_LNG,')',+,'(',BFP_EXT,*,HFP_EXT,')',+,'(',BFX
               P_EXT,*,BFP_SRT,')',+,'(',BFP_EXT,*,BFP_LNG,')',+,'(',BFX
               P_EXT,*,BFP_EXT,')',+,'(',BFP_EXT,*,DFP_SRT,')',+,'(',BFX
               P_EXT,*,DFP_LNG,')',+,'(',BFP_EXT,*,DFP_EXT,')',+,'(',BFX
               P_EXT,*,HW,')',+,'(',BFP_EXT,*,FW,')',+,'(',BFP_EXT,*,DWX
               ,')',+,'(',BFP_EXT,*,QW,')',+,'(',BFP_EXT,*,PD,')',+,'('X
               ,BFP_EXT,*,ZD,')',-,15,*,2,*,2
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    317         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_36_1
*ZC    317         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    317         ELSE
         J     PG_IF_36_E
PG_IF_36_1   DS    0H  &TYPE
*ZC    317         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_36_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-SRT *HFP-SRT)+(DFP-SRT *HFP-LNG)+(DFP-SRT *HFP-EXT)
*            +(DFP-SRT *BFP-SRT)+(DFP-SRT *BFP-LNG)+(DFP-SRT *BFP-EXT)
*            +(DFP-SRT *DFP-SRT)+(DFP-SRT *DFP-LNG)+(DFP-SRT *DFP-EXT)
*            +(DFP-SRT *HW     )+(DFP-SRT *FW     )+(DFP-SRT *DW     )
*            +(DFP-SRT *QW     )+(DFP-SRT *PD     )+(DFP-SRT *ZD     )
*            -15*2*2
*ZC    318         COMPUTE FLT_SRT,=,'(',DFP_SRT,*,HFP_SRT,')',+,'(',DFX
               P_SRT,*,HFP_LNG,')',+,'(',DFP_SRT,*,HFP_EXT,')',+,'(',DFX
               P_SRT,*,BFP_SRT,')',+,'(',DFP_SRT,*,BFP_LNG,')',+,'(',DFX
               P_SRT,*,BFP_EXT,')',+,'(',DFP_SRT,*,DFP_SRT,')',+,'(',DFX
               P_SRT,*,DFP_LNG,')',+,'(',DFP_SRT,*,DFP_EXT,')',+,'(',DFX
               P_SRT,*,HW,')',+,'(',DFP_SRT,*,FW,')',+,'(',DFP_SRT,*,DWX
               ,')',+,'(',DFP_SRT,*,QW,')',+,'(',DFP_SRT,*,PD,')',+,'('X
               ,DFP_SRT,*,ZD,')',-,15,*,2,*,2
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    325         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_37_1
*ZC    325         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    325         ELSE
         J     PG_IF_37_E
PG_IF_37_1   DS    0H  &TYPE
*ZC    325         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_37_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-LNG *HFP-SRT)+(DFP-LNG *HFP-LNG)+(DFP-LNG *HFP-EXT)
*            +(DFP-LNG *BFP-SRT)+(DFP-LNG *BFP-LNG)+(DFP-LNG *BFP-EXT)
*            +(DFP-LNG *DFP-SRT)+(DFP-LNG *DFP-LNG)+(DFP-LNG *DFP-EXT)
*            +(DFP-LNG *HW     )+(DFP-LNG *FW     )+(DFP-LNG *DW     )
*            +(DFP-LNG *QW     )+(DFP-LNG *PD     )+(DFP-LNG *ZD     )
*            -15*2*2
*ZC    326         COMPUTE FLT_SRT,=,'(',DFP_LNG,*,HFP_SRT,')',+,'(',DFX
               P_LNG,*,HFP_LNG,')',+,'(',DFP_LNG,*,HFP_EXT,')',+,'(',DFX
               P_LNG,*,BFP_SRT,')',+,'(',DFP_LNG,*,BFP_LNG,')',+,'(',DFX
               P_LNG,*,BFP_EXT,')',+,'(',DFP_LNG,*,DFP_SRT,')',+,'(',DFX
               P_LNG,*,DFP_LNG,')',+,'(',DFP_LNG,*,DFP_EXT,')',+,'(',DFX
               P_LNG,*,HW,')',+,'(',DFP_LNG,*,FW,')',+,'(',DFP_LNG,*,DWX
               ,')',+,'(',DFP_LNG,*,QW,')',+,'(',DFP_LNG,*,PD,')',+,'('X
               ,DFP_LNG,*,ZD,')',-,15,*,2,*,2
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    333         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_38_1
*ZC    333         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    333         ELSE
         J     PG_IF_38_E
PG_IF_38_1   DS    0H  &TYPE
*ZC    333         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_38_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-EXT *HFP-SRT)+(DFP-EXT *HFP-LNG)+(DFP-EXT *HFP-EXT)
*            +(DFP-EXT *BFP-SRT)+(DFP-EXT *BFP-LNG)+(DFP-EXT *BFP-EXT)
*            +(DFP-EXT *DFP-SRT)+(DFP-EXT *DFP-LNG)+(DFP-EXT *DFP-EXT)
*            +(DFP-EXT *HW     )+(DFP-EXT *FW     )+(DFP-EXT *DW     )
*            +(DFP-EXT *QW     )+(DFP-EXT *PD     )+(DFP-EXT *ZD     )
*            -15*2*2
*ZC    334         COMPUTE FLT_SRT,=,'(',DFP_EXT,*,HFP_SRT,')',+,'(',DFX
               P_EXT,*,HFP_LNG,')',+,'(',DFP_EXT,*,HFP_EXT,')',+,'(',DFX
               P_EXT,*,BFP_SRT,')',+,'(',DFP_EXT,*,BFP_LNG,')',+,'(',DFX
               P_EXT,*,BFP_EXT,')',+,'(',DFP_EXT,*,DFP_SRT,')',+,'(',DFX
               P_EXT,*,DFP_LNG,')',+,'(',DFP_EXT,*,DFP_EXT,')',+,'(',DFX
               P_EXT,*,HW,')',+,'(',DFP_EXT,*,FW,')',+,'(',DFP_EXT,*,DWX
               ,')',+,'(',DFP_EXT,*,QW,')',+,'(',DFP_EXT,*,PD,')',+,'('X
               ,DFP_EXT,*,ZD,')',-,15,*,2,*,2
         MVC   ZCVT_WORKAREA+0(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         ZAP   ZCVT_PWORK1,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),16-16+DFP_EXT ALN RIGHT 9ZP
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    341         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_39_1
*ZC    341         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    341         ELSE
         J     PG_IF_39_E
PG_IF_39_1   DS    0H  &TYPE
*ZC    341         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_39_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (HW      *HFP-SRT)+(HW      *HFP-LNG)+(HW      *HFP-EXT)
*            +(HW      *BFP-SRT)+(HW      *BFP-LNG)+(HW      *BFP-EXT)
*            +(HW      *DFP-SRT)+(HW      *DFP-LNG)+(HW      *DFP-EXT)
*            +(HW      *HW     )+(HW      *FW     )+(HW      *DW     )
*            +(HW      *QW     )+(HW      *PD     )+(HW      *ZD     )
*            -15*2*2
*ZC    342         COMPUTE FLT_SRT,=,'(',HW,*,HFP_SRT,')',+,'(',HW,*,HFX
               P_LNG,')',+,'(',HW,*,HFP_EXT,')',+,'(',HW,*,BFP_SRT,')',X
               +,'(',HW,*,BFP_LNG,')',+,'(',HW,*,BFP_EXT,')',+,'(',HW,*X
               ,DFP_SRT,')',+,'(',HW,*,DFP_LNG,')',+,'(',HW,*,DFP_EXT,'X
               )',+,'(',HW,*,HW,')',+,'(',HW,*,FW,')',+,'(',HW,*,DW,')'X
               ,+,'(',HW,*,QW,')',+,'(',HW,*,PD,')',+,'(',HW,*,ZD,')',-X
               ,15,*,2,*,2
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   0,HW
         STG   0,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         MSG   ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   0,HW
         STG   0,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         MSG   ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    349         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_40_1
*ZC    349         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    349         ELSE
         J     PG_IF_40_E
PG_IF_40_1   DS    0H  &TYPE
*ZC    349         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_40_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (FW      *HFP-SRT)+(FW      *HFP-LNG)+(FW      *HFP-EXT)
*            +(FW      *BFP-SRT)+(FW      *BFP-LNG)+(FW      *BFP-EXT)
*            +(FW      *DFP-SRT)+(FW      *DFP-LNG)+(FW      *DFP-EXT)
*            +(FW      *HW     )+(FW      *FW     )+(FW      *DW     )
*            +(FW      *QW     )+(FW      *PD     )+(FW      *ZD     )
*            -15*2*2
*ZC    350         COMPUTE FLT_SRT,=,'(',FW,*,HFP_SRT,')',+,'(',FW,*,HFX
               P_LNG,')',+,'(',FW,*,HFP_EXT,')',+,'(',FW,*,BFP_SRT,')',X
               +,'(',FW,*,BFP_LNG,')',+,'(',FW,*,BFP_EXT,')',+,'(',FW,*X
               ,DFP_SRT,')',+,'(',FW,*,DFP_LNG,')',+,'(',FW,*,DFP_EXT,'X
               )',+,'(',FW,*,HW,')',+,'(',FW,*,FW,')',+,'(',FW,*,DW,')'X
               ,+,'(',FW,*,QW,')',+,'(',FW,*,PD,')',+,'(',FW,*,ZD,')',-X
               ,15,*,2,*,2
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   0,FW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   0,FW
         STG   0,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         MSG   ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    357         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_41_1
*ZC    357         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    357         ELSE
         J     PG_IF_41_E
PG_IF_41_1   DS    0H  &TYPE
*ZC    357         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_41_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DW      *HFP-SRT)+(DW      *HFP-LNG)+(DW      *HFP-EXT)
*            +(DW      *BFP-SRT)+(DW      *BFP-LNG)+(DW      *BFP-EXT)
*            +(DW      *DFP-SRT)+(DW      *DFP-LNG)+(DW      *DFP-EXT)
*            +(DW      *HW     )+(DW      *FW     )+(DW      *DW     )
*            +(DW      *QW     )+(DW      *PD     )+(DW      *ZD     )
*            -15*2*2
*ZC    358         COMPUTE FLT_SRT,=,'(',DW,*,HFP_SRT,')',+,'(',DW,*,HFX
               P_LNG,')',+,'(',DW,*,HFP_EXT,')',+,'(',DW,*,BFP_SRT,')',X
               +,'(',DW,*,BFP_LNG,')',+,'(',DW,*,BFP_EXT,')',+,'(',DW,*X
               ,DFP_SRT,')',+,'(',DW,*,DFP_LNG,')',+,'(',DW,*,DFP_EXT,'X
               )',+,'(',DW,*,HW,')',+,'(',DW,*,FW,')',+,'(',DW,*,DW,')'X
               ,+,'(',DW,*,QW,')',+,'(',DW,*,PD,')',+,'(',DW,*,ZD,')',-X
               ,15,*,2,*,2
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    0,DW
         CXGTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    365         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_42_1
*ZC    365         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    365         ELSE
         J     PG_IF_42_E
PG_IF_42_1   DS    0H  &TYPE
*ZC    365         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_42_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (QW      *HFP-SRT)+(QW      *HFP-LNG)+(QW      *HFP-EXT)
*            +(QW      *BFP-SRT)+(QW      *BFP-LNG)+(QW      *BFP-EXT)
*            +(QW      *DFP-SRT)+(QW      *DFP-LNG)+(QW      *DFP-EXT)
*            +(QW      *HW     )+(QW      *FW     )+(QW      *DW     )
*            +(QW      *QW     )+(QW      *PD     )+(QW      *ZD     )
*            -15*2*2
*ZC    366         COMPUTE FLT_SRT,=,'(',QW,*,HFP_SRT,')',+,'(',QW,*,HFX
               P_LNG,')',+,'(',QW,*,HFP_EXT,')',+,'(',QW,*,BFP_SRT,')',X
               +,'(',QW,*,BFP_LNG,')',+,'(',QW,*,BFP_EXT,')',+,'(',QW,*X
               ,DFP_SRT,')',+,'(',QW,*,DFP_LNG,')',+,'(',QW,*,DFP_EXT,'X
               )',+,'(',QW,*,HW,')',+,'(',QW,*,FW,')',+,'(',QW,*,DW,')'X
               ,+,'(',QW,*,QW,')',+,'(',QW,*,PD,')',+,'(',QW,*,ZD,')',-X
               ,15,*,2,*,2
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_WORKAREA+16(16),QW  ALIGN LEFT X OTHER
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    373         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_43_1
*ZC    373         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    373         ELSE
         J     PG_IF_43_E
PG_IF_43_1   DS    0H  &TYPE
*ZC    373         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_43_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (PD      *HFP-SRT)+(PD      *HFP-LNG)+(PD      *HFP-EXT)
*            +(PD      *BFP-SRT)+(PD      *BFP-LNG)+(PD      *BFP-EXT)
*            +(PD      *DFP-SRT)+(PD      *DFP-LNG)+(PD      *DFP-EXT)
*            +(PD      *HW     )+(PD      *FW     )+(PD      *DW     )
*            +(PD      *QW     )+(PD      *PD     )+(PD      *ZD     )
*            -15*2*2
*ZC    374         COMPUTE FLT_SRT,=,'(',PD,*,HFP_SRT,')',+,'(',PD,*,HFX
               P_LNG,')',+,'(',PD,*,HFP_EXT,')',+,'(',PD,*,BFP_SRT,')',X
               +,'(',PD,*,BFP_LNG,')',+,'(',PD,*,BFP_EXT,')',+,'(',PD,*X
               ,DFP_SRT,')',+,'(',PD,*,DFP_LNG,')',+,'(',PD,*,DFP_EXT,'X
               )',+,'(',PD,*,HW,')',+,'(',PD,*,FW,')',+,'(',PD,*,DW,')'X
               ,+,'(',PD,*,QW,')',+,'(',PD,*,PD,')',+,'(',PD,*,ZD,')',-X
               ,15,*,2,*,2
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    381         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_44_1
*ZC    381         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    381         ELSE
         J     PG_IF_44_E
PG_IF_44_1   DS    0H  &TYPE
*ZC    381         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_44_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (ZD      *HFP-SRT)+(ZD      *HFP-LNG)+(ZD      *HFP-EXT)
*            +(ZD      *BFP-SRT)+(ZD      *BFP-LNG)+(ZD      *BFP-EXT)
*            +(ZD      *DFP-SRT)+(ZD      *DFP-LNG)+(ZD      *DFP-EXT)
*            +(ZD      *HW     )+(ZD      *FW     )+(ZD      *DW     )
*            +(ZD      *QW     )+(ZD      *PD     )+(ZD      *ZD     )
*            -15*2*2
*ZC    382         COMPUTE FLT_SRT,=,'(',ZD,*,HFP_SRT,')',+,'(',ZD,*,HFX
               P_LNG,')',+,'(',ZD,*,HFP_EXT,')',+,'(',ZD,*,BFP_SRT,')',X
               +,'(',ZD,*,BFP_LNG,')',+,'(',ZD,*,BFP_EXT,')',+,'(',ZD,*X
               ,DFP_SRT,')',+,'(',ZD,*,DFP_LNG,')',+,'(',ZD,*,DFP_EXT,'X
               )',+,'(',ZD,*,HW,')',+,'(',ZD,*,FW,')',+,'(',ZD,*,DW,')'X
               ,+,'(',ZD,*,QW,')',+,'(',ZD,*,PD,')',+,'(',ZD,*,ZD,')',-X
               ,15,*,2,*,2
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+0
         STD   2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   0,ZCVT_WORKAREA+16
         STD   2,8+ZCVT_WORKAREA+16
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LD    ZC_F1,ZCVT_WORKAREA+16
         LD    ZC_F3,8+ZCVT_WORKAREA+16
         MXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LGH   ZC_R0,HW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         CVBG  0,ZCVT_PWORK1
         STG   0,ZCVT_WORKAREA+16
         LGF   ZC_R0,FW
         MSG   ZC_R0,ZCVT_WORKAREA+16
         STG   ZC_R0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LG    ZC_R0,DW
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         LMG   ZC_R0,ZC_R1,QW
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LMG   ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_MPYQ128
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
          MVGHI ZCVT_WORKAREA+16,15
         LG     ZC_R0,ZCVT_WORKAREA+16
         MSGFI  ZC_R0,2
         STG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R0,ZCVT_WORKAREA+16
         LGR   ZC_R1,ZC_R0
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LARL ZC_R14,=FL16'2'
         LMG  ZC_R2,ZC_R3,0(ZC_R14)
         L    ZC_R15,ZCVT_MPYQ128
         BASR ZC_R14,ZC_R15
         STMG ZC_R0,ZC_R1,ZCVT_WORKAREA+32
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LG    ZC_R0,ZCVT_WORKAREA+32
         LG    ZC_R1,8+ZCVT_WORKAREA+32
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LE    ZC_F1,FLT_SRT
         LDETR ZC_F1,ZC_F1,0
         SDTR  ZC_F1,ZC_F1,ZC_F0
         LEDTR ZC_F1,0,ZC_F1,0
         STE   ZC_F1,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    389         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_45_1
*ZC    389         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    389         ELSE
         J     PG_IF_45_E
PG_IF_45_1   DS    0H  &TYPE
*ZC    389         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_45_E   DS    0H  &TYPE
*            DISPLAY 'TESTCMP2 TEST COMPUTE DIVIDE'
*ZC    390         DISPLAY 'TESTCMP2 TEST COMPUTE DIVIDE'
         BRAS  1,*+(WTO#8479_EOT-*+1)/2*2
         DC    AL2(WTO#8479_EOT-*,0),C'TESTCMP2 TEST COMPUTE DIVIDE'
WTO#8479_EOT     EQU *
         SVC   35
*            COMPUTE FLT-SRT =
*             (HFP-SRT /HFP-SRT)+(HFP-SRT /HFP-LNG)+(HFP-SRT /HFP-EXT)
*            +(HFP-SRT /BFP-SRT)+(HFP-SRT /BFP-LNG)+(HFP-SRT /BFP-EXT)
*            +(HFP-SRT /DFP-SRT)+(HFP-SRT /DFP-LNG)+(HFP-SRT /DFP-EXT)
*            +(HFP-SRT /HW     )+(HFP-SRT /FW     )+(HFP-SRT /DW     )
*            +(HFP-SRT /QW     )+(HFP-SRT /PD     )+(HFP-SRT /ZD     )
*            -15
*ZC    391         COMPUTE FLT_SRT,=,'(',HFP_SRT,/,HFP_SRT,')',+,'(',HFX
               P_SRT,/,HFP_LNG,')',+,'(',HFP_SRT,/,HFP_EXT,')',+,'(',HFX
               P_SRT,/,BFP_SRT,')',+,'(',HFP_SRT,/,BFP_LNG,')',+,'(',HFX
               P_SRT,/,BFP_EXT,')',+,'(',HFP_SRT,/,DFP_SRT,')',+,'(',HFX
               P_SRT,/,DFP_LNG,')',+,'(',HFP_SRT,/,DFP_EXT,')',+,'(',HFX
               P_SRT,/,HW,')',+,'(',HFP_SRT,/,FW,')',+,'(',HFP_SRT,/,DWX
               ,')',+,'(',HFP_SRT,/,QW,')',+,'(',HFP_SRT,/,PD,')',+,'('X
               ,HFP_SRT,/,ZD,')',-,15
         LE    ZC_F0,HFP_SRT
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LH    ZC_R0,HW
         CEFR  ZC_F0,ZC_R0
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         L     ZC_R0,FW
         CEFR  ZC_F0,ZC_R0
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CEGR  ZC_F0,ZC_R0
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LMG   ZC_R0,ZC_R1,QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,HFP_SRT
         DER   0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    398         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_46_1
*ZC    398         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    398         ELSE
         J     PG_IF_46_E
PG_IF_46_1   DS    0H  &TYPE
*ZC    398         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_46_E   DS    0H  &TYPE
*            COMPUTE FLT-LNG =
*             (HFP-LNG /HFP-SRT)+(HFP-LNG /HFP-LNG)+(HFP-LNG /HFP-EXT)
*            +(HFP-LNG /BFP-SRT)+(HFP-LNG /BFP-LNG)+(HFP-LNG /BFP-EXT)
*            +(HFP-LNG /DFP-SRT)+(HFP-LNG /DFP-LNG)+(HFP-LNG /DFP-EXT)
*            +(HFP-LNG /HW     )+(HFP-LNG /FW     )+(HFP-LNG /DW     )
*            +(HFP-LNG /QW     )+(HFP-LNG /PD     )+(HFP-LNG /ZD     )
*            -15
*ZC    399         COMPUTE FLT_LNG,=,'(',HFP_LNG,/,HFP_SRT,')',+,'(',HFX
               P_LNG,/,HFP_LNG,')',+,'(',HFP_LNG,/,HFP_EXT,')',+,'(',HFX
               P_LNG,/,BFP_SRT,')',+,'(',HFP_LNG,/,BFP_LNG,')',+,'(',HFX
               P_LNG,/,BFP_EXT,')',+,'(',HFP_LNG,/,DFP_SRT,')',+,'(',HFX
               P_LNG,/,DFP_LNG,')',+,'(',HFP_LNG,/,DFP_EXT,')',+,'(',HFX
               P_LNG,/,HW,')',+,'(',HFP_LNG,/,FW,')',+,'(',HFP_LNG,/,DWX
               ,')',+,'(',HFP_LNG,/,QW,')',+,'(',HFP_LNG,/,PD,')',+,'('X
               ,HFP_LNG,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F0,HFP_LNG
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LH    ZC_R0,HW
         CDFR  ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         L     ZC_R0,FW
         CDFR  ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CDGR  ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,HFP_LNG
         DDR   0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         STD   0,FLT_LNG
         LD    ZC_F0,FLT_LNG
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,FLT_LNG
*            IF FLT-LNG = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    406         IF    FLT_LNG,=,0
         LD    0,FLT_LNG
         LARL  ZC_R1,=DD'0'
         LD    ZC_F1,0(ZC_R1)
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_47_1
*ZC    406         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    406         ELSE
         J     PG_IF_47_E
PG_IF_47_1   DS    0H  &TYPE
*ZC    406         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_47_E   DS    0H  &TYPE
*            COMPUTE FLT-EXT =
*             (HFP-EXT /HFP-SRT)+(HFP-EXT /HFP-LNG)+(HFP-EXT /HFP-EXT)
*            +(HFP-EXT /BFP-SRT)+(HFP-EXT /BFP-LNG)+(HFP-EXT /BFP-EXT)
*            +(HFP-EXT /DFP-SRT)+(HFP-EXT /DFP-LNG)+(HFP-EXT /DFP-EXT)
*            +(HFP-EXT /HW     )+(HFP-EXT /FW     )+(HFP-EXT /DW     )
*            +(HFP-EXT /QW     )+(HFP-EXT /PD     )+(HFP-EXT /ZD     )
*            -15
*ZC    407         COMPUTE FLT_EXT,=,'(',HFP_EXT,/,HFP_SRT,')',+,'(',HFX
               P_EXT,/,HFP_LNG,')',+,'(',HFP_EXT,/,HFP_EXT,')',+,'(',HFX
               P_EXT,/,BFP_SRT,')',+,'(',HFP_EXT,/,BFP_LNG,')',+,'(',HFX
               P_EXT,/,BFP_EXT,')',+,'(',HFP_EXT,/,DFP_SRT,')',+,'(',HFX
               P_EXT,/,DFP_LNG,')',+,'(',HFP_EXT,/,DFP_EXT,')',+,'(',HFX
               P_EXT,/,HW,')',+,'(',HFP_EXT,/,FW,')',+,'(',HFP_EXT,/,DWX
               ,')',+,'(',HFP_EXT,/,QW,')',+,'(',HFP_EXT,/,PD,')',+,'('X
               ,HFP_EXT,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LH    ZC_R0,HW
         CXFR  ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         L     ZC_R0,FW
         CXFR  ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CXGR  ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LMG   ZC_R0,ZC_R1,QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LH,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,HFP_EXT
         LD    ZC_F2,8+HFP_EXT
         DXR   ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   FLT_EXT,16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,FLT_EXT
         LD    ZC_F2,8+FLT_EXT
         LARL  ZC_R14,=LD'15'
         LD    ZC_F1,0(ZC_R14)
         LD    ZC_F3,8(ZC_R14)
         SXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,FLT_EXT
         STD   ZC_F2,8+FLT_EXT
*            IF FLT-EXT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    414         IF    FLT_EXT,=,0
         LD    0,FLT_EXT
         LD    2,8+FLT_EXT
         LARL  ZC_R1,=LD'0'
         LD    ZC_F1,0(ZC_R1)
         LD    ZC_F3,8(ZC_R1)
         CXTR  0,1
         BRC   15-ZC_EQ,PG_IF_48_1
*ZC    414         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    414         ELSE
         J     PG_IF_48_E
PG_IF_48_1   DS    0H  &TYPE
*ZC    414         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_48_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-SRT /HFP-SRT)+(BFP-SRT /HFP-LNG)+(BFP-SRT /HFP-EXT)
*            +(BFP-SRT /BFP-SRT)+(BFP-SRT /BFP-LNG)+(BFP-SRT /BFP-EXT)
*            +(BFP-SRT /DFP-SRT)+(BFP-SRT /DFP-LNG)+(BFP-SRT /DFP-EXT)
*            +(BFP-SRT /HW     )+(BFP-SRT /FW     )+(BFP-SRT /DW     )
*            +(BFP-SRT /QW     )+(BFP-SRT /PD     )+(BFP-SRT /ZD     )
*            -15
*ZC    415         COMPUTE FLT_SRT,=,'(',BFP_SRT,/,HFP_SRT,')',+,'(',BFX
               P_SRT,/,HFP_LNG,')',+,'(',BFP_SRT,/,HFP_EXT,')',+,'(',BFX
               P_SRT,/,BFP_SRT,')',+,'(',BFP_SRT,/,BFP_LNG,')',+,'(',BFX
               P_SRT,/,BFP_EXT,')',+,'(',BFP_SRT,/,DFP_SRT,')',+,'(',BFX
               P_SRT,/,DFP_LNG,')',+,'(',BFP_SRT,/,DFP_EXT,')',+,'(',BFX
               P_SRT,/,HW,')',+,'(',BFP_SRT,/,FW,')',+,'(',BFP_SRT,/,DWX
               ,')',+,'(',BFP_SRT,/,QW,')',+,'(',BFP_SRT,/,PD,')',+,'('X
               ,BFP_SRT,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F0,BFP_SRT
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LH    ZC_R0,HW
         CEFBR ZC_F0,ZC_R0
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         L     ZC_R0,FW
         CEFBR ZC_F0,ZC_R0
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CEGBR ZC_F0,ZC_R0
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LMG   ZC_R0,ZC_R1,QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_EB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LER   ZC_F1,ZC_F0
         LE    ZC_F0,BFP_SRT
         DEBR  0,1
         LER   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    422         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_49_1
*ZC    422         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    422         ELSE
         J     PG_IF_49_E
PG_IF_49_1   DS    0H  &TYPE
*ZC    422         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_49_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-LNG /HFP-SRT)+(BFP-LNG /HFP-LNG)+(BFP-LNG /HFP-EXT)
*            +(BFP-LNG /BFP-SRT)+(BFP-LNG /BFP-LNG)+(BFP-LNG /BFP-EXT)
*            +(BFP-LNG /DFP-SRT)+(BFP-LNG /DFP-LNG)+(BFP-LNG /DFP-EXT)
*            +(BFP-LNG /HW     )+(BFP-LNG /FW     )+(BFP-LNG /DW     )
*            +(BFP-LNG /QW     )+(BFP-LNG /PD     )+(BFP-LNG /ZD     )
*            -15
*ZC    423         COMPUTE FLT_SRT,=,'(',BFP_LNG,/,HFP_SRT,')',+,'(',BFX
               P_LNG,/,HFP_LNG,')',+,'(',BFP_LNG,/,HFP_EXT,')',+,'(',BFX
               P_LNG,/,BFP_SRT,')',+,'(',BFP_LNG,/,BFP_LNG,')',+,'(',BFX
               P_LNG,/,BFP_EXT,')',+,'(',BFP_LNG,/,DFP_SRT,')',+,'(',BFX
               P_LNG,/,DFP_LNG,')',+,'(',BFP_LNG,/,DFP_EXT,')',+,'(',BFX
               P_LNG,/,HW,')',+,'(',BFP_LNG,/,FW,')',+,'(',BFP_LNG,/,DWX
               ,')',+,'(',BFP_LNG,/,QW,')',+,'(',BFP_LNG,/,PD,')',+,'('X
               ,BFP_LNG,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F0,BFP_LNG
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LH    ZC_R0,HW
         CDFBR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         L     ZC_R0,FW
         CDFBR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CDGBR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LMG   ZC_R0,ZC_R1,QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,BFP_LNG
         DDBR  0,1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    430         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_50_1
*ZC    430         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    430         ELSE
         J     PG_IF_50_E
PG_IF_50_1   DS    0H  &TYPE
*ZC    430         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_50_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (BFP-EXT /HFP-SRT)+(BFP-EXT /HFP-LNG)+(BFP-EXT /HFP-EXT)
*            +(BFP-EXT /BFP-SRT)+(BFP-EXT /BFP-LNG)+(BFP-EXT /BFP-EXT)
*            +(BFP-EXT /DFP-SRT)+(BFP-EXT /DFP-LNG)+(BFP-EXT /DFP-EXT)
*            +(BFP-EXT /HW     )+(BFP-EXT /FW     )+(BFP-EXT /DW     )
*            +(BFP-EXT /QW     )+(BFP-EXT /PD     )+(BFP-EXT /ZD     )
*            -15
*ZC    431         COMPUTE FLT_SRT,=,'(',BFP_EXT,/,HFP_SRT,')',+,'(',BFX
               P_EXT,/,HFP_LNG,')',+,'(',BFP_EXT,/,HFP_EXT,')',+,'(',BFX
               P_EXT,/,BFP_SRT,')',+,'(',BFP_EXT,/,BFP_LNG,')',+,'(',BFX
               P_EXT,/,BFP_EXT,')',+,'(',BFP_EXT,/,DFP_SRT,')',+,'(',BFX
               P_EXT,/,DFP_LNG,')',+,'(',BFP_EXT,/,DFP_EXT,')',+,'(',BFX
               P_EXT,/,HW,')',+,'(',BFP_EXT,/,FW,')',+,'(',BFP_EXT,/,DWX
               ,')',+,'(',BFP_EXT,/,QW,')',+,'(',BFP_EXT,/,PD,')',+,'('X
               ,BFP_EXT,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LH    ZC_R0,HW
         CXFBR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         L     ZC_R0,FW
         CXFBR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CXGBR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LMG   ZC_R0,ZC_R1,QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,BFP_EXT
         LD    ZC_F2,8+BFP_EXT
         DXBR  ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LDR   ZC_F6,ZC_F2
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    438         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_51_1
*ZC    438         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    438         ELSE
         J     PG_IF_51_E
PG_IF_51_1   DS    0H  &TYPE
*ZC    438         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_51_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-SRT /HFP-SRT)+(DFP-SRT /HFP-LNG)+(DFP-SRT /HFP-EXT)
*            +(DFP-SRT /BFP-SRT)+(DFP-SRT /BFP-LNG)+(DFP-SRT /BFP-EXT)
*            +(DFP-SRT /DFP-SRT)+(DFP-SRT /DFP-LNG)+(DFP-SRT /DFP-EXT)
*            +(DFP-SRT /HW     )+(DFP-SRT /FW     )+(DFP-SRT /DW     )
*            +(DFP-SRT /QW     )+(DFP-SRT /PD     )+(DFP-SRT /ZD     )
*            -15
*ZC    439         COMPUTE FLT_SRT,=,'(',DFP_SRT,/,HFP_SRT,')',+,'(',DFX
               P_SRT,/,HFP_LNG,')',+,'(',DFP_SRT,/,HFP_EXT,')',+,'(',DFX
               P_SRT,/,BFP_SRT,')',+,'(',DFP_SRT,/,BFP_LNG,')',+,'(',DFX
               P_SRT,/,BFP_EXT,')',+,'(',DFP_SRT,/,DFP_SRT,')',+,'(',DFX
               P_SRT,/,DFP_LNG,')',+,'(',DFP_SRT,/,DFP_EXT,')',+,'(',DFX
               P_SRT,/,HW,')',+,'(',DFP_SRT,/,FW,')',+,'(',DFP_SRT,/,DWX
               ,')',+,'(',DFP_SRT,/,QW,')',+,'(',DFP_SRT,/,PD,')',+,'('X
               ,DFP_SRT,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F0,DFP_LNG
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         CDGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         CDGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CDGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LMG   ZC_R0,ZC_R1,QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LE    ZC_F0,DFP_SRT
         LDETR ZC_F0,ZC_F0,0
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    446         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_52_1
*ZC    446         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    446         ELSE
         J     PG_IF_52_E
PG_IF_52_1   DS    0H  &TYPE
*ZC    446         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_52_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-LNG /HFP-SRT)+(DFP-LNG /HFP-LNG)+(DFP-LNG /HFP-EXT)
*            +(DFP-LNG /BFP-SRT)+(DFP-LNG /BFP-LNG)+(DFP-LNG /BFP-EXT)
*            +(DFP-LNG /DFP-SRT)+(DFP-LNG /DFP-LNG)+(DFP-LNG /DFP-EXT)
*            +(DFP-LNG /HW     )+(DFP-LNG /FW     )+(DFP-LNG /DW     )
*            +(DFP-LNG /QW     )+(DFP-LNG /PD     )+(DFP-LNG /ZD     )
*            -15
*ZC    447         COMPUTE FLT_SRT,=,'(',DFP_LNG,/,HFP_SRT,')',+,'(',DFX
               P_LNG,/,HFP_LNG,')',+,'(',DFP_LNG,/,HFP_EXT,')',+,'(',DFX
               P_LNG,/,BFP_SRT,')',+,'(',DFP_LNG,/,BFP_LNG,')',+,'(',DFX
               P_LNG,/,BFP_EXT,')',+,'(',DFP_LNG,/,DFP_SRT,')',+,'(',DFX
               P_LNG,/,DFP_LNG,')',+,'(',DFP_LNG,/,DFP_EXT,')',+,'(',DFX
               P_LNG,/,HW,')',+,'(',DFP_LNG,/,FW,')',+,'(',DFP_LNG,/,DWX
               ,')',+,'(',DFP_LNG,/,QW,')',+,'(',DFP_LNG,/,PD,')',+,'('X
               ,DFP_LNG,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F0,DFP_LNG
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         CDGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         CDGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CDGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LMG   ZC_R0,ZC_R1,QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LD    ZC_F0,DFP_LNG
         DDTR  ZC_F0,ZC_F0,ZC_F1
         LDR   ZC_F4,ZC_F0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    454         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_53_1
*ZC    454         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    454         ELSE
         J     PG_IF_53_E
PG_IF_53_1   DS    0H  &TYPE
*ZC    454         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_53_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DFP-EXT /HFP-SRT)+(DFP-EXT /HFP-LNG)+(DFP-EXT /HFP-EXT)
*            +(DFP-EXT /BFP-SRT)+(DFP-EXT /BFP-LNG)+(DFP-EXT /BFP-EXT)
*            +(DFP-EXT /DFP-SRT)+(DFP-EXT /DFP-LNG)+(DFP-EXT /DFP-EXT)
*            +(DFP-EXT /HW     )+(DFP-EXT /FW     )+(DFP-EXT /DW     )
*            +(DFP-EXT /QW     )+(DFP-EXT /PD     )+(DFP-EXT /ZD     )
*            -15
*ZC    455         COMPUTE FLT_SRT,=,'(',DFP_EXT,/,HFP_SRT,')',+,'(',DFX
               P_EXT,/,HFP_LNG,')',+,'(',DFP_EXT,/,HFP_EXT,')',+,'(',DFX
               P_EXT,/,BFP_SRT,')',+,'(',DFP_EXT,/,BFP_LNG,')',+,'(',DFX
               P_EXT,/,BFP_EXT,')',+,'(',DFP_EXT,/,DFP_SRT,')',+,'(',DFX
               P_EXT,/,DFP_LNG,')',+,'(',DFP_EXT,/,DFP_EXT,')',+,'(',DFX
               P_EXT,/,HW,')',+,'(',DFP_EXT,/,FW,')',+,'(',DFP_EXT,/,DWX
               ,')',+,'(',DFP_EXT,/,QW,')',+,'(',DFP_EXT,/,PD,')',+,'('X
               ,DFP_EXT,/,ZD,')',-,15
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LGH   ZC_R0,HW
         CXGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LGF   ZC_R0,FW
         CXGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LG    ZC_R0,DW
         CXGTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         LDR   ZC_F1,ZC_F0
         LDR   ZC_F3,ZC_F2
         LD    ZC_F0,DFP_EXT
         LD    ZC_F2,8+DFP_EXT
         DXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    462         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_54_1
*ZC    462         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    462         ELSE
         J     PG_IF_54_E
PG_IF_54_1   DS    0H  &TYPE
*ZC    462         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_54_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (HW      /HFP-SRT)+(HW      /HFP-LNG)+(HW      /HFP-EXT)
*            +(HW      /BFP-SRT)+(HW      /BFP-LNG)+(HW      /BFP-EXT)
*            +(HW      /DFP-SRT)+(HW      /DFP-LNG)+(HW      /DFP-EXT)
*            +(HW      /HW     )+(HW      /FW     )+(HW      /DW     )
*            +(HW      /QW     )+(HW      /PD     )+(HW      /ZD     )
*            -15
*ZC    463         COMPUTE FLT_SRT,=,'(',HW,/,HFP_SRT,')',+,'(',HW,/,HFX
               P_LNG,')',+,'(',HW,/,HFP_EXT,')',+,'(',HW,/,BFP_SRT,')',X
               +,'(',HW,/,BFP_LNG,')',+,'(',HW,/,BFP_EXT,')',+,'(',HW,/X
               ,DFP_SRT,')',+,'(',HW,/,DFP_LNG,')',+,'(',HW,/,DFP_EXT,'X
               )',+,'(',HW,/,HW,')',+,'(',HW,/,FW,')',+,'(',HW,/,DW,')'X
               ,+,'(',HW,/,QW,')',+,'(',HW,/,PD,')',+,'(',HW,/,ZD,')',-X
               ,15
         MVC   ZCVT_NDDX(2),HW
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(2),HW
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(2),HW
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(2),HW
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(2),HW
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(2),HW
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(2),HW
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(2),HW
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(2),HW
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(2),HW
         LGH   ZC_R2,HW
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         STG   1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(2),HW
         LGF   ZC_R2,FW
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         STG   1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(2),HW
         LG    ZC_R2,DW
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(2),HW
         LG    ZC_R2,8+QW  IGNORE HIGH 64 BITS
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(2),HW
         ZAP   ZCVT_PWORK1,PD
         CVBG  ZC_R2,ZCVT_PWORK1
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(2),HW
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         CVBG  ZC_R2,ZCVT_PWORK1
         LGH   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    470         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_55_1
*ZC    470         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    470         ELSE
         J     PG_IF_55_E
PG_IF_55_1   DS    0H  &TYPE
*ZC    470         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_55_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (FW      /HFP-SRT)+(FW      /HFP-LNG)+(FW      /HFP-EXT)
*            +(FW      /BFP-SRT)+(FW      /BFP-LNG)+(FW      /BFP-EXT)
*            +(FW      /DFP-SRT)+(FW      /DFP-LNG)+(FW      /DFP-EXT)
*            +(FW      /HW     )+(FW      /FW     )+(FW      /DW     )
*            +(FW      /QW     )+(FW      /PD     )+(FW      /ZD     )
*            -15
*ZC    471         COMPUTE FLT_SRT,=,'(',FW,/,HFP_SRT,')',+,'(',FW,/,HFX
               P_LNG,')',+,'(',FW,/,HFP_EXT,')',+,'(',FW,/,BFP_SRT,')',X
               +,'(',FW,/,BFP_LNG,')',+,'(',FW,/,BFP_EXT,')',+,'(',FW,/X
               ,DFP_SRT,')',+,'(',FW,/,DFP_LNG,')',+,'(',FW,/,DFP_EXT,'X
               )',+,'(',FW,/,HW,')',+,'(',FW,/,FW,')',+,'(',FW,/,DW,')'X
               ,+,'(',FW,/,QW,')',+,'(',FW,/,PD,')',+,'(',FW,/,ZD,')',-X
               ,15
         MVC   ZCVT_NDDX(4),FW
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(4),FW
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(4),FW
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(4),FW
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(4),FW
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(4),FW
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(4),FW
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(4),FW
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(4),FW
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R1 IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  ZC_R1,ZC_R1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(4),FW
         LGH   ZC_R2,HW
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         STG   1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(4),FW
         LGF   ZC_R2,FW
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(4),FW
         LG    ZC_R2,DW    HIGH 32 BITS IGNORED
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(4),FW
         LG    ZC_R2,8+QW  IGNORE HIGH 96 BITS
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(4),FW
         ZAP   ZCVT_PWORK1,PD
         CVBG  ZC_R2,ZCVT_PWORK1
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(4),FW
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         CVBG  ZC_R2,ZCVT_PWORK1
         LGF   ZC_R1,ZCVT_NDDX
         DSGR    0,2
         LGFR  1,1
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    478         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_56_1
*ZC    478         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    478         ELSE
         J     PG_IF_56_E
PG_IF_56_1   DS    0H  &TYPE
*ZC    478         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_56_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (DW      /HFP-SRT)+(DW      /HFP-LNG)+(DW      /HFP-EXT)
*            +(DW      /BFP-SRT)+(DW      /BFP-LNG)+(DW      /BFP-EXT)
*            +(DW      /DFP-SRT)+(DW      /DFP-LNG)+(DW      /DFP-EXT)
*            +(DW      /HW     )+(DW      /FW     )+(DW      /DW     )
*            +(DW      /QW     )+(DW      /PD     )+(DW      /ZD     )
*            -15
*ZC    479         COMPUTE FLT_SRT,=,'(',DW,/,HFP_SRT,')',+,'(',DW,/,HFX
               P_LNG,')',+,'(',DW,/,HFP_EXT,')',+,'(',DW,/,BFP_SRT,')',X
               +,'(',DW,/,BFP_LNG,')',+,'(',DW,/,BFP_EXT,')',+,'(',DW,/X
               ,DFP_SRT,')',+,'(',DW,/,DFP_LNG,')',+,'(',DW,/,DFP_EXT,'X
               )',+,'(',DW,/,HW,')',+,'(',DW,/,FW,')',+,'(',DW,/,DW,')'X
               ,+,'(',DW,/,QW,')',+,'(',DW,/,PD,')',+,'(',DW,/,ZD,')',-X
               ,15
         MVC   ZCVT_NDDX(8),DW
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(8),DW
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(8),DW
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(8),DW
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(8),DW
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(8),DW
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(8),DW
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(8),DW
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(8),DW
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
                 LGR ZC_R2,ZC_R1 IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(8),DW
         LGH   2,HW
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(8),DW
         LGF   2,FW
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(8),DW
         LG    2,DW
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(8),DW
         LG    2,8+QW  IGNORE HIGH 64 BITS
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX(8),DW
         ZAP   ZCVT_PWORK1,PD
         CVBG  2,ZCVT_PWORK1
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX(8),DW
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         CVBG  2,ZCVT_PWORK1
         LG    1,ZCVT_NDDX
         DSGR    0,2
         LGR   ZC_R0,ZC_R1
         SRAG  ZC_R0,ZC_R0,63
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    486         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_57_1
*ZC    486         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    486         ELSE
         J     PG_IF_57_E
PG_IF_57_1   DS    0H  &TYPE
*ZC    486         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_57_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (QW      /HFP-SRT)+(QW      /HFP-LNG)+(QW      /HFP-EXT)
*            +(QW      /BFP-SRT)+(QW      /BFP-LNG)+(QW      /BFP-EXT)
*            +(QW      /DFP-SRT)+(QW      /DFP-LNG)+(QW      /DFP-EXT)
*            +(QW      /HW     )+(QW      /FW     )+(QW      /DW     )
*            +(QW      /QW     )+(QW      /PD     )+(QW      /ZD     )
*            -15
*ZC    487         COMPUTE FLT_SRT,=,'(',QW,/,HFP_SRT,')',+,'(',QW,/,HFX
               P_LNG,')',+,'(',QW,/,HFP_EXT,')',+,'(',QW,/,BFP_SRT,')',X
               +,'(',QW,/,BFP_LNG,')',+,'(',QW,/,BFP_EXT,')',+,'(',QW,/X
               ,DFP_SRT,')',+,'(',QW,/,DFP_LNG,')',+,'(',QW,/,DFP_EXT,'X
               )',+,'(',QW,/,HW,')',+,'(',QW,/,FW,')',+,'(',QW,/,DW,')'X
               ,+,'(',QW,/,QW,')',+,'(',QW,/,PD,')',+,'(',QW,/,ZD,')',-X
               ,15
         MVC   ZCVT_NDDX,QW
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_1
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_1            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX,QW
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_2
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_2            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX,QW
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_3
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_3            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX,QW
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_4
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_4            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX,QW
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_5
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_5            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX,QW
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_6
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_6            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX,QW
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_7
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_7            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX,QW
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_8
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_8            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX,QW
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_9
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_9            DS 0H
         LGR   ZC_R0,ZC_R2
         LGR   ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX,QW
         LGH   ZC_R3,HW
         SGR   ZC_R2,ZC_R2
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_10
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_10           DS 0H
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX,QW
         LGF   ZC_R3,FW
         SGR   ZC_R2,ZC_R2
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_11
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_11           DS 0H
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX,QW
         LG    ZC_R3,DW
         SGR   ZC_R2,ZC_R2
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_12
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_12           DS 0H
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX,QW
         LMG   ZC_R2,ZC_R3,QW
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_13
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_13           DS 0H
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         MVC   ZCVT_NDDX,QW
         ZAP   ZCVT_PWORK2,PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_14
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_14           DS 0H
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         MVC   ZCVT_NDDX,QW
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         LGR   ZC_R2,ZC_R0
         LGR   ZC_R3,ZC_R1
         LMG   ZC_R0,ZC_R1,ZCVT_NDDX
         L     ZC_R15,ZCVT_DIVQ128 DIVIDE SCALED DIVIDEND BY QUOTIENT
         BASR  ZC_R14,ZC_R15
         LTGR  ZC_R0,ZC_R0
         JNM   ZC_LPQR_15
         XG    ZC_R0,ZCVT_HIGH_VALUES
         XG    ZC_R0+1,ZCVT_HIGH_VALUES
         ALGFI ZC_R0+1,1
         ALCG  ZC_R0,ZCVT_ZERO
ZC_LPQR_15           DS 0H
         STMG  ZC_R2,ZC_R3,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    494         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_58_1
*ZC    494         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    494         ELSE
         J     PG_IF_58_E
PG_IF_58_1   DS    0H  &TYPE
*ZC    494         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_58_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (PD      /HFP-SRT)+(PD      /HFP-LNG)+(PD      /HFP-EXT)
*            +(PD      /BFP-SRT)+(PD      /BFP-LNG)+(PD      /BFP-EXT)
*            +(PD      /DFP-SRT)+(PD      /DFP-LNG)+(PD      /DFP-EXT)
*            +(PD      /HW     )+(PD      /FW     )+(PD      /DW     )
*            +(PD      /QW     )+(PD      /PD     )+(PD      /ZD     )
*            -15
*ZC    495         COMPUTE FLT_SRT,=,'(',PD,/,HFP_SRT,')',+,'(',PD,/,HFX
               P_LNG,')',+,'(',PD,/,HFP_EXT,')',+,'(',PD,/,BFP_SRT,')',X
               +,'(',PD,/,BFP_LNG,')',+,'(',PD,/,BFP_EXT,')',+,'(',PD,/X
               ,DFP_SRT,')',+,'(',PD,/,DFP_LNG,')',+,'(',PD,/,DFP_EXT,'X
               )',+,'(',PD,/,HW,')',+,'(',PD,/,FW,')',+,'(',PD,/,DW,')'X
               ,+,'(',PD,/,QW,')',+,'(',PD,/,PD,')',+,'(',PD,/,ZD,')',-X
               ,15
         ZAP ZCVT_PWORK1(16),PD
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP ZCVT_PWORK1(16),PD
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP ZCVT_PWORK1(16),PD
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP ZCVT_PWORK1(16),PD
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP ZCVT_PWORK1(16),PD
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP ZCVT_PWORK1(16),PD
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP ZCVT_PWORK1(16),PD
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP ZCVT_PWORK1(16),PD
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP ZCVT_PWORK1(16),PD
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP ZCVT_PWORK1(16),PD
         LH    0,HW
         CVD   0,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         ZAP   ZCVT_PWORK4,ZCVT_PWORK2(8)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK4
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP ZCVT_PWORK1(16),PD
         L     0,FW
         CVD   0,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         ZAP   ZCVT_PWORK4,ZCVT_PWORK2(8)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK4
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP ZCVT_PWORK1(16),PD
         LG    0,DW
         CVDG  0,ZCVT_PWORK2    IGNORE HIGH 32
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP ZCVT_PWORK1(16),PD
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         ZAP ZCVT_PWORK1(16),PD
         ZAP   ZCVT_PWORK2(16),PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         ZAP ZCVT_PWORK1(16),PD
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    502         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_59_1
*ZC    502         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    502         ELSE
         J     PG_IF_59_E
PG_IF_59_1   DS    0H  &TYPE
*ZC    502         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_59_E   DS    0H  &TYPE
*            COMPUTE FLT-SRT =
*             (ZD      /HFP-SRT)+(ZD      /HFP-LNG)+(ZD      /HFP-EXT)
*            +(ZD      /BFP-SRT)+(ZD      /BFP-LNG)+(ZD      /BFP-EXT)
*            +(ZD      /DFP-SRT)+(ZD      /DFP-LNG)+(ZD      /DFP-EXT)
*            +(ZD      /HW     )+(ZD      /FW     )+(ZD      /DW     )
*            +(ZD      /QW     )+(ZD      /PD     )+(ZD      /ZD     )
*            -15
*ZC    503         COMPUTE FLT_SRT,=,'(',ZD,/,HFP_SRT,')',+,'(',ZD,/,HFX
               P_LNG,')',+,'(',ZD,/,HFP_EXT,')',+,'(',ZD,/,BFP_SRT,')',X
               +,'(',ZD,/,BFP_LNG,')',+,'(',ZD,/,BFP_EXT,')',+,'(',ZD,/X
               ,DFP_SRT,')',+,'(',ZD,/,DFP_LNG,')',+,'(',ZD,/,DFP_EXT,'X
               )',+,'(',ZD,/,HW,')',+,'(',ZD,/,FW,')',+,'(',ZD,/,DW,')'X
               ,+,'(',ZD,/,QW,')',+,'(',ZD,/,PD,')',+,'(',ZD,/,ZD,')',-X
               ,15
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LE    ZC_F4,HFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LD    ZC_F4,HFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LD    ZC_F4,HFP_EXT
         LD    ZC_F6,8+HFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LH,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LE    ZC_F4,BFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_EB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LD    ZC_F4,BFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LD    ZC_F4,BFP_EXT
         LD    ZC_F6,8+BFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LE    ZC_F4,DFP_SRT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_ED,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LD    ZC_F4,DFP_LNG
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_DD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LD    ZC_F4,DFP_EXT
         LD    ZC_F6,8+DFP_EXT
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG    ZC_R0,ZC_R2,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK2,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F0,ZC_R0
         STD   ZC_F0,ZCVT_WORKAREA+16
         STD   ZC_F2,8+ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LD    ZC_F0,ZCVT_WORKAREA+16
         LD    ZC_F2,8+ZCVT_WORKAREA+16
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LH    0,HW
         CVD   0,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         ZAP   ZCVT_PWORK4,ZCVT_PWORK2(8)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK4
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         L     0,FW
         CVD   0,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         ZAP   ZCVT_PWORK4,ZCVT_PWORK2(8)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK4
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         CVBG  0,ZCVT_PWORK1
         STG   0,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         CXGTR ZC_F0,ZC_R0
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LG    0,DW
         CVDG  0,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         LG    ZC_R0,QW
         LG    ZC_R1,8+QW
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLDTP IN F0-F2 TO PL31 IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK2
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         ZAP    ZCVT_PWORK2(9),PD
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         ZAP   ZCVT_PWORK4,ZCVT_PWORK2(9)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK4
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+32(16),16-16+ZCVT_WORKAREA+0 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+32
         LD    ZC_F3,8+ZCVT_WORKAREA+32
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+32
         STD   ZC_F2,8+ZCVT_WORKAREA+32
         PACK  ZCVT_PWORK1(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK1(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK1(2),28+ZD(3)  PACK #3 FINAL
         PACK  ZCVT_PWORK2(8),0+ZD(15) PACK #1 FULL
         PACK  7+ZCVT_PWORK2(8),14+ZD(15) PACK #2 FULL
         PACK  14+ZCVT_PWORK2(2),28+ZD(3)  PACK #3 FINAL
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F0,ZC_R0
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK2
         CXSTR ZC_F1,ZC_R0
         DXTR  ZC_F0,ZC_F0,ZC_F1
         L     ZC_R15,ZCVT_CVTLDTP
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_PWORK4                   PW4=QUOTIENT
         ZAP   ZCVT_PWORK1,ZCVT_PWORK4(16)
         LMG   ZC_R0,ZC_R1,ZCVT_PWORK1
         CXSTR ZC_F4,ZC_R0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LB,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         L     ZC_R15,ZCVT_CVTLBTQ CVT LB IN F0-F2 TO Q IN ZC_R0-ZC_R1
         BASR  ZC_R14,ZC_R15
         STMG  ZC_R0,ZC_R1,ZCVT_WORKAREA+16
         MVC   ZCVT_WORKAREA+0(16),16-16+ZCVT_WORKAREA+32 ALN RIGHT 9ZP
         LG    ZC_R0,ZCVT_WORKAREA+16
         LG    ZC_R1,8+ZCVT_WORKAREA+16
         L     ZC_R15,ZCVT_CVTQTLB   CVT Q IN ZC_R0-ZC_R1              X
                                     TO LB IN ZC_F4-ZC_F6
         BASR  ZC_R14,ZC_R15
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_LD,PFPO_TYPE_LB,PFPO_RNDX
               )
         PFPO 
         LD    ZC_F1,ZCVT_WORKAREA+0
         LD    ZC_F3,8+ZCVT_WORKAREA+0
         AXTR  ZC_F0,ZC_F0,ZC_F1
         STD   ZC_F0,ZCVT_WORKAREA+0
         STD   ZC_F2,8+ZCVT_WORKAREA+0
         LD    ZC_F4,ZCVT_WORKAREA+0
         LD    ZC_F6,8+ZCVT_WORKAREA+0
         LRL   ZC_R0,=AL1(PFPO_RADIX,PFPO_TYPE_DD,PFPO_TYPE_LD,PFPO_RNDX
               )
         PFPO 
         LEDTR ZC_F0,0,ZC_F0,0
         STE   0,FLT_SRT
         LE    ZC_F0,FLT_SRT
         LDETR ZC_F0,ZC_F0,0
         LARL  ZC_R14,=DD'15'
         LD    ZC_F1,0(ZC_R14)
         SDTR  ZC_F0,ZC_F0,ZC_F1
         LEDTR ZC_F0,0,ZC_F0,0
         STE   ZC_F0,FLT_SRT
*            IF FLT-SRT = 0 PERFORM GOOD ELSE PERFORM BAD.
*ZC    510         IF    FLT_SRT,=,0
         LE    0,FLT_SRT
         LARL  ZC_R1,=ED'0'
         LE    ZC_F1,0(ZC_R1)
         LDETR 0,0,0
         LDETR 1,1,0
         CDTR  0,1
         BRC   15-ZC_EQ,PG_IF_60_1
*ZC    510         PERFORM GOOD
         LARL  ZC_R14,PG_GOOD
         LARL  ZC_R0,PG_GOOD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
*ZC    510         ELSE
         J     PG_IF_60_E
PG_IF_60_1   DS    0H  &TYPE
*ZC    510         PERFORM BAD
         LARL  ZC_R14,PG_BAD
         LARL  ZC_R0,PG_BAD_END+6
         L     ZC_R15,ZCVT_PERFORM
         BASR  ZC_R1,ZC_R15
PG_IF_60_E   DS    0H  &TYPE
*            DISPLAY 'TESTCMP2 GOOD TESTS =' GOOD
*ZC    511         DISPLAY 'TESTCMP2 GOOD TESTS =',GOOD
         LA    ZC_R3,ZCVT_WORKAREA  ZC_R3=CVT LIST WORK AREA
         LARL  ZC_R0,=CL22'TESTCMP2 GOOD TESTS =' PAD TO EVEN LEN LIT
         LA    ZC_R1,21
         LA    ZC_R2,C'X'
         STM   ZC_R0,ZC_R2,0(ZC_R3)  SET DISPLAY LIST ENTRY
         LA    ZC_R0,GOOD
         LA    ZC_R1,3  RPI 1182 WAS &SYM_LEN(&FIELD_IX)
         LA    ZC_R2,C'P'
         STM   ZC_R0,ZC_R2,12(ZC_R3)  SET DISPLAY LIST ENTRY
         OI    24-4(ZC_R3),X'80' SET VL BIT IN LAST WORD OF PARM LIST
         LR    ZC_R1,ZC_R3
         L     ZC_R15,ZCVT_DISPLAY
         BASR  ZC_R14,ZC_R15
*            STOP RUN.
*ZC    512         STOP  RUN
         LH    ZC_R1,RETURN_CODE      PASS RETURN CODE IN R1
         L     ZC_R15,ZCVT_GOBACK
         BR    ZC_R15
*        GOOD.
PG_MAINLINE_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_GOOD  DS    0H
*            ADD 1 TO GOOD.
*ZC    514         ADD   1,TO,GOOD
         BRAS  ZC_R14,3 SET ZC_R1 TO A(INLINE LIT) AND SKIP OVER IT
         DC    PL2'1'
         AP    GOOD,0(2,ZC_R14)
*        BAD.
PG_GOOD_END L  ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_BAD   DS    0H
*            MOVE 16 TO RETURN-CODE
*ZC    516         MOVE  16,TO,RETURN_CODE
          MVHHI RETURN_CODE,16
*            STOP RUN.
*ZC    517         STOP  RUN
         LH    ZC_R1,RETURN_CODE      PASS RETURN CODE IN R1
         L     ZC_R15,ZCVT_GOBACK
         BR    ZC_R15
PG_BAD_END L   ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
SN_END_PROCEDURE DS 0H SECTION
*        PROCEDURE END
         LH    ZC_R1,RETURN_CODE
         L     ZC_R15,ZCVT_GOBACK
         BASR  ZC_R14,ZC_R15
         LTORG 
*    ZCOBOL WORKING STORAGE SECTION DATA ITEMS 
*    LVL DATA NAME                      ADDR     LEN      DUP TYP PIC  X
                     VALUE 
*    01  ZC_SAVEAREA                    00000000 00000048 1   X   X(72)X
                      
*    01  ZC_WS_ID                       00000048 00000008 1   X   X(8) X
                     ''WS*WS*WS'' 
*    01  ZC_WS_START                    00000050 00000004 1   A        X
                      
*    01  ZC_WS_LEN                      00000054 00000004 1   F   9(9) X
                      
*    01  FILLER                         00000058 00000000 1   X        X
                      
*    01  HFP_SRT                        00000058 00000004 1   1        X
                     1234 
*    01  HFP_LNG                        0000005C 00000008 1   2        X
                     1234 
*    01  HFP_EXT                        00000064 00000010 1   3        X
                     1234 
*    01  BFP_SRT                        00000074 00000004 1   4        X
                     1234 
*    01  BFP_LNG                        00000078 00000008 1   5        X
                     1234 
*    01  BFP_EXT                        00000080 00000010 1   6        X
                     1234 
*    01  DFP_SRT                        00000090 00000004 1   7        X
                     1234 
*    01  DFP_LNG                        00000094 00000008 1   8        X
                     1234 
*    01  DFP_EXT                        0000009C 00000010 1   9        X
                     1234 
*    01  HW                             000000AC 00000002 1   H   9(4) X
                     1234 
*    01  FW                             000000AE 00000004 1   F   9(9) X
                     1234 
*    01  DW                             000000B2 00000008 1   G   9(18)X
                     1234 
*    01  QW                             000000BA 00000010 1   Q   9(39)X
                     1234 
*    01  PD                             000000CA 00000010 1   P   9(31)X
                     1234 
*    01  ZD                             000000DA 0000001F 1   Z   9(31)X
                     1234 
*    01  FLT_SRT                        000000F9 00000004 1   7        X
                      
*    01  FLT_LNG                        000000FD 00000008 1   8        X
                      
*    01  FLT_EXT                        00000105 00000010 1   9        X
                      
*    01  HW2                            00000115 00000002 1   H   9(4) X
                      
*    01  FW2                            00000117 00000004 1   F   9(9) X
                      
*    01  DW2                            0000011B 00000008 1   G   9(18)X
                      
*    01  QW2                            00000123 00000010 1   Q   9(39)X
                      
*    01  PD2                            00000133 00000010 1   P   9(31)X
                      
*    01  ZD2                            00000143 0000001F 1   Z   9(31)X
                      
*    01  GOOD                           00000162 00000003 1   P   9(4) X
                     0 
*    01  DEBUG_ITEM                     00000165 00000058 1   X        X
                      
*    02  DEBUG_LINE                     00000165 00000006 1   X   X(6) X
                      
*    02  FILLER                         0000016B 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_NAME                     0000016C 0000001E 1   X   X(30)X
                      
*    02  FILLER                         0000018A 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_SUB_1                    0000018B 00000004 1   Z   9999 X
                      
*    02  FILLER                         0000018F 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_SUB_2                    00000190 00000004 1   Z   9999 X
                      
*    02  FILLER                         00000194 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_SUB_3                    00000195 00000004 1   Z   9999 X
                      
*    02  FILLER                         00000199 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_CONTENTS                 0000019A 00000023 1   X   X(35)X
                      
*    01  TRUE                           000001BD 00000001 1   Z   9    X
                     1 
*    01  FALSE                          000001BE 00000001 1   Z   9    X
                     0 
*    01  RETURN_CODE                    000001BF 00000002 1   H   9(4) X
                     0 
ZC_WSLOC LOCTR 
ZC_WS_LOC_1  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_SAVEAREA DS CL72
ZC_WS_LOC_2  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_WS_ID DC CL8'WS*WS*WS'
ZC_WS_LOC_3  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_WS_START DS AL4
ZC_WS_LOC_4  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_WS_LEN DS FL4
ZC_WS_LOC_5  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
         DS  0CL0
ZC_WS_LOC_6  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
HFP_SRT  DC EHL4'1234'
ZC_WS_LOC_7  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
HFP_LNG  DC DHL8'1234'
ZC_WS_LOC_8  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
HFP_EXT  DC LHL16'1234'
ZC_WS_LOC_9  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BFP_SRT  DC EBL4'1234'
ZC_WS_LOC_10 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BFP_LNG  DC DBL8'1234'
ZC_WS_LOC_11 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BFP_EXT  DC LBL16'1234'
ZC_WS_LOC_12 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFP_SRT  DC EDL4'1234'
ZC_WS_LOC_13 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFP_LNG  DC DDL8'1234'
ZC_WS_LOC_14 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFP_EXT  DC LDL16'1234'
ZC_WS_LOC_15 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
HW       DC AL2(1234)                  RPI 1065
ZC_WS_LOC_16 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
FW       DC AL4(1234)                  RPI 1065
ZC_WS_LOC_17 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DW       DC FL8'1234'                  RPI 1065
ZC_WS_LOC_18 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
QW       DC FL16'1234'                 RPI 1065
ZC_WS_LOC_19 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PD       DC PL16'1234'
ZC_WS_LOC_20 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZD       DC ZL31'1234'
ZC_WS_LOC_21 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
FLT_SRT  DS EDL4
ZC_WS_LOC_22 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
FLT_LNG  DS DDL8
ZC_WS_LOC_23 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
FLT_EXT  DS LDL16
ZC_WS_LOC_24 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
HW2      DS  HL2
ZC_WS_LOC_25 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
FW2      DS  FL4
ZC_WS_LOC_26 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DW2      DS  FL8
ZC_WS_LOC_27 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
QW2      DS FL16
ZC_WS_LOC_28 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PD2      DS  PL16
ZC_WS_LOC_29 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZD2      DS  ZL31
ZC_WS_LOC_30 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GOOD     DC PL3'0'
ZC_WS_LOC_31 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_ITEM DS 0CL88
ZC_WS_LOC_32 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_LINE DS CL6
ZC_WS_LOC_33 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
         DC CL1' '
ZC_WS_LOC_34 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_NAME DS CL30
ZC_WS_LOC_35 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
         DC CL1' '
ZC_WS_LOC_36 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_SUB_1 DS ZL4
ZC_WS_LOC_37 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
         DC CL1' '
ZC_WS_LOC_38 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_SUB_2 DS ZL4
ZC_WS_LOC_39 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
         DC CL1' '
ZC_WS_LOC_40 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_SUB_3 DS ZL4
ZC_WS_LOC_41 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
         DC CL1' '
ZC_WS_LOC_42 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_CONTENTS DS CL35
ZC_WS_LOC_43 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
TRUE     DC CL1'1'
ZC_WS_LOC_44 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
FALSE    DC CL1'0'
ZC_WS_LOC_45 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
RETURN_CODE DC AL2(0)                  RPI 1065
*    ZCOBOL LINKAGE SECTION DATA ITEMS 
*    LVL DATA NAME                      ADDR     LEN      DUP TYP PIC  X
                     VALUE 
ZC_WSLOC LOCTR 
ZC_WSLOC LOCTR 
ZC_WS_DIFF EQU  *-ZC_WS-449  DIFF BETWEEN ALLOC AND CALC WS
ZC_WS_END DS   0D
         MNOTE *,'ZCOBOL TOTAL SYMBOLS                 = 45'
         MNOTE *,'ZCOBOL TOTAL SYMBOL DUPLICATES       = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL MAX DUP CHAIN    = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL LEVEL 88         = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL SET INDEXES      = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL LINKAGE SECTIONS = 0'
         MNOTE *,'ZCOBOL TOTAL PROCEDURE SECTIONS      = 0'
         MNOTE *,'ZCOBOL TOTAL PROCEDURE PARAGRAPHS    = 3'
         MNOTE *,'ZCOBOL TOTAL PROCEDURE PARAGRAPH DUP = 0'
         END 
