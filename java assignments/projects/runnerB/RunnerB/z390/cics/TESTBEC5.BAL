*    ZCOBOL PGM='cics\TESTBEC5' VER=V1.5.06 05/21/12 13:47:33 
*    ZCOBOL OPTIONS=(CICS) 
         COPY  TESTBEC5_ZC_LABELS.CPY
*      ****************************************************************X
                              *
*      * Copyright 2006 Automated Software Tools Corporation           X
                              *
*      * This source code is part of z390 assembler/emulator package   X
                              *
*      * The z390 package is distributed under GNU general public      X
                              *
*      * license                                                       X
                              *
*      * Author - Don Higgins                                          X
                              *
*      ****************************************************************X
                              *
*         IDENTIFICATION DIVISION.
*      * TEST HANDLE AID/PUSH/POP
*      * TEST GETMAIN/FREEMAIN
*         PROGRAM-ID. TESTBEC5.
         PRINT NOLIST,NOGEN,NOLISTUSE    SET LIST OPTION FOR INTERNAL CX
               ODE
DFHEIBR  EQU   11
         USING DFHEIBLK_DSECT,DFHEIBR
*
* TERMINAL CONTROL TABLE - TERMINAL ENTRY
*
DFHTCTTE DSECT 
TCTTEHED DS    CL8         'DFHTCTTE'
TCTTETI  DS    CL4         TERMINAL ID
TCTTEDA  DS    AL4         A(TIOA)
TCTTETC  DS    CL4         NEXT TRANSID
TCTTEINT DS    CL4         INITIAL TRANSID
TCTTECA  DS    AL4         RETURN COMMAREA ADDRESS
TCTTECAL DS    XL2         RETURN COMMAREA ADDRESS LENGTH
TCTTELNK DS    XL2         RETURN LINK LEVEL, 0 RETURNS TO Z390KCP
TCTTELKA DS    AL4         LINK LEVEL AREA POINTER
*                          EACH 4-BYTE ENTRY HAS THE DSA ADDRESS
TCTTEABD DS    AL4         HANDLE ABEND BLOCK
TCTTESCC DS    AL4         STORAGE CONTROL CHAIN
TCTTEPCT DS    AL4         ADDRESS OF DFHPCT
TCTTEIMM DS    X           FF=RETURN IMMEDIATE
TCTTETS  DS    X           FF=SHUTDOWN REQUEST
TCTTETYP DS    C           TRANSID START TYPE (FROM Z390KCP/KCPGOTYP)
*                             A = .INI INITIAL TRANSID
*                             B = SCREEN INPUT
*                             C = RETURN TRANSID()
*                             D = IC START-NO DATA
*                             E = IC START-DATA
TCTTECND DS    X           FF=XCTL COMMAREA MUST BE FREED ON RETURN
TCTTEEDF DS    X           FF=EDF IS ACTIVE
TCTTEEBA DS    X           CEDF INTERCEPT INDICATOR
*                             00='BEFORE'
*                             FE='AFTER' LINK/XCTL/RETURN FAIL
*                             FF='AFTER'
TCTTEEDL DS    X           CEDF LINKAGE INDICATOR
*                             00=NORMAL LINKAGE
*                             FE=SPECIAL LINKAGE
*                             FF=DIRECT LINKAGE
TCTTEEDT DS    CL4         TERMID FOR EDF OUTPUT
TCTTEEDA DS    AL4         ADDRESS OF EDF PROCESSOR LCLCEDF
TCTTEQFN DS    PL3         SEQUENTIAL TERMINAL FILE NUMBER
TCTTEQFO DS    X           FF=CURRENT SEQUENTIAL FILE IS OPEN
TCTTEQFL DS    AL4         ADDRESS OF SEQUENTIAL TERMINAL FILENAME
TCTTEQDI DS    AL4         ADDRESS OF RECEIVE DCB
TCTTEQDO DS    AL4         ADDRESS OF SEND DCB
TCTTECWA DS    AL4         ADDRESS OF LOCAL CWA COPY
TCTTECWL DS    XL4         LENGTH OF LOCAL CWA COPY
TCTTELCL DS    AL4         ADDRESS OF LCL MODULE INDEXER
TCTTEIQF DS    X           FF=INQUIRE FILE BROWSE IN PROGRESS
TCTTEIFN DS    CL8         INQUIRE FILE CURRENT POSITION
TCTTECHN DS    CL16        PASSED CHANNEL NAME
TCTTECAQ DS    AL4         ANCHOR FOR CHANNEL CHAIN
TCTTETKN DS    XL4         TOKEN FOR STARTBROWSE CONTAINER
TCTTECHW DS    AL4         ADDRESS OF CHWA (STARTBROWSE CONTAINER)
* FIELDS FOR ASSIGN
TCTTEABP DS    X           ABDUMP INDICATOR
TCTTEABG DS    CL8         ABENDING PROGRAM
TCTTEPSW DS    XL8         ASRA PSW
TCTTEASR DS    XL64        ASRA REGS
TCTTEINV DS    CL8         INVOKING PROGRAM
TCTTERET DS    CL8         RETURN PROGRAM
TCTTELNA EQU   *-TCTTEABP  ASSIGN FIELDS TO CLEAR
TCTTEABC DS    CL4         ABCODE OR BLANK
TCTTENXT DS    CL4         RETURN TRANSID OR BLANK
TCTTEMCL DS    AL2         MAP COLUMN
TCTTEMHT DS    AL2         MAP HEIGHT
TCTTEMLN DS    AL2         MAP LINE
TCTTEMWH DS    AL2         MAP WIDTH
TCTTELEN EQU   *-DFHTCTTE
TCTTEAR  EQU   10
         USING DFHTCTTE,TCTTEAR
R0     EQU 0
R1     EQU 1
R2     EQU 2
R3     EQU 3
R4     EQU 4
R5     EQU 5
R6     EQU 6
R7     EQU 7
R8     EQU 8
R9     EQU 9
R10    EQU 10
R11    EQU 11
R12    EQU 12
R13    EQU 13
R14    EQU 14
R15    EQU 15
TESTBEC5 CSECT 
*            R1 >>> A(EIB,COMMAREA)
*            R2 >>> P0E02 (LINK) OR P0E04 (XCTL) PARMS
* TCTTEAR (R10) >>> TCTTE
* DFHEIBR (R11) >>> EIB
*         (R14) >>> RETURN ADDRESS (LINK ONLY)
*
         L     R2,0(R2)           R2=P0E02/P0E04 PARM POINTER
         STRL  R2,CICS_EIENT_0035_PARMPNTR SAVE IT
* ENTRY IS ONLY BY DIRECT BRANCH FROM MODULES LCL0E02 (LINK)
* OR LCL0E04 (XCTL)
         LR    R2,R1              R2=SAVE USER PARM POINTER
* DON'T SAVE THE REGS IF XCTL, THIS ISN'T A NEW LINK LEVEL
         CHHSI EIBFN,X'0E04'      XCTL ?
         JE    CICS_EIENT_0035_NOSAVE EXIT IF IT IS
* FIND LAST LINKER AND ESTABLISH LINKAGE
         LH    R15,TCTTELNK       R15=CURRENT LINK LEVEL
         AHI   R15,-1             -1
         SLL   R15,2              *4
         L     R1,TCTTELKA        R0=LKA ADDRESS
         AR    R1,R15             INDEX TO LAST LINK-LEVEL ENTRY
         L     R13,0(R1)          SAVE AREA OF LAST LINK-LEVEL
         STM   14,12,12+4*(14-14)(13)
CICS_EIENT_0035_NOSAVE     EQU *
*
* GETMAIN THE DSA, AND SET UP THE CHAIN
*
         IILF  R1,(DFHEIEND-DFHEISTG) R1=DSA LENGTH RPI 1181
         LA    0,B'00'
         SVC   4 GMAIN R0=(X'02'=31B,X'01'=COND),R1=LEN OUT(R0=L,R1=A)
* DON'T SAVE THE REGS IF XCTL, THIS ISN'T A NEW LINK LEVEL
         CHHSI EIBFN,X'0E04'      XCTL ?
         JE    CICS_EIENT_0035_NOSAVE2 EXIT IF IT IS
         ST    R1,8(R13)          SAVE NEW DSA SAVE AREA IN PRIOR SAVE
         ST    R13,4(R1)          SAVE OLD SAVE AREA IN NEW DSA SAVE
CICS_EIENT_0035_NOSAVE2     EQU *
         LR    R13,R1             DSA BASE 1
         USING DFHEISTG,R13
         XC    DFHEICAP(DFHEIUSR-DFHEICAP),DFHEICAP CLEAR PREFIX DSA
*
* SAVE DSA LENGTH
*
         ST    R0,DFHEILEN        SAVE DSA LENGTH FOR FREEMAIN
*
* SET EIB AND COMMAREA ADDRESSES
*
         MVC   DFHEIEIB,0(R2)     SET EIB ADDRESS IN DSA
         MVC   DFHEICAP,4(R2)     SET COMMAREA ADDRESS IN DSA
*
* IF WE CAME FROM XCTL, WE MUST FREE THE PARM STORAGE AREA
*
         CHHSI EIBFN,X'0E04'      XCTL ?
         JNE   CICS_EIENT_0035_01 EXIT IF NOT
         LA    R0,8               LENGTH OF 8
         LR    1,R2
         SVC   5 FREEMAIN R0=LEN, R1=ADDR
         LA    R2,DFHEIEIB        NEW PARM POSITION FOR ZCOBOL
CICS_EIENT_0035_01     DS 0H
*
* FIND OUR LKA ENTRY AND STORE OUR DSA ADDRESS
*
         LH    R15,TCTTELNK       R15=CURRENT LINK LEVEL
         SLL   R15,2              *4
         L     R1,TCTTELKA        R1=LKA ADDRESS
         AR    R1,R15             INDEX TO OUR LINK LEVEL ENTRY
         ST    R13,0(R1)          SAVE OUR DSA ADDRESS
         MVC   DFHEIINV,TCTTEINV  SET INVOKING PROGRAM FOR ASSIGN
         MVC   DFHEIRET,TCTTERET  SET RETURN PROGRAM FOR ASSIGN
         MVC   DFHEICHN,TCTTECHN  SET CHANNEL FOR ASSIGN
*
         CLI   TCTTEEDF,X'FF'     EDF ON ?
         JNE   CICS_EIENT_0035_NOEDFA EXIT IF NOT
* PROGRAM INITIATION
         MVI   TCTTEEBA,X'FF'     SET 'AFTER' INTERCEPT
         MVI   TCTTEEDL,X'FE'     SET SPECIAL LINKAGE
         L     R15,TCTTEEDA       R15=EDF PROCESSOR ADDRESS
         BAKR  0,R15              STACK REGS AND GO
         J     CICS_EIENT_0035_NOEDFA EXIT
CICS_EIENT_0035_PARMPNTR     DS AL4 SAVE P0E02/P0E04 PARM POINTER
*
CICS_EIENT_0035_NOEDFA     DS 0H
         CNOP  4,8             FORCE ZC390PVT TO DOUBLEWORD BOUNDARY
         BRAS  ZC_R8,ZC_LOAD
         USING *,ZC_R8            BASE FOR LOAD AND CICS V5 USE
*
*  THESE FIELDS MUST BE KEPT IN SYNC WITH zcobol\ZC390PVT.CPY
*
         DC    CL8'TESTBEC5'    PVTPGM   ZCOBOL PGM NAME
         DC    CL8'05/21/12'   PVTDATE  ZCOBOL COMPILE DATE
         DC    CL8'13.47'   PVTTIME  ZCOBOL COMPILE TIME
         DC    CL8'V1.5.06'    PVTVER   ZCOBOL COMPILER VERSION
         DC    C'1'     PVTCICS  ZCOBOL EXEC CICS PGM
         DC    C'1'   PVTEXTND ZCOBOL EXTENDED PRECISION
         DC    C'0'    PVTTRUNC ZCOBOL TRUNCATE TO PICTURE
         DC    C'1'      PVTR64   ZCOBOL USE 64 BIT REGISTERS
         DC    H'80' MAX DISPLAY LINE LEN  RPI 1118
         DS    XL10            RESERVED
ZC_LOAD  DS    0H
         LA    0,=CL8'ZC390LIB'
         SR    15,15 USE DEFAULT SYS390 SEARCH
         SVC   8 LOAD R0=A(NAME) R15=DDNAME/DSNAME ADDR OR 0
         LTR   ZC_R15,ZC_R15
         JZ    ZC_LOAD_OK
         BRAS  1,*+(WTO#0045_EOT-*+1)/2*2
         DC    AL2(WTO#0045_EOT-*,0),C'ZC390LIB NOT FOUND'
WTO#0045_EOT     EQU *
         SVC   35
         LA  ZC_R15,16
         SVC 3      EXIT TO CALLER WITH RC=16
ZC_LOAD_OK DS  0H
         LR    ZC_R9,ZC_R0
         USING ZC390CVT,ZC_R9    R9=CVT
         CLC   ZCVT_ID,=C'ZCVT'              CHECK ZCVT ID AND LENGTH
         JNE   ZC_VER_ERR                    IN ZC390LIB.390 MATCH
         CLC   ZCVT_LEN,=A(ZCVT_END-ZCVT_ID) ZCOBOL PGM COMPILED ID/LEN
         BNE   ZC_VER_ERR
         L     ZC_R15,ZCVT_ZC390NUC
         BASR  ZC_R14,ZC_R15 CALL ZC390NUC TO VERIFY VER, OPTIONS
         J     ZC_VER_OK
ZC_VER_ERR DS 0H
         BRAS  1,*+(WTO#0046_EOT-*+1)/2*2
         DC    AL2(WTO#0046_EOT-*,0),C'ZC390LIB ZCVT VERIFY ERROR'
WTO#0046_EOT     EQU *
         SVC   35
         LA  ZC_R15,16
         SVC 3      EXIT TO CALLER WITH RC=16
         LTORG 
         PUSH  PRINT,NOPRINT
         PRINT OFF,NOPRINT
ZC_R0    EQU   0
ZC_R1    EQU   1
ZC_R2    EQU   2
ZC_R3    EQU   3
ZC_R4    EQU   4
ZC_R5    EQU   5
ZC_R6    EQU   6
ZC_R7    EQU   7
ZC_R8    EQU   8
ZC_R9    EQU   9
ZC_R10   EQU  10
ZC_R11   EQU  11
ZC_R12   EQU  12
ZC_R13   EQU  13
ZC_R14   EQU  14
ZC_R15   EQU  15
ZC_F0    EQU   0
ZC_F1    EQU   1
ZC_F2    EQU   2
ZC_F3    EQU   3
ZC_F4    EQU   4
ZC_F5    EQU   5
ZC_F6    EQU   6
ZC_F7    EQU   7
ZC_F8    EQU   8
ZC_F9    EQU   9
ZC_F10   EQU  10
ZC_F11   EQU  11
ZC_F12   EQU  12
ZC_F13   EQU  13
ZC_F14   EQU  14
ZC_F15   EQU  15
ZC_H     EQU   2   HIGH
ZC_L     EQU   4   LOW
ZC_E     EQU   8   EQUAL
ZC_NH    EQU   13  NOT HIGHT
ZC_NL    EQU   11  NOT LOW
ZC_NE    EQU   7   NOT EQUAL
ZC_O     EQU   1   OVERFLOW
ZC_P     EQU   2   POSITIVE
ZC_M     EQU   4   MINUS
ZC_Z     EQU   8   ZERO
ZC_NP    EQU   13  NOT POSITIVE
ZC_NM    EQU   11  NOT MINUS
ZC_NZ    EQU   7   NOT ZERO
ZC_NO    EQU   14  NOT OVERFLOW
ZC_EQ    EQU   8   EQUAL
ZC_GT    EQU   2   GREATER THAN
ZC_LT    EQU   4   LESS    THAN
ZC_GE    EQU   11  GREATER THAN OR EQUAL
ZC_LE    EQU   13  LESS    THAN OR EQUAL
         POP   PRINT,NOPRINT
PFPO_TEST    EQU  X'80' PFPO TEST IF VALID OPCODE (NOT SUPPORTED YET)
PFPO_RADIX   EQU  1 PFPO OPCODE - CONVERT FROM ONE RADIX TO ANOTHER
PFPO_RND     EQU  0 PFOP ROUNDING OPTION (ONLY DEFAULT ALLOWED)
PFPO_TYPE_EH EQU  0 EH HFP SHORT     32 BITS 7  DIGITS
PFPO_TYPE_DH EQU  1 ED HFP LONG      64 BITS 15 DIGITS
PFPO_TYPE_LH EQU  2 EL HFP EXTENDED 128 BITS 30 DIGITS
PFPO_TYPE_EB EQU  5 EB BFP SHORT     32 BITS 7  DIGITS
PFPO_TYPE_DB EQU  6 DB BFP LONG      64 BITS 16 DIGITS
PFPO_TYPE_LB EQU  7 LB BFP EXTENDED 128 BITS 34 DIGITS
PFPO_TYPE_ED EQU  8 ED DFP SHORT     32 BITS 7  DIGITS
PFPO_TYPE_DD EQU  9 DD DFP LONG      64 BITS 16 DIGITS
PFPO_TYPE_LD EQU 10 LD DFP EXTENDED 128 BITS 34 DIGITS
ZC_VER_OK DS   0H
ZC390CVT DSECT                ZCOBOL CVT AT ENTRY TO ZC390LIB.390
ZCVT_ID            DC    C'ZCVT'             ZCVT ID  VERIFIED BY ZCOB
ZCVT_LEN           DC    A(ZCVT_END-ZCVT_ID) ZCVT LEN VERIFIED BY ZCOB
ZCVT_VER           DC    CL8'V1.5.06'    ZCVT VER VERIFIED BY ZC390NUC
ZCVT_ZC390NUC  DC V(ZC390NUC)      MODULE  SYSTEM ROUTINE MODULE INIT
ZCVT_CALL           DC V(CALL)       ENTRY R0=A(PGM),R1=A(PARMLIST)
ZCVT_CMP64R32       DC V(CMP64R32)   ENTRY COMPARE R0-1=FLD1 R2-3=FLD2
ZCVT_CVTLBTQ        DC V(CVTLBTQ)    ENTRY CVT LB IN F4-6 TO Q IN R0-1
ZCVT_CVTLDTP        DC V(CVTLDTP)    ENTRY CVT LD IN F0-2 TO PL31 R0-1
ZCVT_CVTQTLB        DC V(CVTQTLB)    ENTRY CVT Q IN R0-1 TO LB IN F4-6
ZCVT_DIV64R32       DC V(DIV64R32)   ENTRY DIVIDE R0-1=N64, R2-3=MAX64
ZCVT_DIVQ128        DC V(DIVQ128)    ENTRY DIVIDE Q128 R0-R1 BY R2-R3
ZCVT_GOBACK         DC V(GOBACK)     ENTRY R1=RC
ZCVT_MPYQ128        DC V(MPYQ128)    ENTRY MULTIPLY Q128 R0-R1 BY R2-R3
ZCVT_OSE64R32       DC V(OSE64R32)   ENTRY ON SIZE ERR R0-1=N, R2-3=MAX
ZCVT_PERFORM        DC V(PERFORM)    ENTRY R14=PGTAR,R0=PGEXT,R1=PMRET
ZCVT_PMCHECK        DC V(PMCHECK)    ENTRY R14=RETURN TO NEXT INSTR.
ZCVT_ROUNDF         DC V(ROUNDF)     ENTRY R0=REM,R1=QUO,R2=DIVISOR
ZCVT_STACKORG       DC V(STACKORG)   ENTRY PERFORM STACK ORIGIN
ZCVT_STACKPTR       DC V(STACKPTR)   ENTRY CUR ENTRY A(PG_END+4,RET)
ZCVT_STACKEND       DC V(STACKEND)   ENTRY PERFORM STACK END
ZCVT_STOPRUN        DC V(STOPRUN)    ENTRY R1=RC
ZCVT_TALPHAX        DC V(TALPHAX)    ENTRY TEST ALPHABETIC X
ZCVT_TNUMP          DC V(TNUMP)      ENTRY TEST NUMERIC P
ZCVT_TNUMX          DC V(TNUMX)      ENTRY TEST NUMERIC X
ZCVT_TNUMZ          DC V(TNUMZ)      ENTRY TEST NUMERIC Z
*
* ADDITIONAL SEPARATE MODULES LINKED WITH Z390NUC IN ZC390LIB.390
*
ZCVT_ABORT     DC V(ABORT)         MODULE  R1=ABORT ERROR MSG #
ZCVT_ABORT_ALTER   EQU    1 ABORT ALTER DUE TO BRC NOT FOUND AT TARGET
ZCVT_ABORT_CALL    EQU    2 ABORT DYNAMIC CALL - PGM NOT FOUND
ZCVT_ABORT_DISPLAY EQU    3 ABORT DISPLAY DUE TO BUFFER EXCEEDED
ZCVT_ABORT_OPEN    EQU    4 ABORT OPEN  INVALID DCB
ZCVT_ABORT_STACK   EQU    6 ABORT PEROFRM STACK OVERFLOW
ZCVT_ABORT_VERSION EQU    7 ABORT ZC390NUC INIT ZCOBOL VERSION ERROR
ZCVT_ABORT_INT128  EQU    8 ABORT INTEGER 128 CONVERSION OVERFLO
ZCVT_ABORT_DIVQ    EQU    9 ABORT DIVIDE Q IF DIVISOR 0 OR > 2**63
ZCVT_ABORT_CICS    EQU   10 ABORT THIS PGM REQUIRES EXEC CICS TRANS MGR
ZCVT_ABORT_ACCEPT  EQU   11 ABORT ACCEPT EOF
ZCVT_ABORT_MAXERR  EQU   11 ABORT MAX ERROR CODE
ZCVT_ACCEPT    DC V(ACCEPT)        MODULE  R1=A(TYPE,FLD_ADD,FLD_LEN)
ZCVT_ACCEPT_DEFAULT EQU   1 INPUT DEFAULT DDNAME=SYSIN
ZCVT_ACCEPT_CONSOLE EQU   2 INPUT VIA WTOR FROM CONSOLE
ZCVT_ACCEPT_DDNAME  EQU   3 INPUT FROM DDNAME WITH DDNAME ADDR IN R3
ZCVT_ACCEPT_DATE    EQU   4 RETURN DAY OF WEEK PIC 9(8) MMDDYYYY
ZCVT_ACCEPT_TIME    EQU   5 RETURN DAY OF WEEK PIC 9(8) HHMMSSTH
ZCVT_ACCEPT_DOW     EQU   6 RETURN DAY OF WEEK PIC 9 1-7
ZCVT_DISPLAY   DC V(DISPLAY)       MODULE  R1=A(ADDR,LEN,TYPE)
ZCVT_INSPECT   DC V(INSPECT)       MODULE  R0=TYPE,R1=PARMLIST
ZCVT_TALLYING      EQU   0 INSPECT TALLYING
ZCVT_REPLACING     EQU   4 INSPECT REPLACING
ZCVT_CONVERTING    EQU   8 INSPECT CONVERTING
*
* SHARED DATA AREAS
*
ZCVT_PVTMAXDL  DS H          MAXIMUM DISPLAY LINE LENGTH  RPI 1118
               DS 0D
ZCVT_ZERO      DC XL16'00'   BINARY ZEROS
ZCVT_HIGH_VALUES DC 0XL16,16X'FF' BINARY FF'S     RPI 1181
ZCVT_PWORK     DS PL8        CVD/CVB WORK
ZCVT_PWORK1    DS PL16       DIV DIVIDEND, CVDG/CVBG WORK
ZCVT_PWORK2    DS PL16       DIV DIVISOR
ZCVT_PWORK3    DS PL16       DIV QUOTIENT
ZCVT_PWORK4    DS PL16       DIV REMAINDER
ZCVT_NDDX      DS XL16       DIV DIVIDEND HOLD AREA
ZCVT_WORKAREA  DS XL256      GEN_INSPECT PARMS, GEN_EDIT WORK, ETC.
*
* END OF ZC390CVT
*
ZCVT_END   EQU   *
ZC390PVT DSECT 
PVTPGM   DS    CL8  ZCOBOL PGM NAME
PVTDATE  DS    CL8  ZCOBOL COMPILE DATE
PVTTIME  DS    CL8  ZCOBOL COMPILE TIME
PVTVER   DS    CL8  ZCOBOL COMPILER VERSION
PVTCICS  DS    C    ZCOBOL EXEC CICS PGM
PVTEXTND DS    C    ZCOBOL EXTENDED PRECISION
PVTTRUNC DS    C    ZCOBOL TRUNCATE TO PICTURE
PVTR64   DS    C    ZCOBOL USE 64 BIT REGISTERS
PVTMAXDL DS    H    ZCOBOL MAX DISPLAY LINE LENGTH
         DS    XL10 RESERVED
DFHEISTG DSECT 
         DS    18F  SAVE AREA
DFHEIEIB DS    A    EIB POINTER
DFHEICAP DS    A    COMMAREA POINTER
DFHEICAL DS    H    COMMAREA LENGTH, COPY OF EIBCALEN
DFHEILEN DS    A    LENGTH OF DSA SET BY DFHEIENT
DFHEIAID DS    A    ADDRESS OF HANDLE AID BLOCK (DSECT=DFHADBLK)
DFHEIHCN DS    A    ADDRESS OF HANDLE CONDITION BLOCK (DSECT=DFHHCBLK)
DFHEIINV DS    CL8  INVOKING PROGRAM FOR ASSIGN
DFHEIRET DS    CL8  RETURN PROGRAM FOR ASSIGN
DFHEICHN DS    CL16 CHANNEL FOR ASSIGN
DFHEIUSR DS    0D   USER PROGRAM STORAGE (SEE DFHEIEND FOR END)
ZC_WS    EQU   DFHEISTG
*         ENVIRONMENT DIVISION.
*         DATA DIVISION.
         PRINT DATA
*         WORKING-STORAGE SECTION.
*         77  GET1     PIC 9(9) COMP USAGE IS POINTER.
*         77  GET2     PIC 9(9) COMP USAGE IS POINTER.
*         77  GET3     PIC 9(9) COMP USAGE IS POINTER.
*         77  GET4     PIC 9(9) COMP USAGE IS POINTER.
*         77  GET5     PIC 9(9) COMP USAGE IS POINTER.
*         77  GETBAD   PIC 9(9) COMP USAGE IS POINTER.
*         77  RECAREA  PIC X(80).
*         77  RECLEN   PIC 9(4) COMP.
*         01  HEAD.
*             02  FILLER  PIC X(6)  VALUE X'27F5C311C1D1'.
*             02  FILLER  PIC X(51)
*            VALUE 'TESTBEC5 TEST HANDLE, PUSH/POP AND GETMAIN/FREEMAINX
               '.
*             02  FILLER  PIC X(3)  VALUE X'11C261'.
*             02  FILLER  PIC X(14) VALUE 'PRESS PF KEY 4'.
*             02  FILLER  PIC X(3)  VALUE X'11C3F1'.
*             02  FILLER  PIC X(25) VALUE 'CLEAR WILL END TASK EARLY'.
*         77  HEADL    PIC 9(4) COMP.
*         01  BADMSG1.
*             02  FILLER  PIC X(4)  VALUE X'C311C5C1'.
*             02  FILLER  PIC X(19) VALUE 'THAT KEY WASN''T PF4'.
*         77  BADMSG1L PIC 9(4) COMP.
*         01  BADMSG2.
*             02  FILLER  PIC X(4)  VALUE X'C311C761'.
*             02  FILLER  PIC X(19) VALUE 'THAT KEY WASN''T PF5'.
*         77  BADMSG2L PIC 9(4) COMP.
*         01  BADMSG3.
*             02  FILLER  PIC X(4)  VALUE X'C3114AC1'.
*             02  FILLER  PIC X(19) VALUE 'THAT KEY WASN''T PF6'.
*         77  BADMSG3L PIC 9(4) COMP.
*         01  PF4MSG.
*             02  FILLER  PIC X(4)  VALUE X'C311C5C1'.
*             02  FILLER  PIC X(20) VALUE 'I GOT PF4, THANKYOU '.
*         77  PF4MSGL  PIC 9(4) COMP.
*         01  PF5ASK.
*             02  FILLER  PIC X(4)  VALUE X'C311C6D1'.
*             02  FILLER  PIC X(14) VALUE 'PRESS PF KEY 5'.
*         77  PF5ASKL  PIC 9(4) COMP.
*         01  PF5MSG.
*             02  FILLER  PIC X(4)  VALUE X'C311C761'.
*             02  FILLER  PIC X(20) VALUE 'I GOT PF5, THANKYOU '.
*         77  PF5MSGL  PIC 9(4) COMP.
*         01  PF6ASK.
*             02  FILLER  PIC X(4)  VALUE X'C311C8F1'.
*             02  FILLER  PIC X(14) VALUE 'PRESS PF KEY 6'.
*         77  PF6ASKL  PIC 9(4) COMP.
*         01  PF6MSG.
*             02  FILLER  PIC X(4)  VALUE X'C3114AC1'.
*             02  FILLER  PIC X(20) VALUE 'I GOT PF6, THANKYOU '.
*         77  PF6MSGL  PIC 9(4) COMP.
*         01  PGMMSG.
*             02  FILLER  PIC X(4)  VALUE X'C3114BD1'.
*             02  FILLER  PIC X(27) VALUE 'PGMIDERR WILL NOW BE RAISED'X
                              .
*         77  PGMMSGL  PIC 9(4) COMP.
*         01  PGMMSGE.
*             02  FILLER  PIC X(4)  VALUE X'C3114C61'.
*             02  FILLER  PIC X(29)
*                         VALUE 'PGMIDERR CONDITION HANDLED OK'.
*         77  PGMMSGEL PIC 9(4) COMP.
*         01  PGMMSG2.
*             02  FILLER  PIC X(4)  VALUE X'C3114DF1'.
*             02  FILLER  PIC X(33)
*                         VALUE 'PGMIDERR WILL NOW BE RAISED AGAIN'.
*         77  PGMMSG2L PIC 9(4) COMP.
*         01  ERRMSG.
*             02  FILLER  PIC X(4)  VALUE X'C3114FC1'.
*             02  FILLER  PIC X(26) VALUE 'ERROR CONDITION HANDLED OK'.
*         77  ERRMSGL  PIC 9(4) COMP.
*         01  IGNMSG.
*             02  FILLER  PIC X(4)  VALUE X'C31150D1'.
*             02  FILLER  PIC X(27) VALUE 'IGNORE CONDITION HANDLED OK'X
                              .
*         77  IGNMSGL  PIC 9(4) COMP.
*         01  GTMMSG.
*             02  FILLER  PIC X(4)  VALUE X'C311D161'.
*             02  FILLER  PIC X(40)
*                      VALUE 'GETMAIN/FREEMAIN TESTING, OK IF NO ABEND'X
                              .
*         77  GTMMSGL  PIC 9(4) COMP.
*         01  ABDMSG.
*             02  FILLER  PIC X(4)  VALUE X'C311D2F1'.
*             02  FILLER  PIC X(34)
*                         VALUE 'PGMIDERR WILL NOW CAUSE ABEND AEI0'.
*             02  FILLER  PIC X(3)  VALUE X'11D4C1'.
*             02  FILLER  PIC X(11) VALUE 'PRESS CLEAR'.
*         77  ABDMSGL  PIC 9(4) COMP.
*         77  INIT5    PIC X    VALUE X'05'.
*         COPY DFHAID.
*      * AID VALUES
*        01  DFHAID.
*          02  DFHNULL  PIC X VALUE X'00'.
*          02  DFHENTER PIC X VALUE X'7D'.
*          02  DFHPF1   PIC X VALUE X'F1'.
*          02  DFHPF2   PIC X VALUE X'F2'.
*          02  DFHPF3   PIC X VALUE X'F3'.
*          02  DFHPF4   PIC X VALUE X'F4'.
*          02  DFHPF5   PIC X VALUE X'F5'.
*          02  DFHPF6   PIC X VALUE X'F6'.
*          02  DFHPF7   PIC X VALUE X'F7'.
*          02  DFHPF8   PIC X VALUE X'F8'.
*          02  DFHPF9   PIC X VALUE X'F9'.
*          02  DFHPF10  PIC X VALUE X'7A'.
*          02  DFHPF11  PIC X VALUE X'7B'.
*          02  DFHPF12  PIC X VALUE X'7C'.
*          02  DFHPF13  PIC X VALUE X'C1'.
*          02  DFHPF14  PIC X VALUE X'C2'.
*          02  DFHPF15  PIC X VALUE X'C3'.
*          02  DFHPF16  PIC X VALUE X'C4'.
*          02  DFHPF17  PIC X VALUE X'C5'.
*          02  DFHPF18  PIC X VALUE X'C6'.
*          02  DFHPF19  PIC X VALUE X'C7'.
*          02  DFHPF20  PIC X VALUE X'C8'.
*          02  DFHPF21  PIC X VALUE X'C9'.
*          02  DFHPF22  PIC X VALUE X'4A'.
*          02  DFHPF23  PIC X VALUE X'4B'.
*          02  DFHPF24  PIC X VALUE X'4C'.
*          02  DFHPA1   PIC X VALUE X'6C'.
*          02  DFHPA2   PIC X VALUE X'6E'.
*          02  DFHPA3   PIC X VALUE X'6B'.
*          02  DFHCLEAR PIC X VALUE X'6D'.
*
*      * EXEC INTERFACE BLOCK
*            02  EIBHEAD  PIC X(8).
*            02  EIBTIME  PIC 9(7) COMP-3.
*            02  EIBDATE  PIC 9(7) COMP-3.
*            02  EIBTRNID PIC X(4).
*            02  EIBTASKN PIC 9(7) COMP-3.
*            02  EIBTRMID PIC X(4).
*            02  FILLER   PIC X(2).
*            02  EIBCPOSN PIC 9(4) COMP.
*            02  EIBCALEN PIC 9(4) COMP.
*            02  EIBAID   PIC X.
*            02  EIBFN    PIC 9(4) COMP.
*            02  EIBRCODE PIC X(6).
*            02  EIBREQID PIC X(8).
*            02  EIBDS    PIC X(8).
*            02  EIBRSRCE PIC X(8).
*            02  EIBRESP  PIC 9(9) COMP.
*            02  EIBRESP2 PIC 9(9) COMP.
*            02  EIBPROG  PIC X(8).
*            02  EIBDTFRM PIC X.
         PRINT LIST,GEN,LISTUSE TURN PRINT LISTING ON FOR USER CODE GEN
TESTBEC5 CSECT                SWITCH TO PROCEDURE CODE AHEAD OF WS
         L     ZC_R0,0(ZC_R2)          LOAD PARM ADDR FROM PARMLIST
         ST    ZC_R0,ZC_DFHEIBLK_PTR STORE PARM POINTER
         L     ZC_R0,4(ZC_R2)          LOAD PARM ADDR FROM PARMLIST
         ST    ZC_R0,ZC_DFHCOMMAREA_PTR STORE PARM POINTER
         LARL  ZC_R1,=XL6'27F5C311C1D1'
          MVC   ZC_FILLER_V1,0(ZC_R1)
         LARL  ZC_R1,=CL52'TESTBEC5 TEST HANDLE, PUSH/POP AND GETMAIN/FX
               REEMAIN'
          MVC   ZC_FILLER_V2,0(ZC_R1)
         LARL  ZC_R1,=XL4'11C261'
          MVC   ZC_FILLER_V3,1(ZC_R1)
         LARL  ZC_R1,=CL14'PRESS PF KEY 4'
          MVC   ZC_FILLER_V4,0(ZC_R1)
         LARL  ZC_R1,=XL4'11C3F1'
          MVC   ZC_FILLER_V5,1(ZC_R1)
         LARL  ZC_R1,=CL26'CLEAR WILL END TASK EARLY'
          MVC   ZC_FILLER_V6,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311C5C1'
          MVC   ZC_FILLER_V7,0(ZC_R1)
         LARL  ZC_R1,=CL20'THAT KEY WASN''T PF4'
          MVC   ZC_FILLER_V8,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311C761'
          MVC   ZC_FILLER_V9,0(ZC_R1)
         LARL  ZC_R1,=CL20'THAT KEY WASN''T PF5'
          MVC   ZC_FILLER_V10,0(ZC_R1)
         LARL  ZC_R1,=XL4'C3114AC1'
          MVC   ZC_FILLER_V11,0(ZC_R1)
         LARL  ZC_R1,=CL20'THAT KEY WASN''T PF6'
          MVC   ZC_FILLER_V12,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311C5C1'
          MVC   ZC_FILLER_V13,0(ZC_R1)
         LARL  ZC_R1,=CL20'I GOT PF4, THANKYOU '
          MVC   ZC_FILLER_V14,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311C6D1'
          MVC   ZC_FILLER_V15,0(ZC_R1)
         LARL  ZC_R1,=CL14'PRESS PF KEY 5'
          MVC   ZC_FILLER_V16,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311C761'
          MVC   ZC_FILLER_V17,0(ZC_R1)
         LARL  ZC_R1,=CL20'I GOT PF5, THANKYOU '
          MVC   ZC_FILLER_V18,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311C8F1'
          MVC   ZC_FILLER_V19,0(ZC_R1)
         LARL  ZC_R1,=CL14'PRESS PF KEY 6'
          MVC   ZC_FILLER_V20,0(ZC_R1)
         LARL  ZC_R1,=XL4'C3114AC1'
          MVC   ZC_FILLER_V21,0(ZC_R1)
         LARL  ZC_R1,=CL20'I GOT PF6, THANKYOU '
          MVC   ZC_FILLER_V22,0(ZC_R1)
         LARL  ZC_R1,=XL4'C3114BD1'
          MVC   ZC_FILLER_V23,0(ZC_R1)
         LARL  ZC_R1,=CL28'PGMIDERR WILL NOW BE RAISED'
          MVC   ZC_FILLER_V24,0(ZC_R1)
         LARL  ZC_R1,=XL4'C3114C61'
          MVC   ZC_FILLER_V25,0(ZC_R1)
         LARL  ZC_R1,=CL30'PGMIDERR CONDITION HANDLED OK'
          MVC   ZC_FILLER_V26,0(ZC_R1)
         LARL  ZC_R1,=XL4'C3114DF1'
          MVC   ZC_FILLER_V27,0(ZC_R1)
         LARL  ZC_R1,=CL34'PGMIDERR WILL NOW BE RAISED AGAIN'
          MVC   ZC_FILLER_V28,0(ZC_R1)
         LARL  ZC_R1,=XL4'C3114FC1'
          MVC   ZC_FILLER_V29,0(ZC_R1)
         LARL  ZC_R1,=CL26'ERROR CONDITION HANDLED OK'
          MVC   ZC_FILLER_V30,0(ZC_R1)
         LARL  ZC_R1,=XL4'C31150D1'
          MVC   ZC_FILLER_V31,0(ZC_R1)
         LARL  ZC_R1,=CL28'IGNORE CONDITION HANDLED OK'
          MVC   ZC_FILLER_V32,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311D161'
          MVC   ZC_FILLER_V33,0(ZC_R1)
         LARL  ZC_R1,=CL40'GETMAIN/FREEMAIN TESTING, OK IF NO ABEND'
          MVC   ZC_FILLER_V34,0(ZC_R1)
         LARL  ZC_R1,=XL4'C311D2F1'
          MVC   ZC_FILLER_V35,0(ZC_R1)
         LARL  ZC_R1,=CL34'PGMIDERR WILL NOW CAUSE ABEND AEI0'
          MVC   ZC_FILLER_V36,0(ZC_R1)
         LARL  ZC_R1,=XL4'11D4C1'
          MVC   ZC_FILLER_V37,1(ZC_R1)
         LARL  ZC_R1,=CL12'PRESS CLEAR'
          MVC   ZC_FILLER_V38,0(ZC_R1)
         MVI   INIT5,X'05'
         MVI   DFHNULL,X'00'
         MVI   DFHENTER,X'7D'
         MVI   DFHPF1,X'F1'
         MVI   DFHPF2,X'F2'
         MVI   DFHPF3,X'F3'
         MVI   DFHPF4,X'F4'
         MVI   DFHPF5,X'F5'
         MVI   DFHPF6,X'F6'
         MVI   DFHPF7,X'F7'
         MVI   DFHPF8,X'F8'
         MVI   DFHPF9,X'F9'
         MVI   DFHPF10,X'7A'
         MVI   DFHPF11,X'7B'
         MVI   DFHPF12,X'7C'
         MVI   DFHPF13,X'C1'
         MVI   DFHPF14,X'C2'
         MVI   DFHPF15,X'C3'
         MVI   DFHPF16,X'C4'
         MVI   DFHPF17,X'C5'
         MVI   DFHPF18,X'C6'
         MVI   DFHPF19,X'C7'
         MVI   DFHPF20,X'C8'
         MVI   DFHPF21,X'C9'
         MVI   DFHPF22,X'4A'
         MVI   DFHPF23,X'4B'
         MVI   DFHPF24,X'4C'
         MVI   DFHPA1,X'6C'
         MVI   DFHPA2,X'6E'
         MVI   DFHPA3,X'6B'
         MVI   DFHCLEAR,X'6D'
         LARL  ZC_R1,=CL8'ZCWSID1'
          MVC   ZC_WS_ID1,0(ZC_R1)
         MVI   ZC_FILLER_V39,C' '
         MVI   ZC_FILLER_V40,C' '
         MVI   ZC_FILLER_V41,C' '
         MVI   ZC_FILLER_V42,C' '
         MVI   ZC_FILLER_V43,C' '
          MVI   TRUE,C'1'
          MVI   FALSE,C'0'
          MVHHI RETURN_CODE,0
*
*             MOVE LENGTH OF HEAD    TO HEADL.
*ZC    163         MOVE  LENGTH,OF,HEAD,TO,HEADL
          MVHHI HEADL,102
*             MOVE LENGTH OF BADMSG1 TO BADMSG1L.
*ZC    164         MOVE  LENGTH,OF,BADMSG1,TO,BADMSG1L
          MVHHI BADMSG1L,23
*             MOVE LENGTH OF BADMSG2 TO BADMSG2L.
*ZC    165         MOVE  LENGTH,OF,BADMSG2,TO,BADMSG2L
          MVHHI BADMSG2L,23
*             MOVE LENGTH OF BADMSG3 TO BADMSG3L.
*ZC    166         MOVE  LENGTH,OF,BADMSG3,TO,BADMSG3L
          MVHHI BADMSG3L,23
*             MOVE LENGTH OF PF4MSG  TO PF4MSGL.
*ZC    167         MOVE  LENGTH,OF,PF4MSG,TO,PF4MSGL
          MVHHI PF4MSGL,24
*             MOVE LENGTH OF PF5ASK  TO PF5ASKL.
*ZC    168         MOVE  LENGTH,OF,PF5ASK,TO,PF5ASKL
          MVHHI PF5ASKL,18
*             MOVE LENGTH OF PF5MSG  TO PF5MSGL.
*ZC    169         MOVE  LENGTH,OF,PF5MSG,TO,PF5MSGL
          MVHHI PF5MSGL,24
*             MOVE LENGTH OF PF6ASK  TO PF6ASKL.
*ZC    170         MOVE  LENGTH,OF,PF6ASK,TO,PF6ASKL
          MVHHI PF6ASKL,18
*             MOVE LENGTH OF PF6MSG  TO PF6MSGL.
*ZC    171         MOVE  LENGTH,OF,PF6MSG,TO,PF6MSGL
          MVHHI PF6MSGL,24
*             MOVE LENGTH OF PGMMSG  TO PGMMSGL.
*ZC    172         MOVE  LENGTH,OF,PGMMSG,TO,PGMMSGL
          MVHHI PGMMSGL,31
*             MOVE LENGTH OF PGMMSGE TO PGMMSGEL.
*ZC    173         MOVE  LENGTH,OF,PGMMSGE,TO,PGMMSGEL
          MVHHI PGMMSGEL,33
*             MOVE LENGTH OF PGMMSG2 TO PGMMSG2L.
*ZC    174         MOVE  LENGTH,OF,PGMMSG2,TO,PGMMSG2L
          MVHHI PGMMSG2L,37
*             MOVE LENGTH OF ERRMSG  TO ERRMSGL.
*ZC    175         MOVE  LENGTH,OF,ERRMSG,TO,ERRMSGL
          MVHHI ERRMSGL,30
*             MOVE LENGTH OF IGNMSG  TO IGNMSGL.
*ZC    176         MOVE  LENGTH,OF,IGNMSG,TO,IGNMSGL
          MVHHI IGNMSGL,31
*             MOVE LENGTH OF GTMMSG  TO GTMMSGL.
*ZC    177         MOVE  LENGTH,OF,GTMMSG,TO,GTMMSGL
          MVHHI GTMMSGL,44
*             MOVE LENGTH OF ABDMSG  TO ABDMSGL.
*ZC    178         MOVE  LENGTH,OF,ABDMSG,TO,ABDMSGL
          MVHHI ABDMSGL,52
*             EXEC CICS SEND FROM(HEAD) LENGTH(HEADL) END-EXEC.
*ZC    179         EXEC  CICS,SEND,FROM(HEAD),LENGTH(HEADL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),HEADL   SET LENGTH FROM LABEL
         LA    R0,HEAD           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_0788 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_0788    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_0788   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_0788   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_0788) ENTRYPOINT FOR IGNORE CONDITION
*
         J     P0404BYP_0788   EXIT
*
P0404    DS    0H
P0404FN  DS    XL2                FUNCTION CODE
P0404EIB DS    AL4                EIB
P0404TCT DS    AL4                TCTTE
P0404FRM DS    AL4                FROM
P0404LEN DS    XL2                LENGTH
P0404EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0404EDS DS    AL4                DSA ADDRESS FOR EDF
P0404EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0404EDL DS    XL2                DSA LENGTH FOR EDF
P0404NED DS    X                  FF=NOEDF
         DS    X
P0404NOH DS    X                  FF=NOHANDLE
         DS    X
P0404RSP DS    AL4                RESP
P0404RS2 DS    AL4                RESP2
P0404END EQU   *                  END MARKER
*
P0404BYP_0788    DS 0H
*      * CREATE AND MODIFY 1ST AID BLOCK
*             EXEC CICS HANDLE AID
*                  ENTER(BADKEY1)
*                  ANYKEY(BADKEY1)
*                  PF4(GOTPF4) CLEAR
*ZC    181         EXEC  CICS,HANDLE,AID,ENTER(BADKEY1),ANYKEY(BADKEY1)X
               ,PF4(GOTPF4),CLEAR
         LARL  R1,P0206         ADDRESS SOURCE
         LARL  R15,P0206        ADDRESS TARGET
         XC    0(P0206END-P0206,R15),0(R1) XC IT
         LARL  R1,=X'0206'         ADDRESS SOURCE
         LARL  R15,P0206FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0206FN,R15),0(R1) MVC IT
         LARL  R1,P0206EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0206TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0206ADS        R1=ADDRESS AID NUMBERS
         LARL  R14,P0206ADR       R14=ADDRESSES OR FF IF CANCEL
         MVI   0(R1),2       SET AID NUMBER
         LARL  R0,PG_BADKEY1     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),1       SET AID NUMBER
         LARL  R0,PG_BADKEY1     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),10       SET AID NUMBER
         LARL  R0,PG_GOTPF4     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),33-30    SET AID NUMBER
         MVI   0(R14),X'FF'       SET CANCEL INDICATOR
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         LA    R0,DFHEIAID        ADDRESS OF DFHEIAID
         LARL  R1,P0206AID         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0206EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0206EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0206EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0206EDF_0802 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0206EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0206)       R1=LCL MODULE PARAMETER LIST
P0206EDF_0802    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         J     P0206BYP_0802   EXIT
*
P0206    DS    0H
P0206FN  DS    XL2                FUNCTION CODE
P0206EIB DS    AL4                EIB
P0206TCT DS    AL4                TCTTE
P0206AID DS    AL4                A(DFHEIAID)
P0206ADS DS    XL30               ROOM FOR 30 AIDS
P0206ADR DS    30AL4              ROOM FOR 30 ADDRESSES, FF......=CLEAR
P0206EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0206EDS DS    AL4                DSA ADDRESS FOR EDF
P0206EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0206EDL DS    XL2                DSA LENGTH FOR EDF
P0206NED DS    X                  FF=NOEDF
         DS    X
P0206RSP DS    AL4                RESP
P0206RS2 DS    AL4                RESP2
P0206END EQU   *                  END MARKER
*
P0206BYP_0802    DS 0H
*                  END-EXEC.
*      *  KEYPRES1 EQU   *
*         KEYPRES1.
PG_KEYPRES1 DS 0H
*             EXEC CICS RECEIVE INTO(RECAREA) LENGTH(RECLEN) END-EXEC.
*ZC    188         EXEC  CICS,RECEIVE,INTO(RECAREA),LENGTH(RECLEN)
         LARL  R1,P0402         ADDRESS SOURCE
         LARL  R15,P0402        ADDRESS TARGET
         XC    0(P0402END-P0402,R15),0(R1) XC IT
         LARL  R1,=X'0402'         ADDRESS SOURCE
         LARL  R15,P0402FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0402FN,R15),0(R1) MVC IT
         LARL  R1,P0402EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0402TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0402EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0402EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0402EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R15,P0402ADB       ADDRESS TARGET
         MVC   0(4,R15),DFHEIAID  SET AID BLOCK ADDRESS
         LA    R0,RECAREA           R0=ADDRESS OF INTO
         LARL  R1,P0402INT         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,L'RECAREA         R0=LENGTH OF INTO
         LARL  R1,P0402INL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,RECLEN         R0=ADDRESS OF LENGTH
         LARL  R1,P0402LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P0402HCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0402EDF_0818 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0402EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0402)       R1=LCL MODULE PARAMETER LIST
P0402EDF_0818    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0402NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0402BYP_0818   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0402BYP_0818   EXIT IF NONE
* NOTALLOC, LENGERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0402BYP_0818) ENTRYPOINT FOR IGNORE CONDITION
*
P0402    DS    0H
P0402FN  DS    XL2                FUNCTION CODE
P0402EIB DS    AL4                EIB
P0402TCT DS    AL4                TCTTE
P0402ADB DS    AL4                ADBLK
P0402INT DS    AL4                A(INTO)
P0402INL DS    AL2                L'INTO
P0402LEN DS    AL4                A(LENGTH OF RECEIVED DATA)
P0402TGR DS    XL4                TGET RESPONSE
P0402HCN DS    AL4                A(DFHEIHCN)
P0402AID DS    AL4                HANDLE AID ADDRESS
P0402EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0402EDS DS    AL4                DSA ADDRESS FOR EDF
P0402EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0402EDL DS    XL2                DSA LENGTH FOR EDF
P0402NED DS    X                  FF=NOEDF
         DS    X
P0402NOW DS    X                  FF=NOWAIT
         DS    X
P0402NOH DS    X                  FF=NOHANDLE
         DS    X
P0402RSP DS    AL4                RESP
P0402RS2 DS    AL4                RESP2
P0402END EQU   *                  END MARKER
*
P0402BYP_0818    DS 0H
         LARL  R15,P0402AID       ADDRESS TARGET
         ICM   R0,15,0(R15)       ANY HANDLE AID ?
         JZ    P0402_0818_01  EXIT IF NONE
         BR    R0                 GO TO HANDLE AID ROUTINE
*
P0402_0818_01     EQU *
*      *  CLI   EIBAID,DFHCLEAR    CLEAR PRESSED ?
*      *  BE    RETURN             END TASK IF IT IS
*      *  B     KEYPRES1           LOOP
*             IF EIBAID = DFHCLEAR THEN GO TO ALLDONE
*ZC    192         IF    EIBAID,=,DFHCLEAR,THEN
         CLC   EIBAID,DFHCLEAR
         BRC   15-ZC_EQ,PG_IF_1_1
*ZC    192         GO    TO,ALLDONE
         J     PG_ALLDONE
*             ELSE GO TO KEYPRES1.
*ZC    193         ELSE
         J     PG_IF_1_E
PG_IF_1_1    DS    0H  &TYPE
*      * BADKEY1  EQU   *
*ZC    193         GO    TO,KEYPRES1
         J     PG_KEYPRES1
PG_IF_1_E    DS    0H  &TYPE
*         BADKEY1.
PG_KEYPRES1_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_BADKEY1 DS  0H
*             EXEC CICS SEND FROM(BADMSG1) LENGTH(BADMSG1L) END-EXEC.
*ZC    196         EXEC  CICS,SEND,FROM(BADMSG1),LENGTH(BADMSG1L)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),BADMSG1L   SET LENGTH FROM LABEL
         LA    R0,BADMSG1           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_0858 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_0858    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_0858   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_0858   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_0858) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_0858    DS 0H
*      *  B     KEYPRES1           WAIT FOR NEXT KEY
*             GO TO KEYPRES1.
*      * GOTPF4   EQU   *
*ZC    198         GO    TO,KEYPRES1
         J     PG_KEYPRES1
*         GOTPF4.
PG_BADKEY1_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_GOTPF4 DS   0H
*             EXEC CICS SEND FROM(PF4MSG) LENGTH(PF4MSGL) END-EXEC.
*ZC    201         EXEC  CICS,SEND,FROM(PF4MSG),LENGTH(PF4MSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PF4MSGL   SET LENGTH FROM LABEL
         LA    R0,PF4MSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_0877 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_0877    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_0877   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_0877   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_0877) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_0877    DS 0H
*             EXEC CICS SEND FROM(PF5ASK) LENGTH(PF5ASKL) END-EXEC.
*ZC    202         EXEC  CICS,SEND,FROM(PF5ASK),LENGTH(PF5ASKL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PF5ASKL   SET LENGTH FROM LABEL
         LA    R0,PF5ASK           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_0890 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_0890    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_0890   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_0890   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_0890) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_0890    DS 0H
*      * CREATE 2ND AID BLOCK
*             EXEC CICS PUSH HANDLE END-EXEC.
*ZC    204         EXEC  CICS,PUSH,HANDLE
         LARL  R1,P020C         ADDRESS SOURCE
         LARL  R15,P020C        ADDRESS TARGET
         XC    0(P020CEND-P020C,R15),0(R1) XC IT
         LARL  R1,=X'020C'         ADDRESS SOURCE
         LARL  R15,P020CFN        ADDRESS TARGET AS LABEL
         MVC   0(L'P020CFN,R15),0(R1) MVC IT
         LARL  R1,P020CEIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P020CTCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P020CEDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P020CEDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P020CEDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R15,P020CAID       ADDRESS TARGET
         MVC   0(4,R15),DFHEIAID  SET AID BLOCK ADDRESS
         LARL  R15,P020CHCN       ADDRESS TARGET
         MVC   0(4,R15),DFHEIHCN  SET HANDLE CONDITION BLOCK ADDRESS
         LARL  R0,P020CEDF_0903 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P020CEDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P020C)       R1=LCL MODULE PARAMETER LIST
P020CEDF_0903    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         J     P020CBYP_0903   EXIT
*
P020C    DS    0H
P020CFN  DS    XL2                FUNCTION CODE
P020CEIB DS    AL4                EIB
P020CTCT DS    AL4                TCTTE
P020CAID DS    AL4                AID BLOCK ADDRESS
P020CHCN DS    AL4                HANDLE CONDITION BLOCK ADDRESS
P020CEDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P020CEDS DS    AL4                DSA ADDRESS FOR EDF
P020CEDC DS    XL2                CICS DSA LENGTH FOR EDF
P020CEDL DS    XL2                DSA LENGTH FOR EDF
P020CNED DS    X                  FF=NOEDF
         DS    X
P020CRSP DS    AL4                RESP
P020CRS2 DS    AL4                RESP2
P020CEND EQU   *                  END MARKER
*
P020CBYP_0903    DS 0H
*      * MODIFY 2ND AID BLOCK
*             EXEC CICS HANDLE AID
*                  ENTER(BADKEY2)
*                  ANYKEY(BADKEY2)
*                  PF5(GOTPF5) CLEAR
*ZC    206         EXEC  CICS,HANDLE,AID,ENTER(BADKEY2),ANYKEY(BADKEY2)X
               ,PF5(GOTPF5),CLEAR
         LARL  R1,P0206         ADDRESS SOURCE
         LARL  R15,P0206        ADDRESS TARGET
         XC    0(P0206END-P0206,R15),0(R1) XC IT
         LARL  R1,=X'0206'         ADDRESS SOURCE
         LARL  R15,P0206FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0206FN,R15),0(R1) MVC IT
         LARL  R1,P0206EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0206TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0206ADS        R1=ADDRESS AID NUMBERS
         LARL  R14,P0206ADR       R14=ADDRESSES OR FF IF CANCEL
         MVI   0(R1),2       SET AID NUMBER
         LARL  R0,PG_BADKEY2     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),1       SET AID NUMBER
         LARL  R0,PG_BADKEY2     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),11       SET AID NUMBER
         LARL  R0,PG_GOTPF5     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),33-30    SET AID NUMBER
         MVI   0(R14),X'FF'       SET CANCEL INDICATOR
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         LA    R0,DFHEIAID        ADDRESS OF DFHEIAID
         LARL  R1,P0206AID         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0206EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0206EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0206EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0206EDF_0915 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0206EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0206)       R1=LCL MODULE PARAMETER LIST
P0206EDF_0915    DS 0H
         BAKR  0,R15              STACK REGS AND GO
*                  END-EXEC.
*      * KEYPRES2 EQU   *
*         KEYPRES2.
PG_GOTPF4_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_KEYPRES2 DS 0H
*             EXEC CICS RECEIVE INTO(RECAREA) LENGTH(RECLEN) END-EXEC.
*ZC    213         EXEC  CICS,RECEIVE,INTO(RECAREA),LENGTH(RECLEN)
         LARL  R1,P0402         ADDRESS SOURCE
         LARL  R15,P0402        ADDRESS TARGET
         XC    0(P0402END-P0402,R15),0(R1) XC IT
         LARL  R1,=X'0402'         ADDRESS SOURCE
         LARL  R15,P0402FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0402FN,R15),0(R1) MVC IT
         LARL  R1,P0402EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0402TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0402EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0402EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0402EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R15,P0402ADB       ADDRESS TARGET
         MVC   0(4,R15),DFHEIAID  SET AID BLOCK ADDRESS
         LA    R0,RECAREA           R0=ADDRESS OF INTO
         LARL  R1,P0402INT         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,L'RECAREA         R0=LENGTH OF INTO
         LARL  R1,P0402INL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,RECLEN         R0=ADDRESS OF LENGTH
         LARL  R1,P0402LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P0402HCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0402EDF_0930 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0402EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0402)       R1=LCL MODULE PARAMETER LIST
P0402EDF_0930    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0402NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0402BYP_0930   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0402BYP_0930   EXIT IF NONE
* NOTALLOC, LENGERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0402BYP_0930) ENTRYPOINT FOR IGNORE CONDITION
*
P0402BYP_0930    DS 0H
         LARL  R15,P0402AID       ADDRESS TARGET
         ICM   R0,15,0(R15)       ANY HANDLE AID ?
         JZ    P0402_0930_01  EXIT IF NONE
         BR    R0                 GO TO HANDLE AID ROUTINE
*
P0402_0930_01     EQU *
*      *  CLI   EIBAID,DFHCLEAR    CLEAR PRESSED ?
*      *  BE    RETURN             END TASK IF IT IS
*      *  B     KEYPRES2           LOOP
*             IF EIBAID = DFHCLEAR THEN GO TO ALLDONE
*ZC    217         IF    EIBAID,=,DFHCLEAR,THEN
         CLC   EIBAID,DFHCLEAR
         BRC   15-ZC_EQ,PG_IF_2_1
*ZC    217         GO    TO,ALLDONE
         J     PG_ALLDONE
*             ELSE GO TO KEYPRES2.
*ZC    218         ELSE
         J     PG_IF_2_E
PG_IF_2_1    DS    0H  &TYPE
*      * BADKEY2  EQU   *
*ZC    218         GO    TO,KEYPRES2
         J     PG_KEYPRES2
PG_IF_2_E    DS    0H  &TYPE
*         BADKEY2.
PG_KEYPRES2_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_BADKEY2 DS  0H
*             EXEC CICS SEND FROM(BADMSG2) LENGTH(BADMSG2L) END-EXEC.
*ZC    221         EXEC  CICS,SEND,FROM(BADMSG2),LENGTH(BADMSG2L)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),BADMSG2L   SET LENGTH FROM LABEL
         LA    R0,BADMSG2           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_0969 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_0969    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_0969   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_0969   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_0969) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_0969    DS 0H
*      *  B     KEYPRES2           WAIT FOR NEXT KEY
*             GO TO KEYPRES2.
*      * GOTPF5   EQU   *
*ZC    223         GO    TO,KEYPRES2
         J     PG_KEYPRES2
*         GOTPF5.
PG_BADKEY2_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_GOTPF5 DS   0H
*             EXEC CICS SEND FROM(PF5MSG) LENGTH(PF5MSGL) END-EXEC.
*ZC    226         EXEC  CICS,SEND,FROM(PF5MSG),LENGTH(PF5MSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PF5MSGL   SET LENGTH FROM LABEL
         LA    R0,PF5MSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_0988 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_0988    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_0988   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_0988   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_0988) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_0988    DS 0H
*             EXEC CICS SEND FROM(PF6ASK) LENGTH(PF6ASKL) END-EXEC.
*ZC    227         EXEC  CICS,SEND,FROM(PF6ASK),LENGTH(PF6ASKL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PF6ASKL   SET LENGTH FROM LABEL
         LA    R0,PF6ASK           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1001 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1001    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1001   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1001   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1001) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1001    DS 0H
*      * DELETE 2ND AID BLOCK
*             EXEC CICS POP HANDLE END-EXEC.
*ZC    229         EXEC  CICS,POP,HANDLE
         LARL  R1,P020E         ADDRESS SOURCE
         LARL  R15,P020E        ADDRESS TARGET
         XC    0(P020EEND-P020E,R15),0(R1) XC IT
         LARL  R1,=X'020E'         ADDRESS SOURCE
         LARL  R15,P020EFN        ADDRESS TARGET AS LABEL
         MVC   0(L'P020EFN,R15),0(R1) MVC IT
         LARL  R1,P020EEIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P020ETCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P020EEDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P020EEDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P020EEDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIAID        R0=ADDRESS OF DFHEIAID
         LARL  R1,P020EAID         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,DFHEIHCN        R1=ADDRESS OF DFHEIHCN
         LARL  R1,P020EHCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P020EEDF_1014 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P020EEDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P020E)       R1=LCL MODULE PARAMETER LIST
P020EEDF_1014    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P020ENOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P020EBYP_1014   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P020EBYP_1014   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P020EBYP_1014) ENTRYPOINT FOR IGNORE CONDITION
*
P020E    DS    0H
P020EFN  DS    XL2                FUNCTION CODE
P020EEIB DS    AL4                EIB
P020ETCT DS    AL4                TCTTE
P020EAID DS    AL4                A(DFHEIAID)
P020EHCN DS    AL4                A(DFHEIHCN)
P020EEDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P020EEDS DS    AL4                DSA ADDRESS FOR EDF
P020EEDC DS    XL2                CICS DSA LENGTH FOR EDF
P020EEDL DS    XL2                DSA LENGTH FOR EDF
P020ENED DS    X                  FF=NOEDF
         DS    X
P020ENOH DS    X                  FF=NOHANDLE
         DS    X
P020ERSP DS    AL4                RESP
P020ERS2 DS    AL4                RESP2
P020EEND EQU   *                  END MARKER
*
P020EBYP_1014    DS 0H
*      * MODIFY 1ST AID BLOCK
*             EXEC CICS HANDLE AID
*                  ENTER(BADKEY3)
*                  ANYKEY(BADKEY3)
*                  PF4 PF6(GOTPF6) CLEAR
*ZC    231         EXEC  CICS,HANDLE,AID,ENTER(BADKEY3),ANYKEY(BADKEY3)X
               ,PF4,PF6(GOTPF6),CLEAR
         LARL  R1,P0206         ADDRESS SOURCE
         LARL  R15,P0206        ADDRESS TARGET
         XC    0(P0206END-P0206,R15),0(R1) XC IT
         LARL  R1,=X'0206'         ADDRESS SOURCE
         LARL  R15,P0206FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0206FN,R15),0(R1) MVC IT
         LARL  R1,P0206EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0206TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0206ADS        R1=ADDRESS AID NUMBERS
         LARL  R14,P0206ADR       R14=ADDRESSES OR FF IF CANCEL
         MVI   0(R1),2       SET AID NUMBER
         LARL  R0,PG_BADKEY3     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),1       SET AID NUMBER
         LARL  R0,PG_BADKEY3     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),40-30    SET AID NUMBER
         MVI   0(R14),X'FF'       SET CANCEL INDICATOR
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),12       SET AID NUMBER
         LARL  R0,PG_GOTPF6     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         MVI   0(R1),33-30    SET AID NUMBER
         MVI   0(R14),X'FF'       SET CANCEL INDICATOR
         AHI   R1,1               BUMP AID NUMBER POINTER
         AHI   R14,4              BUMP AID ADDRESS POINTER
         LA    R0,DFHEIAID        ADDRESS OF DFHEIAID
         LARL  R1,P0206AID         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0206EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0206EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0206EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0206EDF_1029 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0206EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0206)       R1=LCL MODULE PARAMETER LIST
P0206EDF_1029    DS 0H
         BAKR  0,R15              STACK REGS AND GO
*                  END-EXEC.
*      * KEYPRES3 EQU   *
*         KEYPRES3.
PG_GOTPF5_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_KEYPRES3 DS 0H
*             EXEC CICS RECEIVE INTO(RECAREA) LENGTH(RECLEN) END-EXEC.
*ZC    238         EXEC  CICS,RECEIVE,INTO(RECAREA),LENGTH(RECLEN)
         LARL  R1,P0402         ADDRESS SOURCE
         LARL  R15,P0402        ADDRESS TARGET
         XC    0(P0402END-P0402,R15),0(R1) XC IT
         LARL  R1,=X'0402'         ADDRESS SOURCE
         LARL  R15,P0402FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0402FN,R15),0(R1) MVC IT
         LARL  R1,P0402EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0402TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0402EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0402EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0402EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R15,P0402ADB       ADDRESS TARGET
         MVC   0(4,R15),DFHEIAID  SET AID BLOCK ADDRESS
         LA    R0,RECAREA           R0=ADDRESS OF INTO
         LARL  R1,P0402INT         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,L'RECAREA         R0=LENGTH OF INTO
         LARL  R1,P0402INL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,RECLEN         R0=ADDRESS OF LENGTH
         LARL  R1,P0402LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P0402HCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0402EDF_1044 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0402EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0402)       R1=LCL MODULE PARAMETER LIST
P0402EDF_1044    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0402NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0402BYP_1044   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0402BYP_1044   EXIT IF NONE
* NOTALLOC, LENGERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0402BYP_1044) ENTRYPOINT FOR IGNORE CONDITION
*
P0402BYP_1044    DS 0H
         LARL  R15,P0402AID       ADDRESS TARGET
         ICM   R0,15,0(R15)       ANY HANDLE AID ?
         JZ    P0402_1044_01  EXIT IF NONE
         BR    R0                 GO TO HANDLE AID ROUTINE
*
P0402_1044_01     EQU *
*      *  CLI   EIBAID,DFHCLEAR    CLEAR PRESSED ?
*      *  BE    RETURN             END TASK IF IT IS
*      *  B     KEYPRES3           LOOP
*             IF EIBAID = DFHCLEAR THEN GO TO ALLDONE
*ZC    242         IF    EIBAID,=,DFHCLEAR,THEN
         CLC   EIBAID,DFHCLEAR
         BRC   15-ZC_EQ,PG_IF_3_1
*ZC    242         GO    TO,ALLDONE
         J     PG_ALLDONE
*             ELSE GO TO KEYPRES3.
*ZC    243         ELSE
         J     PG_IF_3_E
PG_IF_3_1    DS    0H  &TYPE
*      * BADKEY3  EQU   *
*ZC    243         GO    TO,KEYPRES3
         J     PG_KEYPRES3
PG_IF_3_E    DS    0H  &TYPE
*         BADKEY3.
PG_KEYPRES3_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_BADKEY3 DS  0H
*             EXEC CICS SEND FROM(BADMSG3) LENGTH(BADMSG3L) END-EXEC.
*ZC    246         EXEC  CICS,SEND,FROM(BADMSG3),LENGTH(BADMSG3L)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),BADMSG3L   SET LENGTH FROM LABEL
         LA    R0,BADMSG3           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1083 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1083    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1083   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1083   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1083) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1083    DS 0H
*      *  B     KEYPRES3           WAIT FOR NEXT KEY
*             GO TO KEYPRES3.
*      * GOTPF6   EQU   *
*ZC    248         GO    TO,KEYPRES3
         J     PG_KEYPRES3
*         GOTPF6.
PG_BADKEY3_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_GOTPF6 DS   0H
*             EXEC CICS SEND FROM(PF6MSG) LENGTH(PF6MSGL) END-EXEC.
*ZC    251         EXEC  CICS,SEND,FROM(PF6MSG),LENGTH(PF6MSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PF6MSGL   SET LENGTH FROM LABEL
         LA    R0,PF6MSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1102 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1102    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1102   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1102   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1102) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1102    DS 0H
*      * DELETE 1ST AID BLOCK
*             EXEC CICS POP HANDLE END-EXEC.
*ZC    253         EXEC  CICS,POP,HANDLE
         LARL  R1,P020E         ADDRESS SOURCE
         LARL  R15,P020E        ADDRESS TARGET
         XC    0(P020EEND-P020E,R15),0(R1) XC IT
         LARL  R1,=X'020E'         ADDRESS SOURCE
         LARL  R15,P020EFN        ADDRESS TARGET AS LABEL
         MVC   0(L'P020EFN,R15),0(R1) MVC IT
         LARL  R1,P020EEIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P020ETCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P020EEDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P020EEDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P020EEDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIAID        R0=ADDRESS OF DFHEIAID
         LARL  R1,P020EAID         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LA    R0,DFHEIHCN        R1=ADDRESS OF DFHEIHCN
         LARL  R1,P020EHCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P020EEDF_1115 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P020EEDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P020E)       R1=LCL MODULE PARAMETER LIST
P020EEDF_1115    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P020ENOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P020EBYP_1115   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P020EBYP_1115   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P020EBYP_1115) ENTRYPOINT FOR IGNORE CONDITION
*
P020EBYP_1115    DS 0H
*      * CREATE AND MODIFY 1ST CONDITION BLOCK
*             EXEC CICS HANDLE CONDITION PGMIDERR(GOTPGMER) END-EXEC.
*ZC    255         EXEC  CICS,HANDLE,CONDITION,PGMIDERR(GOTPGMER)
         LARL  R1,P0204         ADDRESS SOURCE
         LARL  R15,P0204        ADDRESS TARGET
         XC    0(P0204END-P0204,R15),0(R1) XC IT
         LARL  R1,=X'0204'         ADDRESS SOURCE
         LARL  R15,P0204FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0204FN,R15),0(R1) MVC IT
         LARL  R1,P0204EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0204TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0204CND        R1=ADDRESS CONDITION NUMBERS
         LARL  R14,P0204ADR       R14=ADDRESSES OR FF IF CANCEL
         MVI   0(R1),27       SET CONDITION NUMBER
         LARL  R0,PG_GOTPGMER     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP CONDITION NUMBER POINTER
         AHI   R14,4              BUMP CONDITION ADDRESS POINTER
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P0204HCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0204EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0204EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0204EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0204EDF_1129 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0204EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0204)       R1=LCL MODULE PARAMETER LIST
P0204EDF_1129    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         J     P0204BYP_1129   EXIT
*
P0204    DS    0H
P0204FN  DS    XL2                FUNCTION CODE
P0204EIB DS    AL4                EIB
P0204TCT DS    AL4                TCTTE
P0204HCN DS    AL4                A(DFHEIHCN)
P0204CND DS    XL30               ROOM FOR 30 CONDITIONS
P0204ADR DS    30AL4              ROOM FOR 30 ADDRESSES, FF......=CLEAR
P0204EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0204EDS DS    AL4                DSA ADDRESS FOR EDF
P0204EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0204EDL DS    XL2                DSA LENGTH FOR EDF
P0204NED DS    X                  FF=NOEDF
         DS    X
P0204RSP DS    AL4                RESP
P0204RS2 DS    AL4                RESP2
P0204END EQU   *                  END MARKER
*
P0204BYP_1129    DS 0H
*             EXEC CICS SEND FROM(PGMMSG) LENGTH(PGMMSGL) END-EXEC.
*ZC    256         EXEC  CICS,SEND,FROM(PGMMSG),LENGTH(PGMMSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PGMMSGL   SET LENGTH FROM LABEL
         LA    R0,PGMMSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1142 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1142    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1142   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1142   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1142) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1142    DS 0H
*      * THIS SHOULD RAISE PGMIDERR
*             EXEC CICS LINK PROGRAM('BADPROG1') END-EXEC.
*ZC    258         EXEC  CICS,LINK,PROGRAM('BADPROG1')
         LARL  R1,P0E02         ADDRESS SOURCE
         LARL  R15,P0E02        ADDRESS TARGET
         XC    0(P0E02END-P0E02,R15),0(R1) XC IT
         LARL  R1,=X'0E02'         ADDRESS SOURCE
         LARL  R15,P0E02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02FN,R15),0(R1) MVC IT
         LARL  R1,=CL8'BADPROG1'         ADDRESS SOURCE
         LARL  R15,P0E02PGM        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02PGM,R15),0(R1) MVC IT
         LARL  R1,P0E02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0E02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0E02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0E02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
* SPECIAL LINKAGE
         LARL  R0,P0E02EDF_1155 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0E02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0E02           R1=PARAMETER LIST
         LRL   R15,=V(LCL0E02)    R15=EXTERNAL LINK MODULE ADDRESS
P0E02EDF_1155    EQU *
         BALR  R14,R15            GO TO IT
         LARL  R1,P0E02NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0E02BYP_1155   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0E02BYP_1155   EXIT IF NONE
* PGMIDERR, CHANNELERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0E02BYP_1155) ENTRYPOINT FOR IGNORE CONDITION
*
P0E02    DS    0H
P0E02FN  DS    XL2                FUNCTION CODE
P0E02PGM DS    CL8                PROGRAM
P0E02EIB DS    AL4                EIB
P0E02COM DS    AL4                COMMAREA ADDRESS
P0E02CLN DS    XL2                COMMAREA LENGTH
P0E02CHN DS    CL16               CHANNEL NAME
P0E02EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0E02EDS DS    AL4                DSA ADDRESS FOR EDF
P0E02EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0E02EDL DS    XL2                DSA LENGTH FOR EDF
P0E02NED DS    X                  FF=NOEDF
         DS    X
P0E02LV0 DS    X                  FF=LINK LEVEL 0
         DS    X
P0E02NOH DS    X                  FF=NOHANDLE
         DS    X
P0E02RSP DS    AL4                RESP
P0E02RS2 DS    AL4                RESP2
P0E02END EQU   *                  END MARKER
*
P0E02BYP_1155    DS 0H
         MVC   EIBCALEN,DFHEICAL  RESTORE EIB COMMAREA LENGTH
         MVC   EIBPROG,TCTTERET   RESTORE EIBPROG
         MVC   TCTTEINV,DFHEIINV  RESTORE INVOKINGPROG FOR ASSIGN
         MVC   TCTTERET,DFHEIRET  RESTORE RETURNPROG FOR ASSIGN
*      * NEXT1    EQU   *
*         NEXT1.
*      * CREATE 2ND CONDITION BLOCK
PG_GOTPF6_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_NEXT1 DS    0H
*             EXEC CICS PUSH HANDLE END-EXEC.
*ZC    262         EXEC  CICS,PUSH,HANDLE
         LARL  R1,P020C         ADDRESS SOURCE
         LARL  R15,P020C        ADDRESS TARGET
         XC    0(P020CEND-P020C,R15),0(R1) XC IT
         LARL  R1,=X'020C'         ADDRESS SOURCE
         LARL  R15,P020CFN        ADDRESS TARGET AS LABEL
         MVC   0(L'P020CFN,R15),0(R1) MVC IT
         LARL  R1,P020CEIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P020CTCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P020CEDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P020CEDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P020CEDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R15,P020CAID       ADDRESS TARGET
         MVC   0(4,R15),DFHEIAID  SET AID BLOCK ADDRESS
         LARL  R15,P020CHCN       ADDRESS TARGET
         MVC   0(4,R15),DFHEIHCN  SET HANDLE CONDITION BLOCK ADDRESS
         LARL  R0,P020CEDF_1171 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P020CEDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P020C)       R1=LCL MODULE PARAMETER LIST
P020CEDF_1171    DS 0H
         BAKR  0,R15              STACK REGS AND GO
*      * MODIFY 2ND CONDITION BLOCK
*             EXEC CICS HANDLE CONDITION ERROR(GOTERROR) END-EXEC.
*ZC    264         EXEC  CICS,HANDLE,CONDITION,ERROR(GOTERROR)
         LARL  R1,P0204         ADDRESS SOURCE
         LARL  R15,P0204        ADDRESS TARGET
         XC    0(P0204END-P0204,R15),0(R1) XC IT
         LARL  R1,=X'0204'         ADDRESS SOURCE
         LARL  R15,P0204FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0204FN,R15),0(R1) MVC IT
         LARL  R1,P0204EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0204TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0204CND        R1=ADDRESS CONDITION NUMBERS
         LARL  R14,P0204ADR       R14=ADDRESSES OR FF IF CANCEL
         MVI   0(R1),1       SET CONDITION NUMBER
         LARL  R0,PG_GOTERROR     R0=LABEL (COBOL)
         ST    R0,0(R14)          SAVE IT
         AHI   R1,1               BUMP CONDITION NUMBER POINTER
         AHI   R14,4              BUMP CONDITION ADDRESS POINTER
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P0204HCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0204EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0204EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0204EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0204EDF_1182 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0204EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0204)       R1=LCL MODULE PARAMETER LIST
P0204EDF_1182    DS 0H
         BAKR  0,R15              STACK REGS AND GO
*             EXEC CICS SEND FROM(PGMMSG2) LENGTH(PGMMSG2L) END-EXEC.
*ZC    265         EXEC  CICS,SEND,FROM(PGMMSG2),LENGTH(PGMMSG2L)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PGMMSG2L   SET LENGTH FROM LABEL
         LA    R0,PGMMSG2           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1194 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1194    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1194   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1194   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1194) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1194    DS 0H
*      * THIS SHOULD RAISE PGMIDERR, BUT HANDLED BY ERROR
*             EXEC CICS LINK PROGRAM('BADPROG2') END-EXEC.
*ZC    267         EXEC  CICS,LINK,PROGRAM('BADPROG2')
         LARL  R1,P0E02         ADDRESS SOURCE
         LARL  R15,P0E02        ADDRESS TARGET
         XC    0(P0E02END-P0E02,R15),0(R1) XC IT
         LARL  R1,=X'0E02'         ADDRESS SOURCE
         LARL  R15,P0E02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02FN,R15),0(R1) MVC IT
         LARL  R1,=CL8'BADPROG2'         ADDRESS SOURCE
         LARL  R15,P0E02PGM        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02PGM,R15),0(R1) MVC IT
         LARL  R1,P0E02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0E02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0E02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0E02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
* SPECIAL LINKAGE
         LARL  R0,P0E02EDF_1207 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0E02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0E02           R1=PARAMETER LIST
         LRL   R15,=V(LCL0E02)    R15=EXTERNAL LINK MODULE ADDRESS
P0E02EDF_1207    EQU *
         BALR  R14,R15            GO TO IT
         LARL  R1,P0E02NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0E02BYP_1207   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0E02BYP_1207   EXIT IF NONE
* PGMIDERR, CHANNELERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0E02BYP_1207) ENTRYPOINT FOR IGNORE CONDITION
*
P0E02BYP_1207    DS 0H
         MVC   EIBCALEN,DFHEICAL  RESTORE EIB COMMAREA LENGTH
         MVC   EIBPROG,TCTTERET   RESTORE EIBPROG
         MVC   TCTTEINV,DFHEIINV  RESTORE INVOKINGPROG FOR ASSIGN
         MVC   TCTTERET,DFHEIRET  RESTORE RETURNPROG FOR ASSIGN
*      * NEXT2    EQU   *
*         NEXT2.
PG_NEXT1_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_NEXT2 DS    0H
*             EXEC CICS HANDLE CONDITION ERROR END-EXEC.
*ZC    270         EXEC  CICS,HANDLE,CONDITION,ERROR
         LARL  R1,P0204         ADDRESS SOURCE
         LARL  R15,P0204        ADDRESS TARGET
         XC    0(P0204END-P0204,R15),0(R1) XC IT
         LARL  R1,=X'0204'         ADDRESS SOURCE
         LARL  R15,P0204FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0204FN,R15),0(R1) MVC IT
         LARL  R1,P0204EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0204TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0204CND        R1=ADDRESS CONDITION NUMBERS
         LARL  R14,P0204ADR       R14=ADDRESSES OR FF IF CANCEL
         MVI   0(R1),151-150 SET CONDITION NUMBER
         MVI   0(R14),X'FF'       SET CANCEL INDICATOR
         AHI   R1,1               BUMP CONDITION NUMBER POINTER
         AHI   R14,4              BUMP CONDITION ADDRESS POINTER
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P0204HCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0204EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0204EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0204EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0204EDF_1222 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0204EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0204)       R1=LCL MODULE PARAMETER LIST
P0204EDF_1222    DS 0H
         BAKR  0,R15              STACK REGS AND GO
*             EXEC CICS IGNORE CONDITION PGMIDERR END-EXEC.
*ZC    271         EXEC  CICS,IGNORE,CONDITION,PGMIDERR
         LARL  R1,P020A         ADDRESS SOURCE
         LARL  R15,P020A        ADDRESS TARGET
         XC    0(P020AEND-P020A,R15),0(R1) XC IT
         LARL  R1,=X'020A'         ADDRESS SOURCE
         LARL  R15,P020AFN        ADDRESS TARGET AS LABEL
         MVC   0(L'P020AFN,R15),0(R1) MVC IT
         LARL  R1,P020AEIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P020ATCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R14,P020ACND       R14=ADDRESS OF COND NUMBERS
         MVI   0(R14),27      SET CONDITION INDICATOR
         AHI   R14,1              BUMP POINTER
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P020AHCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P020AEDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P020AEDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P020AEDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P020AEDF_1234 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P020AEDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P020A)       R1=LCL MODULE PARAMETER LIST
P020AEDF_1234    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         J     P020ABYP_1234   EXIT
*
P020A    DS    0H
P020AFN  DS    XL2                FUNCTION CODE
P020AEIB DS    AL4                EIB
P020ATCT DS    AL4                TCTTE
P020AHCN DS    AL4                A(DFHEIHCN)
P020ACND DS    XL30               ROOM FOR 30 CONDITIONS
P020AEDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P020AEDS DS    AL4                DSA ADDRESS FOR EDF
P020AEDC DS    XL2                CICS DSA LENGTH FOR EDF
P020AEDL DS    XL2                DSA LENGTH FOR EDF
P020ANED DS    X                  FF=NOEDF
         DS    X
P020ARSP DS    AL4                RESP
P020ARS2 DS    AL4                RESP2
P020AEND EQU   *                  END MARKER
*
P020ABYP_1234    DS 0H
*      * THIS SHOULD BE IGNORED
*             EXEC CICS LINK PROGRAM('BADPROG3') END-EXEC.
*ZC    273         EXEC  CICS,LINK,PROGRAM('BADPROG3')
         LARL  R1,P0E02         ADDRESS SOURCE
         LARL  R15,P0E02        ADDRESS TARGET
         XC    0(P0E02END-P0E02,R15),0(R1) XC IT
         LARL  R1,=X'0E02'         ADDRESS SOURCE
         LARL  R15,P0E02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02FN,R15),0(R1) MVC IT
         LARL  R1,=CL8'BADPROG3'         ADDRESS SOURCE
         LARL  R15,P0E02PGM        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02PGM,R15),0(R1) MVC IT
         LARL  R1,P0E02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0E02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0E02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0E02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
* SPECIAL LINKAGE
         LARL  R0,P0E02EDF_1247 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0E02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0E02           R1=PARAMETER LIST
         LRL   R15,=V(LCL0E02)    R15=EXTERNAL LINK MODULE ADDRESS
P0E02EDF_1247    EQU *
         BALR  R14,R15            GO TO IT
         LARL  R1,P0E02NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0E02BYP_1247   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0E02BYP_1247   EXIT IF NONE
* PGMIDERR, CHANNELERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0E02BYP_1247) ENTRYPOINT FOR IGNORE CONDITION
*
P0E02BYP_1247    DS 0H
         MVC   EIBCALEN,DFHEICAL  RESTORE EIB COMMAREA LENGTH
         MVC   EIBPROG,TCTTERET   RESTORE EIBPROG
         MVC   TCTTEINV,DFHEIINV  RESTORE INVOKINGPROG FOR ASSIGN
         MVC   TCTTERET,DFHEIRET  RESTORE RETURNPROG FOR ASSIGN
*             EXEC CICS SEND FROM(IGNMSG) LENGTH(IGNMSGL) END-EXEC.
*ZC    274         EXEC  CICS,SEND,FROM(IGNMSG),LENGTH(IGNMSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),IGNMSGL   SET LENGTH FROM LABEL
         LA    R0,IGNMSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1259 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1259    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1259   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1259   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1259) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1259    DS 0H
*             EXEC CICS HANDLE CONDITION PGMIDERR END-EXEC.
*ZC    275         EXEC  CICS,HANDLE,CONDITION,PGMIDERR
         LARL  R1,P0204         ADDRESS SOURCE
         LARL  R15,P0204        ADDRESS TARGET
         XC    0(P0204END-P0204,R15),0(R1) XC IT
         LARL  R1,=X'0204'         ADDRESS SOURCE
         LARL  R15,P0204FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0204FN,R15),0(R1) MVC IT
         LARL  R1,P0204EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0204TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0204CND        R1=ADDRESS CONDITION NUMBERS
         LARL  R14,P0204ADR       R14=ADDRESSES OR FF IF CANCEL
         MVI   0(R1),177-150 SET CONDITION NUMBER
         MVI   0(R14),X'FF'       SET CANCEL INDICATOR
         AHI   R1,1               BUMP CONDITION NUMBER POINTER
         AHI   R14,4              BUMP CONDITION ADDRESS POINTER
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P0204HCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0204EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0204EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0204EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0204EDF_1272 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0204EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0204)       R1=LCL MODULE PARAMETER LIST
P0204EDF_1272    DS 0H
         BAKR  0,R15              STACK REGS AND GO
*      * THIS SHOULD SUCCEED
*             EXEC CICS LINK PROGRAM('MMMMCIC2') END-EXEC.
*ZC    277         EXEC  CICS,LINK,PROGRAM('MMMMCIC2')
         LARL  R1,P0E02         ADDRESS SOURCE
         LARL  R15,P0E02        ADDRESS TARGET
         XC    0(P0E02END-P0E02,R15),0(R1) XC IT
         LARL  R1,=X'0E02'         ADDRESS SOURCE
         LARL  R15,P0E02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02FN,R15),0(R1) MVC IT
         LARL  R1,=CL8'MMMMCIC2'         ADDRESS SOURCE
         LARL  R15,P0E02PGM        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02PGM,R15),0(R1) MVC IT
         LARL  R1,P0E02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0E02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0E02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0E02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
* SPECIAL LINKAGE
         LARL  R0,P0E02EDF_1284 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0E02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0E02           R1=PARAMETER LIST
         LRL   R15,=V(LCL0E02)    R15=EXTERNAL LINK MODULE ADDRESS
P0E02EDF_1284    EQU *
         BALR  R14,R15            GO TO IT
         LARL  R1,P0E02NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0E02BYP_1284   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0E02BYP_1284   EXIT IF NONE
* PGMIDERR, CHANNELERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0E02BYP_1284) ENTRYPOINT FOR IGNORE CONDITION
*
P0E02BYP_1284    DS 0H
         MVC   EIBCALEN,DFHEICAL  RESTORE EIB COMMAREA LENGTH
         MVC   EIBPROG,TCTTERET   RESTORE EIBPROG
         MVC   TCTTEINV,DFHEIINV  RESTORE INVOKINGPROG FOR ASSIGN
         MVC   TCTTERET,DFHEIRET  RESTORE RETURNPROG FOR ASSIGN
*      * GETMAIN/FREEMAIN TESTS
*             EXEC CICS GETMAIN SET(GET1) LENGTH(100) INITIMG(1)
*ZC    279         EXEC  CICS,GETMAIN,SET(GET1),LENGTH(100),INITIMG(1)
         LARL  R1,P0C02         ADDRESS SOURCE
         LARL  R15,P0C02        ADDRESS TARGET
         XC    0(P0C02END-P0C02,R15),0(R1) XC IT
         LARL  R1,=X'0C02'         ADDRESS SOURCE
         LARL  R15,P0C02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C02FN,R15),0(R1) MVC IT
         LARL  R1,=AL2(100)   ADDRESS LITERAL
         LH    R0,0(R1)           SET LENGTH
         LARL  R1,P0C02LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0C02INM         ADDRESS TARGET
         MVI   0(R1),X'FF'      MVI IT
         LARL  R1,=AL2(1)  ADDRESS LITERAL
         LARL  R15,P0C02INT       ADDRESS TARGET
         MVC   0(1,R15),1(R1)     SET PADDING BYTE
         LARL  R1,P0C02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C02TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0C02EDF_1296 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C02)       R1=LCL MODULE PARAMETER LIST
P0C02EDF_1296    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LRL   R1,P0C02GMA        R1=GETMAIN ADDRESS
         AHI   R1,8               +8
         ST    R1,GET1            SET GETMAIN ADDRESS FOR REQUESTOR
         J     P0C02BYP_1296   EXIT
*
P0C02    DS    0H
P0C02FN  DS    XL2                FUNCTION CODE
P0C02EIB DS    AL4                EIB
P0C02TCT DS    AL4                TCTTE
P0C02LEN DS    AL4                LENGTH/FLENGTH
P0C02INM DS    X                  FF=INITIMG SPECIFIED
         DS    X
P0C02INT DS    X                  INITIMG
         DS    X
P0C02GMA DS    AL4                GETMAIN ADDRESS
P0C02EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0C02EDS DS    AL4                DSA ADDRESS FOR EDF
P0C02EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0C02EDL DS    XL2                DSA LENGTH FOR EDF
P0C02NED DS    X                  FF=NOEDF
         DS    X
P0C02NOH DS    X                  FF=NOHANDLE
         DS    X
P0C02RSP DS    AL4                RESP
P0C02RS2 DS    AL4                RESP2
P0C02END EQU   *                  END MARKER
*
P0C02BYP_1296    DS 0H
*                       END-EXEC.
*      *  ST    R5,GET1            SAVE ADDRESS
*             EXEC CICS GETMAIN SET(GET2) LENGTH(200) INITIMG(X'02')
*ZC    282         EXEC  CICS,GETMAIN,SET(GET2),LENGTH(200),INITIMG(X'0X
               2')
         LARL  R1,P0C02         ADDRESS SOURCE
         LARL  R15,P0C02        ADDRESS TARGET
         XC    0(P0C02END-P0C02,R15),0(R1) XC IT
         LARL  R1,=X'0C02'         ADDRESS SOURCE
         LARL  R15,P0C02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C02FN,R15),0(R1) MVC IT
         LARL  R1,=AL2(200)   ADDRESS LITERAL
         LH    R0,0(R1)           SET LENGTH
         LARL  R1,P0C02LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0C02INM         ADDRESS TARGET
         MVI   0(R1),X'FF'      MVI IT
         LARL  R1,=AL2(X'02')  ADDRESS LITERAL
         LARL  R15,P0C02INT       ADDRESS TARGET
         MVC   0(1,R15),1(R1)     SET PADDING BYTE
         LARL  R1,P0C02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C02TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0C02EDF_1310 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C02)       R1=LCL MODULE PARAMETER LIST
P0C02EDF_1310    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LRL   R1,P0C02GMA        R1=GETMAIN ADDRESS
         AHI   R1,8               +8
         ST    R1,GET2            SET GETMAIN ADDRESS FOR REQUESTOR
*                       END-EXEC.
*      *  ST    R5,GET2            SAVE ADDRESS
*             EXEC CICS GETMAIN SET(GET3) LENGTH(300) INITIMG(B'11')
*ZC    285         EXEC  CICS,GETMAIN,SET(GET3),LENGTH(300),INITIMG(B'1X
               1')
         LARL  R1,P0C02         ADDRESS SOURCE
         LARL  R15,P0C02        ADDRESS TARGET
         XC    0(P0C02END-P0C02,R15),0(R1) XC IT
         LARL  R1,=X'0C02'         ADDRESS SOURCE
         LARL  R15,P0C02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C02FN,R15),0(R1) MVC IT
         LARL  R1,=AL2(300)   ADDRESS LITERAL
         LH    R0,0(R1)           SET LENGTH
         LARL  R1,P0C02LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0C02INM         ADDRESS TARGET
         MVI   0(R1),X'FF'      MVI IT
         LARL  R1,=AL2(B'11')  ADDRESS LITERAL
         LARL  R15,P0C02INT       ADDRESS TARGET
         MVC   0(1,R15),1(R1)     SET PADDING BYTE
         LARL  R1,P0C02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C02TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0C02EDF_1323 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C02)       R1=LCL MODULE PARAMETER LIST
P0C02EDF_1323    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LRL   R1,P0C02GMA        R1=GETMAIN ADDRESS
         AHI   R1,8               +8
         ST    R1,GET3            SET GETMAIN ADDRESS FOR REQUESTOR
*                       END-EXEC.
*      *  ST    R5,GET3            SAVE ADDRESS
*             EXEC CICS GETMAIN SET(GET4) LENGTH(400) INITIMG(4)
*ZC    288         EXEC  CICS,GETMAIN,SET(GET4),LENGTH(400),INITIMG(4)
         LARL  R1,P0C02         ADDRESS SOURCE
         LARL  R15,P0C02        ADDRESS TARGET
         XC    0(P0C02END-P0C02,R15),0(R1) XC IT
         LARL  R1,=X'0C02'         ADDRESS SOURCE
         LARL  R15,P0C02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C02FN,R15),0(R1) MVC IT
         LARL  R1,=AL2(400)   ADDRESS LITERAL
         LH    R0,0(R1)           SET LENGTH
         LARL  R1,P0C02LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0C02INM         ADDRESS TARGET
         MVI   0(R1),X'FF'      MVI IT
         LARL  R1,=AL2(4)  ADDRESS LITERAL
         LARL  R15,P0C02INT       ADDRESS TARGET
         MVC   0(1,R15),1(R1)     SET PADDING BYTE
         LARL  R1,P0C02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C02TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0C02EDF_1336 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C02)       R1=LCL MODULE PARAMETER LIST
P0C02EDF_1336    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LRL   R1,P0C02GMA        R1=GETMAIN ADDRESS
         AHI   R1,8               +8
         ST    R1,GET4            SET GETMAIN ADDRESS FOR REQUESTOR
*                       END-EXEC.
*      *  ST    R5,GET4            SAVE ADDRESS
*             EXEC CICS GETMAIN SET(GET5) LENGTH(500) INITIMG(INIT5)
*ZC    291         EXEC  CICS,GETMAIN,SET(GET5),LENGTH(500),INITIMG(INIX
               T5)
         LARL  R1,P0C02         ADDRESS SOURCE
         LARL  R15,P0C02        ADDRESS TARGET
         XC    0(P0C02END-P0C02,R15),0(R1) XC IT
         LARL  R1,=X'0C02'         ADDRESS SOURCE
         LARL  R15,P0C02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C02FN,R15),0(R1) MVC IT
         LARL  R1,=AL2(500)   ADDRESS LITERAL
         LH    R0,0(R1)           SET LENGTH
         LARL  R1,P0C02LEN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0C02INM         ADDRESS TARGET
         MVI   0(R1),X'FF'      MVI IT
         LARL  R15,P0C02INT       ADDRESS TARGET
         MVC   0(1,R15),INIT5  SET PADDING BYTE FROM LABEL
         LARL  R1,P0C02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C02TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0C02EDF_1349 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C02)       R1=LCL MODULE PARAMETER LIST
P0C02EDF_1349    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LRL   R1,P0C02GMA        R1=GETMAIN ADDRESS
         AHI   R1,8               +8
         ST    R1,GET5            SET GETMAIN ADDRESS FOR REQUESTOR
*                       END-EXEC.
*      *  ST    R5,GET5            SAVE ADDRESS
*      * FREEMAIN IN RANDOM ORDER...42153
*      *  L     R5,GET4            ADDRESS TO FREEMAIN
*             EXEC CICS FREEMAIN DATAPOINTER(GET4) END-EXEC.
*ZC    296         EXEC  CICS,FREEMAIN,DATAPOINTER(GET4)
         LARL  R1,P0C04         ADDRESS SOURCE
         LARL  R15,P0C04        ADDRESS TARGET
         XC    0(P0C04END-P0C04,R15),0(R1) XC IT
         LARL  R1,=X'0C04'         ADDRESS SOURCE
         LARL  R15,P0C04FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C04FN,R15),0(R1) MVC IT
         LARL  R1,P0C04EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C04TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C04EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C04EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C04EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         L     R0,GET4        POINTER TO FREEMAIN ADDRESS (COB)
         LARL  R1,P0C04FMA         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0C04EDF_1362 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C04EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C04)       R1=LCL MODULE PARAMETER LIST
P0C04EDF_1362    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0C04NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0C04BYP_1362   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0C04BYP_1362   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0C04BYP_1362) ENTRYPOINT FOR IGNORE CONDITION
*
P0C04    DS    0H
P0C04FN  DS    XL2                FUNCTION CODE
P0C04EIB DS    AL4                EIB
P0C04TCT DS    AL4                TCTTE
P0C04FMA DS    AL4                FREEMAIN ADDRESS
P0C04EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0C04EDS DS    AL4                DSA ADDRESS FOR EDF
P0C04EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0C04EDL DS    XL2                DSA LENGTH FOR EDF
P0C04NED DS    X                  FF=NOEDF
         DS    X
P0C04NOH DS    X                  FF=NOHANDLE
         DS    X
P0C04RSP DS    AL4                RESP
P0C04RS2 DS    AL4                RESP2
P0C04END EQU   *                  END MARKER
*
P0C04BYP_1362    DS 0H
*             EXEC CICS FREEMAIN DATAPOINTER(GET2) END-EXEC.
*ZC    297         EXEC  CICS,FREEMAIN,DATAPOINTER(GET2)
         LARL  R1,P0C04         ADDRESS SOURCE
         LARL  R15,P0C04        ADDRESS TARGET
         XC    0(P0C04END-P0C04,R15),0(R1) XC IT
         LARL  R1,=X'0C04'         ADDRESS SOURCE
         LARL  R15,P0C04FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C04FN,R15),0(R1) MVC IT
         LARL  R1,P0C04EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C04TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C04EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C04EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C04EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         L     R0,GET2        POINTER TO FREEMAIN ADDRESS (COB)
         LARL  R1,P0C04FMA         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0C04EDF_1376 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C04EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C04)       R1=LCL MODULE PARAMETER LIST
P0C04EDF_1376    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0C04NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0C04BYP_1376   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0C04BYP_1376   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0C04BYP_1376) ENTRYPOINT FOR IGNORE CONDITION
*
P0C04BYP_1376    DS 0H
*      *  L     R5,GET1            ADDRESS TO FREEMAIN
*             EXEC CICS FREEMAIN DATAPOINTER(GET1) END-EXEC.
*ZC    299         EXEC  CICS,FREEMAIN,DATAPOINTER(GET1)
         LARL  R1,P0C04         ADDRESS SOURCE
         LARL  R15,P0C04        ADDRESS TARGET
         XC    0(P0C04END-P0C04,R15),0(R1) XC IT
         LARL  R1,=X'0C04'         ADDRESS SOURCE
         LARL  R15,P0C04FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C04FN,R15),0(R1) MVC IT
         LARL  R1,P0C04EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C04TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C04EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C04EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C04EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         L     R0,GET1        POINTER TO FREEMAIN ADDRESS (COB)
         LARL  R1,P0C04FMA         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0C04EDF_1389 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C04EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C04)       R1=LCL MODULE PARAMETER LIST
P0C04EDF_1389    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0C04NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0C04BYP_1389   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0C04BYP_1389   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0C04BYP_1389) ENTRYPOINT FOR IGNORE CONDITION
*
P0C04BYP_1389    DS 0H
*             EXEC CICS FREEMAIN DATAPOINTER(GET5) END-EXEC.
*ZC    300         EXEC  CICS,FREEMAIN,DATAPOINTER(GET5)
         LARL  R1,P0C04         ADDRESS SOURCE
         LARL  R15,P0C04        ADDRESS TARGET
         XC    0(P0C04END-P0C04,R15),0(R1) XC IT
         LARL  R1,=X'0C04'         ADDRESS SOURCE
         LARL  R15,P0C04FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C04FN,R15),0(R1) MVC IT
         LARL  R1,P0C04EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C04TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C04EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C04EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C04EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         L     R0,GET5        POINTER TO FREEMAIN ADDRESS (COB)
         LARL  R1,P0C04FMA         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0C04EDF_1402 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C04EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C04)       R1=LCL MODULE PARAMETER LIST
P0C04EDF_1402    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0C04NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0C04BYP_1402   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0C04BYP_1402   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0C04BYP_1402) ENTRYPOINT FOR IGNORE CONDITION
*
P0C04BYP_1402    DS 0H
*             EXEC CICS FREEMAIN DATAPOINTER(GET3) END-EXEC
*ZC    301         EXEC  CICS,FREEMAIN,DATAPOINTER(GET3)
         LARL  R1,P0C04         ADDRESS SOURCE
         LARL  R15,P0C04        ADDRESS TARGET
         XC    0(P0C04END-P0C04,R15),0(R1) XC IT
         LARL  R1,=X'0C04'         ADDRESS SOURCE
         LARL  R15,P0C04FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C04FN,R15),0(R1) MVC IT
         LARL  R1,P0C04EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C04TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C04EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C04EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C04EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         L     R0,GET3        POINTER TO FREEMAIN ADDRESS (COB)
         LARL  R1,P0C04FMA         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0C04EDF_1415 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C04EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C04)       R1=LCL MODULE PARAMETER LIST
P0C04EDF_1415    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0C04NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0C04BYP_1415   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0C04BYP_1415   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0C04BYP_1415) ENTRYPOINT FOR IGNORE CONDITION
*
P0C04BYP_1415    DS 0H
*             EXEC CICS IGNORE CONDITION INVREQ END-EXEC.
*ZC    302         EXEC  CICS,IGNORE,CONDITION,INVREQ
         LARL  R1,P020A         ADDRESS SOURCE
         LARL  R15,P020A        ADDRESS TARGET
         XC    0(P020AEND-P020A,R15),0(R1) XC IT
         LARL  R1,=X'020A'         ADDRESS SOURCE
         LARL  R15,P020AFN        ADDRESS TARGET AS LABEL
         MVC   0(L'P020AFN,R15),0(R1) MVC IT
         LARL  R1,P020AEIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P020ATCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R14,P020ACND       R14=ADDRESS OF COND NUMBERS
         MVI   0(R14),16      SET CONDITION INDICATOR
         AHI   R14,1              BUMP POINTER
         LA    R0,DFHEIHCN        ADDRESS OF DFHEIHCN
         LARL  R1,P020AHCN         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P020AEDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P020AEDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P020AEDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P020AEDF_1427 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P020AEDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P020A)       R1=LCL MODULE PARAMETER LIST
P020AEDF_1427    DS 0H
         BAKR  0,R15              STACK REGS AND GO
*      *  L     R5,=4X'FF'         INVALID ADDRESS
*             EXEC CICS FREEMAIN DATAPOINTER(GETBAD) END-EXEC.
*ZC    304         EXEC  CICS,FREEMAIN,DATAPOINTER(GETBAD)
         LARL  R1,P0C04         ADDRESS SOURCE
         LARL  R15,P0C04        ADDRESS TARGET
         XC    0(P0C04END-P0C04,R15),0(R1) XC IT
         LARL  R1,=X'0C04'         ADDRESS SOURCE
         LARL  R15,P0C04FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0C04FN,R15),0(R1) MVC IT
         LARL  R1,P0C04EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0C04TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0C04EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0C04EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0C04EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         L     R0,GETBAD        POINTER TO FREEMAIN ADDRESS (COB)
         LARL  R1,P0C04FMA         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R0,P0C04EDF_1439 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0C04EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0C04)       R1=LCL MODULE PARAMETER LIST
P0C04EDF_1439    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0C04NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0C04BYP_1439   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0C04BYP_1439   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0C04BYP_1439) ENTRYPOINT FOR IGNORE CONDITION
*
P0C04BYP_1439    DS 0H
*             EXEC CICS SEND FROM(GTMMSG) LENGTH(GTMMSGL) END-EXEC.
*ZC    305         EXEC  CICS,SEND,FROM(GTMMSG),LENGTH(GTMMSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),GTMMSGL   SET LENGTH FROM LABEL
         LA    R0,GTMMSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1452 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1452    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1452   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1452   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1452) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1452    DS 0H
*             EXEC CICS SEND FROM(ABDMSG) LENGTH(ABDMSGL) END-EXEC
*      * THIS SHOULD ABEND PGMIDERR (AEI0)
*ZC    306         EXEC  CICS,SEND,FROM(ABDMSG),LENGTH(ABDMSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),ABDMSGL   SET LENGTH FROM LABEL
         LA    R0,ABDMSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1465 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1465    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1465   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1465   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1465) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1465    DS 0H
*             EXEC CICS LINK PROGRAM('BADPROG4') END-EXEC.
*ZC    308         EXEC  CICS,LINK,PROGRAM('BADPROG4')
         LARL  R1,P0E02         ADDRESS SOURCE
         LARL  R15,P0E02        ADDRESS TARGET
         XC    0(P0E02END-P0E02,R15),0(R1) XC IT
         LARL  R1,=X'0E02'         ADDRESS SOURCE
         LARL  R15,P0E02FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02FN,R15),0(R1) MVC IT
         LARL  R1,=CL8'BADPROG4'         ADDRESS SOURCE
         LARL  R15,P0E02PGM        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E02PGM,R15),0(R1) MVC IT
         LARL  R1,P0E02EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0E02EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0E02EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0E02EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
* SPECIAL LINKAGE
         LARL  R0,P0E02EDF_1477 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0E02EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0E02           R1=PARAMETER LIST
         LRL   R15,=V(LCL0E02)    R15=EXTERNAL LINK MODULE ADDRESS
P0E02EDF_1477    EQU *
         BALR  R14,R15            GO TO IT
         LARL  R1,P0E02NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0E02BYP_1477   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0E02BYP_1477   EXIT IF NONE
* PGMIDERR, CHANNELERR
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0E02BYP_1477) ENTRYPOINT FOR IGNORE CONDITION
*
P0E02BYP_1477    DS 0H
         MVC   EIBCALEN,DFHEICAL  RESTORE EIB COMMAREA LENGTH
         MVC   EIBPROG,TCTTERET   RESTORE EIBPROG
         MVC   TCTTEINV,DFHEIINV  RESTORE INVOKINGPROG FOR ASSIGN
         MVC   TCTTERET,DFHEIRET  RESTORE RETURNPROG FOR ASSIGN
*      * RETURN   EQU   *
*         ALLDONE.
PG_NEXT2_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_ALLDONE DS  0H
*             EXEC CICS RETURN END-EXEC.
*ZC    311         EXEC  CICS,RETURN
         LARL  R1,P0E08         ADDRESS SOURCE
         LARL  R15,P0E08        ADDRESS TARGET
         XC    0(P0E08END-P0E08,R15),0(R1) XC IT
         LARL  R1,=X'0E08'         ADDRESS SOURCE
         LARL  R15,P0E08FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0E08FN,R15),0(R1) MVC IT
         LARL  R1,P0E08EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0E08EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0E08EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
* SPECIAL LINKAGE
         LARL  R0,P0E08EDF_1492 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0E08EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0E08           R1=PARAMETER LIST
         LARL  R14,P0E08RTN_1492 RETURN ADDRESS
         LRL   R15,=V(LCL0E08)    R15=EXTERNAL RETURN MODULE ADDRESS
P0E08EDF_1492    EQU *
         BR    R15                GO TO IT
*
P0E08RTN_1492    EQU *
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0E08BYP_1492   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(0)             IGNORE HERE IS NOT PERMITTED
*
P0E08    DS    0H
P0E08FN  DS    XL2                FUNCTION CODE
P0E08TRN DS    CL4                TRANSID
P0E08COM DS    AL4                COMMAREA ADDRESS
P0E08CLN DS    XL2                COMMAREA LENGTH
P0E08CHN DS    CL16               CHANNEL NAME
P0E08IMM DS    X                  FF=IMMEDIATE
         DS    X
P0E08CNR DS    X                  FF=CLEANER
         DS    X
P0E08EDF DS    AL4                ORIGIN ADDRESS FOR CEDF
P0E08EDS DS    AL4                DSA ADDRESS FOR EDF
P0E08EDC DS    XL2                CICS DSA LENGTH FOR EDF
P0E08EDL DS    XL2                DSA LENGTH FOR EDF
P0E08NED DS    X                  FF=NOEDF
         DS    X
P0E08RSP DS    AL4                RESP
P0E08RS2 DS    AL4                RESP2
P0E08END EQU   *                  END MARKER
*
P0E08BYP_1492    DS 0H
*      * GOTPGMER DS    0H
*         GOTPGMER.
PG_ALLDONE_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_GOTPGMER DS 0H
*             EXEC CICS SEND FROM(PGMMSGE) LENGTH(PGMMSGEL) END-EXEC.
*ZC    314         EXEC  CICS,SEND,FROM(PGMMSGE),LENGTH(PGMMSGEL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),PGMMSGEL   SET LENGTH FROM LABEL
         LA    R0,PGMMSGE           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1505 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1505    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1505   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1505   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1505) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1505    DS 0H
*      *  B     NEXT1              EXIT
*             GO TO NEXT1.
*      * GOTERROR DS    0H
*ZC    316         GO    TO,NEXT1
         J     PG_NEXT1
*         GOTERROR.
PG_GOTPGMER_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
PG_GOTERROR DS 0H
*             EXEC CICS SEND FROM(ERRMSG) LENGTH(ERRMSGL) END-EXEC.
*ZC    319         EXEC  CICS,SEND,FROM(ERRMSG),LENGTH(ERRMSGL)
         LARL  R1,P0404         ADDRESS SOURCE
         LARL  R15,P0404        ADDRESS TARGET
         XC    0(P0404END-P0404,R15),0(R1) XC IT
         LARL  R1,=X'0404'         ADDRESS SOURCE
         LARL  R15,P0404FN        ADDRESS TARGET AS LABEL
         MVC   0(L'P0404FN,R15),0(R1) MVC IT
         LARL  R15,P0404LEN       ADDRESS TARGET
         MVC   0(2,R15),ERRMSGL   SET LENGTH FROM LABEL
         LA    R0,ERRMSG           FROM ADDRESS
         LARL  R1,P0404FRM         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         LARL  R1,P0404EIB         ADDRESS TARGET
         ST    DFHEIBR,0(R1)      ST IT
         LARL  R1,P0404TCT         ADDRESS TARGET
         ST    TCTTEAR,0(R1)      ST IT
         LARL  R1,P0404EDS         ADDRESS TARGET
         ST    R13,0(R1)      ST IT
         L     R0,DFHEILEN        DSA LENGTH
         LARL  R1,P0404EDL         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LA    R0,DFHEIUSR        DSA USER AREA
         SR    R0,R13             R0=CICS DSA LENGTH
         LARL  R1,P0404EDC         ADDRESS TARGET
         STH   R0,0(R1)      STH IT
         LARL  R0,P0404EDF_1524 ADDRESS ORIGIN FOR CEDF
         LARL  R1,P0404EDF         ADDRESS TARGET
         ST    R0,0(R1)      ST IT
         L     R15,TCTTELCL       R15=LCL MODULE INDEXER
         LARL  R1,=A(P0404)       R1=LCL MODULE PARAMETER LIST
P0404EDF_1524    DS 0H
         BAKR  0,R15              STACK REGS AND GO
         LARL  R1,P0404NOH         ADDRESS TARGET
         CLI   0(R1),X'FF'      CLI IT
         JE    P0404BYP_1524   EXIT IF IT IS
         OC    EIBRESP,EIBRESP    ANY BAD RESPONSE ?
         JZ    P0404BYP_1524   EXIT IF NONE
* INVREQ
         DC    AL3(0),C'ABEND'    MARKER FOR Z390KCP ESTAE
         DC    AL4(P0404BYP_1524) ENTRYPOINT FOR IGNORE CONDITION
*
P0404BYP_1524    DS 0H
*      *  B     NEXT2              EXIT
*             GO TO NEXT2.
*ZC    321         GO    TO,NEXT2
         J     PG_NEXT2
PG_GOTERROR_END L ZC_R15,ZCVT_PMCHECK
         BASR  ZC_R14,ZC_R15 CHECK FOR END OF CURRENT PERFORM
SN_END_PROCEDURE DS 0H SECTION
*        PROCEDURE END
         LH    ZC_R1,RETURN_CODE
         L     ZC_R15,ZCVT_GOBACK
         BASR  ZC_R14,ZC_R15
         LTORG 
*    ZCOBOL WORKING STORAGE SECTION DATA ITEMS 
*    LVL DATA NAME                      ADDR     LEN      DUP TYP PIC  X
                     VALUE 
*    01  GET1                           00000080 00000004 1   A   9(9) X
                      
*    01  GET2                           00000084 00000004 1   A   9(9) X
                      
*    01  GET3                           00000088 00000004 1   A   9(9) X
                      
*    01  GET4                           0000008C 00000004 1   A   9(9) X
                      
*    01  GET5                           00000090 00000004 1   A   9(9) X
                      
*    01  GETBAD                         00000094 00000004 1   A   9(9) X
                      
*    01  RECAREA                        00000098 00000050 1   X   X(80)X
                      
*    01  RECLEN                         000000E8 00000002 1   H   9(4) X
                      
*    01  HEAD                           000000EA 00000066 1   X        X
                      
*    02  ZC_FILLER_V1                   000000EA 00000006 1   X   X(6) X
                     X''27F5C311C1D1'' 
*    02  ZC_FILLER_V2                   000000F0 00000033 1   X   X(51)X
                     ''TESTBEC5 TEST HANDLE, PUSH/POP AND GETMAIN/FREEMX
               AIN'' 
*    02  ZC_FILLER_V3                   00000123 00000003 1   X   X(3) X
                     X''11C261'' 
*    02  ZC_FILLER_V4                   00000126 0000000E 1   X   X(14)X
                     ''PRESS PF KEY 4'' 
*    02  ZC_FILLER_V5                   00000134 00000003 1   X   X(3) X
                     X''11C3F1'' 
*    02  ZC_FILLER_V6                   00000137 00000019 1   X   X(25)X
                     ''CLEAR WILL END TASK EARLY'' 
*    01  HEADL                          00000150 00000002 1   H   9(4) X
                      
*    01  BADMSG1                        00000152 00000017 1   X        X
                      
*    02  ZC_FILLER_V7                   00000152 00000004 1   X   X(4) X
                     X''C311C5C1'' 
*    02  ZC_FILLER_V8                   00000156 00000013 1   X   X(19)X
                     ''THAT KEY WASN''''T PF4'' 
*    01  BADMSG1L                       00000169 00000002 1   H   9(4) X
                      
*    01  BADMSG2                        0000016B 00000017 1   X        X
                      
*    02  ZC_FILLER_V9                   0000016B 00000004 1   X   X(4) X
                     X''C311C761'' 
*    02  ZC_FILLER_V10                  0000016F 00000013 1   X   X(19)X
                     ''THAT KEY WASN''''T PF5'' 
*    01  BADMSG2L                       00000182 00000002 1   H   9(4) X
                      
*    01  BADMSG3                        00000184 00000017 1   X        X
                      
*    02  ZC_FILLER_V11                  00000184 00000004 1   X   X(4) X
                     X''C3114AC1'' 
*    02  ZC_FILLER_V12                  00000188 00000013 1   X   X(19)X
                     ''THAT KEY WASN''''T PF6'' 
*    01  BADMSG3L                       0000019B 00000002 1   H   9(4) X
                      
*    01  PF4MSG                         0000019D 00000018 1   X        X
                      
*    02  ZC_FILLER_V13                  0000019D 00000004 1   X   X(4) X
                     X''C311C5C1'' 
*    02  ZC_FILLER_V14                  000001A1 00000014 1   X   X(20)X
                     ''I GOT PF4, THANKYOU '' 
*    01  PF4MSGL                        000001B5 00000002 1   H   9(4) X
                      
*    01  PF5ASK                         000001B7 00000012 1   X        X
                      
*    02  ZC_FILLER_V15                  000001B7 00000004 1   X   X(4) X
                     X''C311C6D1'' 
*    02  ZC_FILLER_V16                  000001BB 0000000E 1   X   X(14)X
                     ''PRESS PF KEY 5'' 
*    01  PF5ASKL                        000001C9 00000002 1   H   9(4) X
                      
*    01  PF5MSG                         000001CB 00000018 1   X        X
                      
*    02  ZC_FILLER_V17                  000001CB 00000004 1   X   X(4) X
                     X''C311C761'' 
*    02  ZC_FILLER_V18                  000001CF 00000014 1   X   X(20)X
                     ''I GOT PF5, THANKYOU '' 
*    01  PF5MSGL                        000001E3 00000002 1   H   9(4) X
                      
*    01  PF6ASK                         000001E5 00000012 1   X        X
                      
*    02  ZC_FILLER_V19                  000001E5 00000004 1   X   X(4) X
                     X''C311C8F1'' 
*    02  ZC_FILLER_V20                  000001E9 0000000E 1   X   X(14)X
                     ''PRESS PF KEY 6'' 
*    01  PF6ASKL                        000001F7 00000002 1   H   9(4) X
                      
*    01  PF6MSG                         000001F9 00000018 1   X        X
                      
*    02  ZC_FILLER_V21                  000001F9 00000004 1   X   X(4) X
                     X''C3114AC1'' 
*    02  ZC_FILLER_V22                  000001FD 00000014 1   X   X(20)X
                     ''I GOT PF6, THANKYOU '' 
*    01  PF6MSGL                        00000211 00000002 1   H   9(4) X
                      
*    01  PGMMSG                         00000213 0000001F 1   X        X
                      
*    02  ZC_FILLER_V23                  00000213 00000004 1   X   X(4) X
                     X''C3114BD1'' 
*    02  ZC_FILLER_V24                  00000217 0000001B 1   X   X(27)X
                     ''PGMIDERR WILL NOW BE RAISED'' 
*    01  PGMMSGL                        00000232 00000002 1   H   9(4) X
                      
*    01  PGMMSGE                        00000234 00000021 1   X        X
                      
*    02  ZC_FILLER_V25                  00000234 00000004 1   X   X(4) X
                     X''C3114C61'' 
*    02  ZC_FILLER_V26                  00000238 0000001D 1   X   X(29)X
                     ''PGMIDERR CONDITION HANDLED OK'' 
*    01  PGMMSGEL                       00000255 00000002 1   H   9(4) X
                      
*    01  PGMMSG2                        00000257 00000025 1   X        X
                      
*    02  ZC_FILLER_V27                  00000257 00000004 1   X   X(4) X
                     X''C3114DF1'' 
*    02  ZC_FILLER_V28                  0000025B 00000021 1   X   X(33)X
                     ''PGMIDERR WILL NOW BE RAISED AGAIN'' 
*    01  PGMMSG2L                       0000027C 00000002 1   H   9(4) X
                      
*    01  ERRMSG                         0000027E 0000001E 1   X        X
                      
*    02  ZC_FILLER_V29                  0000027E 00000004 1   X   X(4) X
                     X''C3114FC1'' 
*    02  ZC_FILLER_V30                  00000282 0000001A 1   X   X(26)X
                     ''ERROR CONDITION HANDLED OK'' 
*    01  ERRMSGL                        0000029C 00000002 1   H   9(4) X
                      
*    01  IGNMSG                         0000029E 0000001F 1   X        X
                      
*    02  ZC_FILLER_V31                  0000029E 00000004 1   X   X(4) X
                     X''C31150D1'' 
*    02  ZC_FILLER_V32                  000002A2 0000001B 1   X   X(27)X
                     ''IGNORE CONDITION HANDLED OK'' 
*    01  IGNMSGL                        000002BD 00000002 1   H   9(4) X
                      
*    01  GTMMSG                         000002BF 0000002C 1   X        X
                      
*    02  ZC_FILLER_V33                  000002BF 00000004 1   X   X(4) X
                     X''C311D161'' 
*    02  ZC_FILLER_V34                  000002C3 00000028 1   X   X(40)X
                     ''GETMAIN/FREEMAIN TESTING, OK IF NO ABEND'' 
*    01  GTMMSGL                        000002EB 00000002 1   H   9(4) X
                      
*    01  ABDMSG                         000002ED 00000034 1   X        X
                      
*    02  ZC_FILLER_V35                  000002ED 00000004 1   X   X(4) X
                     X''C311D2F1'' 
*    02  ZC_FILLER_V36                  000002F1 00000022 1   X   X(34)X
                     ''PGMIDERR WILL NOW CAUSE ABEND AEI0'' 
*    02  ZC_FILLER_V37                  00000313 00000003 1   X   X(3) X
                     X''11D4C1'' 
*    02  ZC_FILLER_V38                  00000316 0000000B 1   X   X(11)X
                     ''PRESS CLEAR'' 
*    01  ABDMSGL                        00000321 00000002 1   H   9(4) X
                      
*    01  INIT5                          00000323 00000001 1   X   X    X
                     X''05'' 
*    01  DFHAID                         00000324 0000001E 1   X        X
                      
*    02  DFHNULL                        00000324 00000001 1   X   X    X
                     X''00'' 
*    02  DFHENTER                       00000325 00000001 1   X   X    X
                     X''7D'' 
*    02  DFHPF1                         00000326 00000001 1   X   X    X
                     X''F1'' 
*    02  DFHPF2                         00000327 00000001 1   X   X    X
                     X''F2'' 
*    02  DFHPF3                         00000328 00000001 1   X   X    X
                     X''F3'' 
*    02  DFHPF4                         00000329 00000001 1   X   X    X
                     X''F4'' 
*    02  DFHPF5                         0000032A 00000001 1   X   X    X
                     X''F5'' 
*    02  DFHPF6                         0000032B 00000001 1   X   X    X
                     X''F6'' 
*    02  DFHPF7                         0000032C 00000001 1   X   X    X
                     X''F7'' 
*    02  DFHPF8                         0000032D 00000001 1   X   X    X
                     X''F8'' 
*    02  DFHPF9                         0000032E 00000001 1   X   X    X
                     X''F9'' 
*    02  DFHPF10                        0000032F 00000001 1   X   X    X
                     X''7A'' 
*    02  DFHPF11                        00000330 00000001 1   X   X    X
                     X''7B'' 
*    02  DFHPF12                        00000331 00000001 1   X   X    X
                     X''7C'' 
*    02  DFHPF13                        00000332 00000001 1   X   X    X
                     X''C1'' 
*    02  DFHPF14                        00000333 00000001 1   X   X    X
                     X''C2'' 
*    02  DFHPF15                        00000334 00000001 1   X   X    X
                     X''C3'' 
*    02  DFHPF16                        00000335 00000001 1   X   X    X
                     X''C4'' 
*    02  DFHPF17                        00000336 00000001 1   X   X    X
                     X''C5'' 
*    02  DFHPF18                        00000337 00000001 1   X   X    X
                     X''C6'' 
*    02  DFHPF19                        00000338 00000001 1   X   X    X
                     X''C7'' 
*    02  DFHPF20                        00000339 00000001 1   X   X    X
                     X''C8'' 
*    02  DFHPF21                        0000033A 00000001 1   X   X    X
                     X''C9'' 
*    02  DFHPF22                        0000033B 00000001 1   X   X    X
                     X''4A'' 
*    02  DFHPF23                        0000033C 00000001 1   X   X    X
                     X''4B'' 
*    02  DFHPF24                        0000033D 00000001 1   X   X    X
                     X''4C'' 
*    02  DFHPA1                         0000033E 00000001 1   X   X    X
                     X''6C'' 
*    02  DFHPA2                         0000033F 00000001 1   X   X    X
                     X''6E'' 
*    02  DFHPA3                         00000340 00000001 1   X   X    X
                     X''6B'' 
*    02  DFHCLEAR                       00000341 00000001 1   X   X    X
                     X''6D'' 
*    01  ZC_WS_ID1                      00000342 00000007 1   X   X(7) X
                     ''ZCWSID1'' 
*    01  DEBUG_ITEM                     00000349 00000058 1   X        X
                      
*    02  DEBUG_LINE                     00000349 00000006 1   X   X(6) X
                      
*    02  ZC_FILLER_V39                  0000034F 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_NAME                     00000350 0000001E 1   X   X(30)X
                      
*    02  ZC_FILLER_V40                  0000036E 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_SUB_1                    0000036F 00000004 1   Z   9999 X
                      
*    02  ZC_FILLER_V41                  00000373 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_SUB_2                    00000374 00000004 1   Z   9999 X
                      
*    02  ZC_FILLER_V42                  00000378 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_SUB_3                    00000379 00000004 1   Z   9999 X
                      
*    02  ZC_FILLER_V43                  0000037D 00000001 1   X   X    X
                     SPACE 
*    02  DEBUG_CONTENTS                 0000037E 00000023 1   X   X(35)X
                      
*    01  TRUE                           000003A1 00000001 1   Z   9    X
                     1 
*    01  FALSE                          000003A2 00000001 1   Z   9    X
                     0 
*    01  RETURN_CODE                    000003A3 00000002 1   H   9(4) X
                     0 
*    01  ZC_DFHCOMMAREA_PTR             000003A5 00000004 1   A        X
                      
*    01  ZC_DFHEIBLK_PTR                000003A9 00000004 1   A        X
                      
*    01  ZC_ZC_LK_END_PTR               000003AD 00000004 1   A        X
                      
DFHEISTG DSECT 
ZC_WS_LOC_1  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GET1     DS  AL4
ZC_WS_LOC_2  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GET2     DS  AL4
ZC_WS_LOC_3  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GET3     DS  AL4
ZC_WS_LOC_4  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GET4     DS  AL4
ZC_WS_LOC_5  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GET5     DS  AL4
ZC_WS_LOC_6  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GETBAD   DS  AL4
ZC_WS_LOC_7  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
RECAREA  DS  CL80
ZC_WS_LOC_8  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
RECLEN   DS  HL2
ZC_WS_LOC_9  EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
HEAD     DS  0CL102
ZC_WS_LOC_10 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V1 DC XL6'27F5C311C1D1'
ZC_WS_LOC_11 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V2 DC CL51'TESTBEC5 TEST HANDLE, PUSH/POP AND GETMAIN/FREEMAIX
               N'
ZC_WS_LOC_12 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V3 DC XL3'11C261'
ZC_WS_LOC_13 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V4 DC CL14'PRESS PF KEY 4'
ZC_WS_LOC_14 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V5 DC XL3'11C3F1'
ZC_WS_LOC_15 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V6 DC CL25'CLEAR WILL END TASK EARLY'
ZC_WS_LOC_16 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
HEADL    DS  HL2
ZC_WS_LOC_17 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BADMSG1  DS  0CL23
ZC_WS_LOC_18 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V7 DC XL4'C311C5C1'
ZC_WS_LOC_19 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V8 DC CL19'THAT KEY WASN''T PF4'
ZC_WS_LOC_20 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BADMSG1L DS  HL2
ZC_WS_LOC_21 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BADMSG2  DS  0CL23
ZC_WS_LOC_22 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V9 DC XL4'C311C761'
ZC_WS_LOC_23 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V10 DC CL19'THAT KEY WASN''T PF5'
ZC_WS_LOC_24 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BADMSG2L DS  HL2
ZC_WS_LOC_25 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BADMSG3  DS  0CL23
ZC_WS_LOC_26 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V11 DC XL4'C3114AC1'
ZC_WS_LOC_27 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V12 DC CL19'THAT KEY WASN''T PF6'
ZC_WS_LOC_28 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
BADMSG3L DS  HL2
ZC_WS_LOC_29 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF4MSG   DS  0CL24
ZC_WS_LOC_30 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V13 DC XL4'C311C5C1'
ZC_WS_LOC_31 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V14 DC CL20'I GOT PF4, THANKYOU '
ZC_WS_LOC_32 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF4MSGL  DS  HL2
ZC_WS_LOC_33 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF5ASK   DS  0CL18
ZC_WS_LOC_34 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V15 DC XL4'C311C6D1'
ZC_WS_LOC_35 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V16 DC CL14'PRESS PF KEY 5'
ZC_WS_LOC_36 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF5ASKL  DS  HL2
ZC_WS_LOC_37 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF5MSG   DS  0CL24
ZC_WS_LOC_38 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V17 DC XL4'C311C761'
ZC_WS_LOC_39 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V18 DC CL20'I GOT PF5, THANKYOU '
ZC_WS_LOC_40 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF5MSGL  DS  HL2
ZC_WS_LOC_41 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF6ASK   DS  0CL18
ZC_WS_LOC_42 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V19 DC XL4'C311C8F1'
ZC_WS_LOC_43 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V20 DC CL14'PRESS PF KEY 6'
ZC_WS_LOC_44 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF6ASKL  DS  HL2
ZC_WS_LOC_45 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF6MSG   DS  0CL24
ZC_WS_LOC_46 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V21 DC XL4'C3114AC1'
ZC_WS_LOC_47 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V22 DC CL20'I GOT PF6, THANKYOU '
ZC_WS_LOC_48 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PF6MSGL  DS  HL2
ZC_WS_LOC_49 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PGMMSG   DS  0CL31
ZC_WS_LOC_50 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V23 DC XL4'C3114BD1'
ZC_WS_LOC_51 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V24 DC CL27'PGMIDERR WILL NOW BE RAISED'
ZC_WS_LOC_52 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PGMMSGL  DS  HL2
ZC_WS_LOC_53 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PGMMSGE  DS  0CL33
ZC_WS_LOC_54 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V25 DC XL4'C3114C61'
ZC_WS_LOC_55 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V26 DC CL29'PGMIDERR CONDITION HANDLED OK'
ZC_WS_LOC_56 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PGMMSGEL DS  HL2
ZC_WS_LOC_57 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PGMMSG2  DS  0CL37
ZC_WS_LOC_58 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V27 DC XL4'C3114DF1'
ZC_WS_LOC_59 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V28 DC CL33'PGMIDERR WILL NOW BE RAISED AGAIN'
ZC_WS_LOC_60 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
PGMMSG2L DS  HL2
ZC_WS_LOC_61 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ERRMSG   DS  0CL30
ZC_WS_LOC_62 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V29 DC XL4'C3114FC1'
ZC_WS_LOC_63 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V30 DC CL26'ERROR CONDITION HANDLED OK'
ZC_WS_LOC_64 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ERRMSGL  DS  HL2
ZC_WS_LOC_65 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
IGNMSG   DS  0CL31
ZC_WS_LOC_66 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V31 DC XL4'C31150D1'
ZC_WS_LOC_67 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V32 DC CL27'IGNORE CONDITION HANDLED OK'
ZC_WS_LOC_68 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
IGNMSGL  DS  HL2
ZC_WS_LOC_69 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GTMMSG   DS  0CL44
ZC_WS_LOC_70 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V33 DC XL4'C311D161'
ZC_WS_LOC_71 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V34 DC CL40'GETMAIN/FREEMAIN TESTING, OK IF NO ABEND'
ZC_WS_LOC_72 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
GTMMSGL  DS  HL2
ZC_WS_LOC_73 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ABDMSG   DS  0CL52
ZC_WS_LOC_74 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V35 DC XL4'C311D2F1'
ZC_WS_LOC_75 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V36 DC CL34'PGMIDERR WILL NOW CAUSE ABEND AEI0'
ZC_WS_LOC_76 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V37 DC XL3'11D4C1'
ZC_WS_LOC_77 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V38 DC CL11'PRESS CLEAR'
ZC_WS_LOC_78 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ABDMSGL  DS  HL2
ZC_WS_LOC_79 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
INIT5    DC XL1'05'
ZC_WS_LOC_80 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHAID   DS  0CL30
ZC_WS_LOC_81 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHNULL  DC XL1'00'
ZC_WS_LOC_82 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHENTER DC XL1'7D'
ZC_WS_LOC_83 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF1   DC XL1'F1'
ZC_WS_LOC_84 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF2   DC XL1'F2'
ZC_WS_LOC_85 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF3   DC XL1'F3'
ZC_WS_LOC_86 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF4   DC XL1'F4'
ZC_WS_LOC_87 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF5   DC XL1'F5'
ZC_WS_LOC_88 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF6   DC XL1'F6'
ZC_WS_LOC_89 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF7   DC XL1'F7'
ZC_WS_LOC_90 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF8   DC XL1'F8'
ZC_WS_LOC_91 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF9   DC XL1'F9'
ZC_WS_LOC_92 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF10  DC XL1'7A'
ZC_WS_LOC_93 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF11  DC XL1'7B'
ZC_WS_LOC_94 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF12  DC XL1'7C'
ZC_WS_LOC_95 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF13  DC XL1'C1'
ZC_WS_LOC_96 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF14  DC XL1'C2'
ZC_WS_LOC_97 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF15  DC XL1'C3'
ZC_WS_LOC_98 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF16  DC XL1'C4'
ZC_WS_LOC_99 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF17  DC XL1'C5'
ZC_WS_LOC_100 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF18  DC XL1'C6'
ZC_WS_LOC_101 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF19  DC XL1'C7'
ZC_WS_LOC_102 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF20  DC XL1'C8'
ZC_WS_LOC_103 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF21  DC XL1'C9'
ZC_WS_LOC_104 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF22  DC XL1'4A'
ZC_WS_LOC_105 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF23  DC XL1'4B'
ZC_WS_LOC_106 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPF24  DC XL1'4C'
ZC_WS_LOC_107 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPA1   DC XL1'6C'
ZC_WS_LOC_108 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPA2   DC XL1'6E'
ZC_WS_LOC_109 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHPA3   DC XL1'6B'
ZC_WS_LOC_110 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DFHCLEAR DC XL1'6D'
ZC_WS_LOC_111 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_WS_ID1 DC CL7'ZCWSID1'
ZC_WS_LOC_134 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_ITEM DS 0CL88
ZC_WS_LOC_135 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_LINE DS CL6
ZC_WS_LOC_136 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V39 DC CL1' '
ZC_WS_LOC_137 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_NAME DS CL30
ZC_WS_LOC_138 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V40 DC CL1' '
ZC_WS_LOC_139 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_SUB_1 DS ZL4
ZC_WS_LOC_140 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V41 DC CL1' '
ZC_WS_LOC_141 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_SUB_2 DS ZL4
ZC_WS_LOC_142 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V42 DC CL1' '
ZC_WS_LOC_143 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_SUB_3 DS ZL4
ZC_WS_LOC_144 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_FILLER_V43 DC CL1' '
ZC_WS_LOC_145 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
DEBUG_CONTENTS DS CL35
ZC_WS_LOC_146 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
TRUE     DC CL1'1'
ZC_WS_LOC_147 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
FALSE    DC CL1'0'
ZC_WS_LOC_148 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
RETURN_CODE DC AL2(0)                  RPI 1065
ZC_WS_LOC_149 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_DFHCOMMAREA_PTR DS AL4
ZC_WS_LOC_150 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_DFHEIBLK_PTR DS AL4
ZC_WS_LOC_151 EQU *-ZC_WS CHECK &SYM_NAME(&I) WS LOC
ZC_ZC_LK_END_PTR DS AL4
*    ZCOBOL LINKAGE SECTION DATA ITEMS 
*    LVL DATA NAME                      ADDR     LEN      DUP TYP PIC  X
                     VALUE 
*    01  DFHCOMMAREA                    00000000 00000054 1   X        X
                      
*    01  DFHEIBLK                       00000000 00000054 1   X        X
                      
*    02  EIBHEAD                        00000000 00000008 1   X   X(8) X
                      
*    02  EIBTIME                        00000008 00000004 1   P   9(7) X
                      
*    02  EIBDATE                        0000000C 00000004 1   P   9(7) X
                      
*    02  EIBTRNID                       00000010 00000004 1   X   X(4) X
                      
*    02  EIBTASKN                       00000014 00000004 1   P   9(7) X
                      
*    02  EIBTRMID                       00000018 00000004 1   X   X(4) X
                      
*    02  FILLER                         0000001C 00000002 1   X   X(2) X
                      
*    02  EIBCPOSN                       0000001E 00000002 1   H   9(4) X
                      
*    02  EIBCALEN                       00000020 00000002 1   H   9(4) X
                      
*    02  EIBAID                         00000022 00000001 1   X   X    X
                      
*    02  EIBFN                          00000023 00000002 1   H   9(4) X
                      
*    02  EIBRCODE                       00000025 00000006 1   X   X(6) X
                      
*    02  EIBREQID                       0000002B 00000008 1   X   X(8) X
                      
*    02  EIBDS                          00000033 00000008 1   X   X(8) X
                      
*    02  EIBRSRCE                       0000003B 00000008 1   X   X(8) X
                      
*    02  EIBRESP                        00000043 00000004 1   F   9(9) X
                      
*    02  EIBRESP2                       00000047 00000004 1   F   9(9) X
                      
*    02  EIBPROG                        0000004B 00000008 1   X   X(8) X
                      
*    02  EIBDTFRM                       00000053 00000001 1   X   X    X
                      
*    01  ZC_LK_END                      00000000 00000001 1   X   X    X
                      
DFHEISTG DSECT 
DFHCOMMAREA_DSECT DSECT 
ZC_LK_LOC_112 EQU *-DFHCOMMAREA CHECK &SYM_NAME(&I) LK LOC
DFHCOMMAREA DS 0CL84
DFHEIBLK_DSECT DSECT 
ZC_LK_LOC_113 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
DFHEIBLK DS  0CL84
ZC_LK_LOC_114 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBHEAD  DS  CL8
ZC_LK_LOC_115 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBTIME  DS  PL4
ZC_LK_LOC_116 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBDATE  DS  PL4
ZC_LK_LOC_117 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBTRNID DS  CL4
ZC_LK_LOC_118 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBTASKN DS  PL4
ZC_LK_LOC_119 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBTRMID DS  CL4
ZC_LK_LOC_120 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
         DS  CL2
ZC_LK_LOC_121 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBCPOSN DS  HL2
ZC_LK_LOC_122 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBCALEN DS  HL2
ZC_LK_LOC_123 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBAID   DS  CL1
ZC_LK_LOC_124 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBFN    DS  HL2
ZC_LK_LOC_125 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBRCODE DS  CL6
ZC_LK_LOC_126 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBREQID DS  CL8
ZC_LK_LOC_127 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBDS    DS  CL8
ZC_LK_LOC_128 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBRSRCE DS  CL8
ZC_LK_LOC_129 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBRESP  DS  FL4
ZC_LK_LOC_130 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBRESP2 DS  FL4
ZC_LK_LOC_131 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBPROG  DS  CL8
ZC_LK_LOC_132 EQU *-DFHEIBLK CHECK &SYM_NAME(&I) LK LOC
EIBDTFRM DS  CL1
ZC_LK_END_DSECT DSECT 
ZC_LK_LOC_133 EQU *-ZC_LK_END CHECK &SYM_NAME(&I) LK LOC
ZC_LK_END DS CL1
DFHEISTG DSECT 
ZC_WS_DIFF EQU  *-ZC_WS-945  DIFF BETWEEN ALLOC AND CALC WS
ZC_WS_END DS   0D
         MNOTE *,'ZCOBOL TOTAL SYMBOLS                 = 151'
         MNOTE *,'ZCOBOL TOTAL SYMBOL DUPLICATES       = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL MAX DUP CHAIN    = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL LEVEL 88         = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL SET INDEXES      = 0'
         MNOTE *,'ZCOBOL TOTAL SYMBOL LINKAGE SECTIONS = 3'
         MNOTE *,'ZCOBOL TOTAL PROCEDURE SECTIONS      = 0'
         MNOTE *,'ZCOBOL TOTAL PROCEDURE PARAGRAPHS    = 14'
         MNOTE *,'ZCOBOL TOTAL PROCEDURE PARAGRAPH DUP = 0'
DFHEISTG DSECT 
         ORG 
DFHEIEND EQU   *
         END 
